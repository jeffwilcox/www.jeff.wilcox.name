<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Silverlight ListBox with text searching - Jeff Wilcox</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Silverlight ListBox with text searching">
    <meta name="author" content="Jeff Wilcox">
    

    <link href="http://feeds.feedburner.com/jeffwilcox" rel="alternate" title="Jeff Wilcox" type="application/atom+xml" />
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/jmw.css" rel="stylesheet"/>
    <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.4.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/jmw.js"></script>
    <link type="text/css" rel="stylesheet" href="//az414997.vo.msecnd.net/waz/syntax/styles/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="//az414997.vo.msecnd.net/waz/syntax/styles/shThemeDefault.css"/>
  </head>
<body data-spy="scroll" data-target=".wiki-sidebar">
    <div class="navbar navbar-inverse" role="navigation"><!-- formerly navbar-fixed-top -->
        <div class="navbar-inner">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Jeff Wilcox</a>
                </div>
                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>
                    <li><a href="/about/">About</a></li>
                    <li><a href="/posts/">Posts</a></li>
                    <li><a href="https://github.com/jeffwilcox">//github.com/jeffwilcox</a></li>
                    <li><a href="https://twitter.com/jeffwilcox">@jeffwilcox</a></li>
                    <li><a href="http://linkedin.com/in/jeffreywilcox">LinkedIn</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>



<div class="container">

  <div class="container">
    <div class="row">
      <div class="col-md-8">

        <div id="post">
          <h2 class="post-title"><!--<a href="/2008/12/textsearchlistbox/">-->Silverlight ListBox with text searching<!--</a>--></h2>
          <div class="pull-right">
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="jeffwilcox" data-count="none">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></p>
          </div>
          <p id="date" class="muted">
            
            
            <small>
              17 December 2008
            </small>
            
            <!--
            <ul class="categories nav nav-pills">
            
            </ul>
            -->
            
          </p>

          <div class="blogcontent">
            <p>My &quot;TextSearchListBox&quot; control for Silverlight derives from ListBox and enables the text searching capability that many of us have come to expect in applications. The experience is a great improvement over the standard ListBox, and was simple enough to build out this evening.</p>  <p>I've attached the complete project and source code and hope that you find it useful in your apps in one way or another.</p>  <h3>What's the text search feature?</h3>  <p>When you give the list box control focus and type a character, the first item with the matching case insensitive prefix appears and is selected. For example, in the sample application attached to this post, I clicked on the list box control to give it focus, and then typed the letter 'c':</p>  <p><a href="http://media.jeff.wilcox.name/blog/AutoComplete/xap/TextSearchListBoxSample.html"><img alt="Charlotte" src="http://media.jeff.wilcox.name/blog/view/Charlotte.png" /></a>     <br /><em>Pressed &quot;c&quot;, Charlotte is selected.</em></p>  <p>If you're looking at a list of a thousand items, like a music playlist, this can be a time-saver. But you can also continue typing quickly, and even use the backspace to make corrections.</p>  <p>If I had quickly typed the letter &quot;o&quot; right after first letter, it would highlight the city of Columbus:</p>  <p><a href="http://media.jeff.wilcox.name/blog/AutoComplete/xap/TextSearchListBoxSample.html"><img alt="Columbus" src="http://media.jeff.wilcox.name/blog/view/Columbus.png" /></a>     <br /><em>Press &quot;c&quot; and then quickly &quot;o&quot;, Columbus is selected.</em></p>  <p>The control's searching logic is also able to intelligently handle repeated keypresses to move down the list. So, after typing either of the earlier samples, or just from the start, you can press the &quot;d&quot; key 5 times. It quickly will move the selection from Dallas all the way through to Detroit:</p>  <p><a href="http://media.jeff.wilcox.name/blog/AutoComplete/xap/TextSearchListBoxSample.html"><img alt="Detroit" src="http://media.jeff.wilcox.name/blog/view/Detroit.png" /></a>&#160;&#160; <br /><em>Press &quot;d&quot; 5 times to move through the other &quot;d&quot; words in the list box.</em></p>  <p>This is a great feature and it was relatively easy to implement, especially given the similarities to a typical auto complete control.</p>  <p>I'll be honest, before I joined Microsoft several years ago, I didn't know that you could type in a standard list box in a useful way. It's one of those hidden gems that I have used so many times since the insightful day I learned of the capability.</p>  <h3>How the string value of an item is determined</h3>  <p>The string value is figured out very differently than in WPF. Since ListBox supports rich data items, there's no easy way in Silverlight for the TextSearchListBox to know what the underlying text value is, and I didn't want to pollute the example with any kind of binding or display member path work.</p>  <p>Instead, the logic for this example is super simple: the <strong>ToString()</strong> operator is used for each item.</p>  <p>That means that if you use something like a standard business object, the text search won't really work out so well - the search algorithm would think that every item is the text &quot;YourNamespace.YourBusinessObject&quot;, if YourBusinessObject was the CLR class. In the attached sample application, I've simply bound to a list of strings. If you don't own the object to be able to override the ToString method, you can wrap the items in a derived or adapter class.</p>  <p>If you've used the AutoCompleteBox control in the <a href="http://www.codeplex.com/Silverlight/">Silverlight Toolkit</a>, you'll notice that this is slightly different. For the auto complete control, I wanted to provide the best experience for item-to-string conversions, so there is also an exposed IValueConverter property called &quot;Converter&quot; that is tried before the ToString fallback.</p>  <h3>Using the control</h3>  <p>Simply download the source code or drop the <a href="http://media.jeff.wilcox.name/blog/AutoComplete/TextSearchListBox.cs">TextSearchListBox.cs</a> file into your Silverlight application, update the namespace, and you're ready to go.</p>  <p>Here's the XAML for the sample application:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px" id="scid:887EC618-8FBE-49a5-A908-2339AF2EC720:fcf3e7d4-ed31-4ec6-bdef-22a0a566b2d3" class="wlWriterSmartContent"><pre class="brush: xml">&lt;UserControl x:Class="YourNamespace.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:local="clr-namespace:YourNamespace"
    Width="315" Height="340"&gt;
    &lt;Grid x:Name="LayoutRoot" Margin="5"&gt;
        &lt;Border BorderBrush="#11999999" BorderThickness="1" CornerRadius="3"&gt;
            &lt;Border BorderBrush="#22999999" BorderThickness="1" CornerRadius="3"&gt;
                &lt;Border BorderBrush="#33999999" BorderThickness="1" CornerRadius="3"&gt;
                    &lt;local:TextSearchListBox x:Name="listBox1" /&gt;
                &lt;/Border&gt;
            &lt;/Border&gt;
        &lt;/Border&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;</pre></div>

<p>And the page code behind:</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px" id="scid:887EC618-8FBE-49a5-A908-2339AF2EC720:5f72f8df-de34-4eea-98f2-646e1bf40645" class="wlWriterSmartContent"><pre class="brush: c-sharp">using System.Linq;
using System.Windows.Controls;
using Microsoft.Windows.Controls.Samples;

namespace YourNamespace
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();
            Loaded += (s, e) =&gt; listBox1.ItemsSource = (from n in Airport.SampleAirports orderby n.City select n.City).Distinct();
        }
    }
}</pre></div>

<h3>Downloads</h3>

<ul>
  <li><a href="http://media.jeff.wilcox.name/blog/AutoComplete/xap/TextSearchListBoxSample.html">Check out the simple sample app online</a> (13 KB) </li>

  <li><strong>Download </strong><a href="http://media.jeff.wilcox.name/blog/AutoComplete/TextSearchListBoxSample.zip"><strong>TextSearchListBoxSample.zip</strong></a> (12 KB) </li>

  <li>Download <a href="http://media.jeff.wilcox.name/blog/AutoComplete/TextSearchListBox.cs">TextSearchListBox.cs</a> </li>
</ul>

<p><em>Looking for a similar text searching control? </em>Download the <a href="http://www.codeplex.com/Silverlight/">Silverlight Toolkit December 2008</a> release and check out the <strong>AutoCompleteBox</strong> control - a text box that provides a rich drop-down with completion suggestions.</p>

<h3>Implementation Notes</h3>

<ul>
  <li>This is a simple example: no extra dependency properties have been defined. </li>

  <li>This really only works with the standard keyboard keys, no IME or advanced character support. </li>

  <li>Anywhere you have a ListBox, in theory you should be able to replace it with this sample control. </li>

  <li>Text search in this example does not have an automation peer, so the capability is not accessible or automatable. </li>

  <li>A nice improvement might be adding the IsTextSearchEnabled dependency property, similar to what WPF has defined on the ItemsControl, to turn this behavior on or off. Right now I assume that you always want the behavior if you use the derived control.</li>

  <li>Since Silverlight doesn't expose <strong>TextInput </strong>events like WPF does, I did have to go a little hacky in determining what characters were being typed. But in my brief testing with this app, it is working quite well anyway!</li>
</ul>

<p>Hope this helps! Let me know if you find this useful.</p>

          </div>
        </div>

      </div>

      <div class="col-md-4 wiki-sidebaZr" style="margin-top:18px">
            
    <p style="position: relative; width: 100%; height:195px; min-height: 120px; background: url(/jeffwilcox.png) no-repeat"></p>
    

    
<p class="lead" style="font-size:20px">
  Jeff Wilcox is a Software Engineer at Microsoft in the
  Open Source Programs Office (OSPO), helping Microsoft engineers
  use, contribute to and release open source at scale.
  
</p>
<!--
<p>
  Jeff is an alumnus of the University of Michigan, Ann Arbor, with
  a degree in Computer Science.
</p>
-->
    <p><a href="https://twitter.com/jeffwilcox" class="twitter-follow-button" data-show-count="true" data-size="medium">Follow @jeffwilcox</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></p>

    
       <div style="margin-top: 24px">
           <!-- small -->
               
           <!-- /small -->
       </div>
    

    <div id="toc" class="wiki-sidebar" style="margin-top: 24px">
    </div>
    <script type="text/javascript">
    $(document).ready(function() {
        $('#toc').toc({
            listType: 'ul',
            noBackToTopLinks: true,
            showEffect: 'none',
            extraListGoo: ' class="nav wiki-sidenav"',
            extraListGoo2: ' class="nav"',
            showSpeed: 0,
            title: '<h4>Blog Post Explorer</h4>',
            headers: '.blogcontent h1, .blogcontent h2',
            firstItemHtml: '<li><a href="#top">Start</a></li>',
        });
        $('body').scrollspy('refresh');
    });
    </script>

      </div>

    </div><!-- row -->
  </div><!-- container 1 -->

  <div id="related">
    <h4>Other posts</h4>
    <ul class="posts">
      
        <li><span>25 Nov 2019</span> &raquo; <a href="/2019/11/evcondo/">My $6,000 Tesla Wall Connector: the story of bringing Electric Vehicle charging to a high-rise condo tower in Seattle</a></li>
      
        <li><span>25 Jun 2019</span> &raquo; <a href="/2019/06/scaling-25k/">Scaling from 2,000 to 25,000 engineers on GitHub at Microsoft</a></li>
      
        <li><span>10 Apr 2018</span> &raquo; <a href="/2018/04/seattle-network/">My home network: Ubiquiti UniFi gear, fiber gigabit Internet, CAT6 and CAT3 wiring</a></li>
      
        <li><span>28 Feb 2017</span> &raquo; <a href="/2017/02/azure-private-npm/">Deploying Node.js apps in Azure App Service using private npm feeds from Visual Studio Team Services</a></li>
      
    </ul>
  </div>

  
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jeffwilcox';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



</div><!-- container 2 -->

<div class="container">  
<hr />

<footer class="wiki-footer">
  <p class="pull-right"><a href="#top">Back to top</a></p>
  <div class="links">
    <a href="/">jeffwilcox.blog</a> |
    <a href="https://twitter.com/jeffwilcox">@jeffwilcox</a> |
    <a href="https://github.com/jeffwilcox/">github.com/jeffwilcox</a> |
    <a href="http://linkedin.com/in/jeffreywilcox">linkedin profile</a> |
    <a href="http://www.google.com/recaptcha/mailhide/d?k=01Tv_GmcqyJ7mtRaeIIZEB4w==&c=PqTaC_u8CDIyO7wQDBRbQC1w7tGtyj-TDjnJupt4zLw=">email</a> |
    <a href="http://feeds.feedburner.com/jeffwilcox">rss</a>
  </div>
  <p><small>&copy; Jeff Wilcox<br />
  <span class="muted">Disclaimer: The content on this site represents my own personal opinions and thoughts at the time of posting, and does not reflect those of my employer in any way.</span></small></p>
</footer>

</div><!-- /container -->
<script src="//az414997.vo.msecnd.net/waz/syntax/scripts/shCore.js" type="text/javascript"></script>
<script src="//az414997.vo.msecnd.net/waz/syntax/scripts/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
function stxpath()
{
  var args = arguments, result = [];
  for(var i = 0; i < args.length; i++) {
      result.push(args[i].replace('@', '//az414997.vo.msecnd.net/waz/syntax/scripts/'));
  }
  return result;
};
SyntaxHighlighter.autoloader.apply(null, stxpath(
  'bash shell             @shBrushBash.js',
  'c# c-sharp csharp      @shBrushCSharp.js',
  'js jscript javascript  @shBrushJScript.js',
  'text plain             @shBrushPlain.js',
  'xml xhtml xslt html    @shBrushXml.js'
));
SyntaxHighlighter.defaults['gutter'] = false;
SyntaxHighlighter.defaults['tab-size'] = 2;
SyntaxHighlighter.defaults['class-name'] = 'code';
SyntaxHighlighter.all(); //'code', false, true: tag, showGutter, showControls
</script>
<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2695771-1");
pageTracker._trackPageview();
</script>
<!-- Google Analytics end -->
  </body>
</html>