<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Visual Studio unit testing intro - Jeff Wilcox</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Visual Studio unit testing intro">
    <meta name="author" content="Jeff Wilcox">
    

    <link href="http://feeds.feedburner.com/jeffwilcox" rel="alternate" title="Jeff Wilcox" type="application/atom+xml" />
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/jmw.css" rel="stylesheet"/>
    <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.4.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/jmw.js"></script>
    <link type="text/css" rel="stylesheet" href="//az414997.vo.msecnd.net/waz/syntax/styles/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="//az414997.vo.msecnd.net/waz/syntax/styles/shThemeDefault.css"/>
  </head>
<body data-spy="scroll" data-target=".wiki-sidebar">
    <div class="navbar navbar-inverse" role="navigation"><!-- formerly navbar-fixed-top -->
        <div class="navbar-inner">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Jeff Wilcox</a>
                </div>
                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>
                    <li><a href="/about/">About</a></li>
                    <li><a href="/posts/">Posts</a></li>
                    <li><a href="https://github.com/jeffwilcox">//github.com/jeffwilcox</a></li>
                    <li><a href="https://twitter.com/jeffwilcox">@jeffwilcox</a></li>
                    <li><a href="http://linkedin.com/in/jeffreywilcox">LinkedIn</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>



<div class="container">

  <div class="container">
    <div class="row">
      <div class="col-md-8">

        <div id="post">
          <h2 class="post-title"><!--<a href="/2008/08/utbasics/">-->Visual Studio unit testing intro<!--</a>--></h2>
          <div class="pull-right">
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="jeffwilcox" data-count="none">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></p>
          </div>
          <p id="date" class="muted">
            
            
            <small>
              16 August 2008
            </small>
            
            <!--
            <ul class="categories nav nav-pills">
            
            </ul>
            -->
            
          </p>

          <div class="blogcontent">
            <p>Visual Studio's unit testing framework isn't widely covered in books or in other places, and this makes it tougher for teams to adopt strict test guidelines for their developers. At the end of the day, if you aren't unit testing from day one of your project, you're in for a world of hurt down the line.</p> <p>If you've new to Visual Studio unit testing, or just wanting to learn about Silverlight unit testing, you may feel a little lost. Here's some information that just scratches the surface of the Visual Studio unit testing world.</p> <p>So here are some of the questions people may have, let me know if there are others that you have! If you're already familiar with unit testing this will all be redundant.</p> <h3>What makes up a unit test project?</h3> <p>Most unit tests are simple class libraries written in your language of choice. They reference your production application's projects or built assemblies, and also the unit test framework.</p> <p><img src="http://media.jeff.wilcox.name/blog/ut/UnitTestBasics.png"/> </p> <p>Metadata decorates the tests, and the tests themselves typically include calls to the test framework's assertion classes.</p> <h3>Where do I go to get started?</h3> <p>Must-read resources:</p> <ul> <li><a href="http://msdn.microsoft.com/en-us/library/ms243147.aspx">MSDN: Unit Testing Framework</a> (One page that covers just about all the metadata)</li> <li><a href="http://msdn.microsoft.com/en-us/library/ms182530.aspx">MSDN: Using the Assert Classes</a></li> <li><a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assert_methods.aspx">MSDN: The most common Assert methods</a></li> <li><a href="http://msdn.microsoft.com/en-us/library/ms182517.aspx">MSDN: Structure of Unit Tests</a></li> <li><a href="http://weblogs.asp.net/stephenwalther/">Stephen Walther</a> does a <a href="http://weblogs.asp.net/stephenwalther/archive/2008/03/19/tdd-test-driven-development-with-visual-studio-2008-unit-tests.aspx">very detailed walkthrough of unit testing</a>, with an emphasis on testing ASP.NET MVC code</li></ul> <p>Patterns and examples:</p> <ul> <li>The <a href="http://www.codeplex.com/CompositeWPF">Composite WPF guidance</a> by Microsoft's Patterns &amp; Practices includes tests</li> <li>TypeMock has a useful, general article about <a href="http://www.typemock.com/Docs/TestPatterns.html">unit testing patterns</a>. Note that their examples aren't using the Visual Studio metadata, but instead nUnit's... but it's pretty much the same.</li></ul> <p>Videos:</p> <ul> <li><a href="http://www.asp.net/learn/vsts-videos/video-126.aspx">Eric Lee</a> has an 11 minute screencast <a href="http://www.asp.net/learn/vsts-videos/video-126.aspx">walkthrough of unit testing</a> basics inside Visual Studio</li></ul> <p>For testing desktop applications, class libraries, and other code built for the full .NET framework, you're in for a treat: Visual Studio 2008 Professional and other SKUs put great built in unit test support right inside your development environment. You'll always be a click away from running a test or seeing where you stand.</p> <h3>What's a unit test?</h3> <ul> <li>Simple.  </li><li>Quick to run. </li><li>Independent and self-contained: Should not rely on any previous test results or any particular execution order.  </li><li>Doesn't cross any <a href="http://haacked.com/archive/2008/07/22/unit-test-boundaries.aspx">unit test boundaries</a> (as defined by <a href="http://haacked.com/Default.aspx">Phil Haack</a>) </li><li>Easy to maintain over time. Documented. Not archaic. </li><li>Lacking variability: a valid unit test should always consistently pass. </li><li>Positive or negative: They can validate exceptions and error conditions as well as expected results and states.</li></ul> <h3>What isn't a unit test?</h3> <ul> <li>A test that validates integration (your database and your class library).</li> <li>A test that interacts with UI, network resources, or the file system.</li> <li>Something that takes a long while to run.</li> <li>An end-to-end test of a user scenario.</li> <li>A performance, stress, load test, security, or other advanced test.</li> <li>Complex.</li></ul> <h3>What other kinds of tests are written?</h3> <p>There are integration tests, end-to-end tests, performance and stress tests, and many, many more. But at Microsoft I like to think of tests in 3 sets. In some cases it is possible for all the tests in a product to build upon a 'unit test framework'.</p> <p><strong>Unit</strong>: "True" unit tests. Quick, small, efficient, very useful to always run. Independent.</p> <p><strong>Developer</strong>: Unit tests plus tests that exercise simple scenarios and conditions, such as the control framework in WPF, or performing a super simple request. Often these reach outside of the typical "unit test boundaries," but are still quick to run and useful.</p> <p>Developers are typically required to run all of the developer tests on their machine when preparing a check-in to validate the state of the code.</p> <p><strong>All tests</strong>: The set of all developer tests and everything that the test development team has created. Sometimes reaches into the tens of thousands of scenarios and cases at the end of a product cycle once a matrix of platforms and configurations is taken into consideration.</p> <p>Developers and testers work together to make sure that all tests are run regularly, and especially when working on approaching a major product milestone, release, or servicing activity.</p> <h3>Why would you use a unit test framework to create more than unit tests?</h3> <ul> <li>Consistency.</li> <li>Can usually run many integration and scenario tests in the same test runs.</li> <li>Run integration tests on many platforms in an automated fashion using test controllers and harnesses.</li> <li>The definition of a unit test is pretty academic. At the end of the day, I want to get my job done efficiently and without needing to continually learn new systems. So doing more than true "unit testing" is cool with me.</li> <li>Allow your developers and test developers to share experience, test cases, and help each other succeed.</li></ul> <h3>Why does the Silverlight unit testing framework have tests that look just like the full desktop framework's? Are they the same? </h3> <p>When building out the <a href="http://www.jeff.wilcox.name/2008/03/31/silverlight2-unit-testing/">Silverlight unit test system</a> that runs tests inside of your web browser, we made the call to reuse Visual Studio's unit test framework metadata. This is a great win, for a few reasons:</p> <ul> <li>Reuse of existing tests: many simple API tests can be run as they are.  </li><li>Many .NET developers already know Visual Studio's unit test framework, or nUnit. No need to waste time learning the basics of another system. </li><li>If you're new to Microsoft's unit testing framework in general and starting with Silverlight, you'll walk away with the information you need to start unit testing in Visual Studio as well.  </li><li>Why re-invent the wheel?</li></ul> <h3>I like the Silverlight test framework, but how can I make sure that my tests can be ported to a desktop Windows Forms, class library, or WPF project?</h3> <p>Make sure that your unit tests are actually small, independent, simple, and not dependent on the web browser, Silverlight itself, or the more advanced "beyond unit testing" capabilities that are also present in Microsoft.Silverlight.Testing. If you inherit from the "SilverlightTest" base class, you probably have a test that won't port to the desktop .NET framework.</p> <p>We've worked hard to provide a subset of the full Visual Studio unit test metadata, but here's a quick guide for you:</p> <p><strong>OK to use in both worlds:</strong></p> <ul> <li>All the metadata attributes including TestClass, TestMethod, ClassInitialize, ClassCleanup, TestInitialize, TestCleanup, AssemblyInitialize, AssemblyCleanup, Ignore.</li> <li>StringAssert, Assert, CollectionAssert static types.</li></ul> <p><strong>Desktop features that will not work with the Silverlight test framework today (or are no-ops):</strong></p> <ul> <li>Data-driven tests</li> <li>TestContext</li> <li>File-based assertions and accessing the file system</li> <li>Using WorkItem or TestProperty attributes</li> <li>Web/ASP.NET test functionality.</li> <li>DeploymentItem.</li></ul> <p><strong>Silverlight test features that will not port to the desktop:</strong></p> <ul> <li>Using Silverlight or web browser features.</li> <li>Inheriting from the SilverlightTest base class.</li> <li>Using any of the Silverlight "TestSurface" or TestPanel features exposed by the SilverlightTest base class.</li> <li>Using the "Asynchronous" features in the framework, including the Enqueue and test work item / test task features.</li> <li>Using any of the attributes defined in the Microsoft.Silverlight.Testing namespace, such as AsynchronousAttribute, BugAttribute, and ExclusiveAttribute.</li> <li>Writing your own UnitTestProvider, your own Harness, or your own UnitTestHarness</li> <li>Writing your own test tasks and work items.</li></ul> <p>Hope this helps get some of you started!</p>

          </div>
        </div>

      </div>

      <div class="col-md-4 wiki-sidebaZr" style="margin-top:18px">
            
    <p style="position: relative; width: 100%; height:195px; min-height: 120px; background: url(/jeffwilcox.png) no-repeat"></p>
    

    
<p class="lead" style="font-size:20px">
  Jeff Wilcox is a Software Engineer at Microsoft in the
  Open Source Programs Office (OSPO), helping Microsoft engineers
  use, contribute to and release open source at scale.
  
</p>
<!--
<p>
  Jeff is an alumnus of the University of Michigan, Ann Arbor, with
  a degree in Computer Science.
</p>
-->
    <p><a href="https://twitter.com/jeffwilcox" class="twitter-follow-button" data-show-count="true" data-size="medium">Follow @jeffwilcox</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></p>

    
       <div style="margin-top: 24px">
           <!-- small -->
               
           <!-- /small -->
       </div>
    

    <div id="toc" class="wiki-sidebar" style="margin-top: 24px">
    </div>
    <script type="text/javascript">
    $(document).ready(function() {
        $('#toc').toc({
            listType: 'ul',
            noBackToTopLinks: true,
            showEffect: 'none',
            extraListGoo: ' class="nav wiki-sidenav"',
            extraListGoo2: ' class="nav"',
            showSpeed: 0,
            title: '<h4>Blog Post Explorer</h4>',
            headers: '.blogcontent h1, .blogcontent h2',
            firstItemHtml: '<li><a href="#top">Start</a></li>',
        });
        $('body').scrollspy('refresh');
    });
    </script>

      </div>

    </div><!-- row -->
  </div><!-- container 1 -->

  <div id="related">
    <h4>Other posts</h4>
    <ul class="posts">
      
        <li><span>25 Nov 2019</span> &raquo; <a href="/2019/11/evcondo/">My $6,000 Tesla Wall Connector: the story of bringing Electric Vehicle charging to a high-rise condo tower in Seattle</a></li>
      
        <li><span>25 Jun 2019</span> &raquo; <a href="/2019/06/scaling-25k/">Scaling from 2,000 to 25,000 engineers on GitHub at Microsoft</a></li>
      
        <li><span>10 Apr 2018</span> &raquo; <a href="/2018/04/seattle-network/">My home network: Ubiquiti UniFi gear, fiber gigabit Internet, CAT6 and CAT3 wiring</a></li>
      
        <li><span>28 Feb 2017</span> &raquo; <a href="/2017/02/azure-private-npm/">Deploying Node.js apps in Azure App Service using private npm feeds from Visual Studio Team Services</a></li>
      
    </ul>
  </div>

  
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jeffwilcox';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



</div><!-- container 2 -->

<div class="container">  
<hr />

<footer class="wiki-footer">
  <p class="pull-right"><a href="#top">Back to top</a></p>
  <div class="links">
    <a href="/">jeffwilcox.blog</a> |
    <a href="https://twitter.com/jeffwilcox">@jeffwilcox</a> |
    <a href="https://github.com/jeffwilcox/">github.com/jeffwilcox</a> |
    <a href="http://linkedin.com/in/jeffreywilcox">linkedin profile</a> |
    <a href="http://www.google.com/recaptcha/mailhide/d?k=01Tv_GmcqyJ7mtRaeIIZEB4w==&c=PqTaC_u8CDIyO7wQDBRbQC1w7tGtyj-TDjnJupt4zLw=">email</a> |
    <a href="http://feeds.feedburner.com/jeffwilcox">rss</a>
  </div>
  <p><small>&copy; Jeff Wilcox<br />
  <span class="muted">Disclaimer: The content on this site represents my own personal opinions and thoughts at the time of posting, and does not reflect those of my employer in any way.</span></small></p>
</footer>

</div><!-- /container -->
<script src="//az414997.vo.msecnd.net/waz/syntax/scripts/shCore.js" type="text/javascript"></script>
<script src="//az414997.vo.msecnd.net/waz/syntax/scripts/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript">
function stxpath()
{
  var args = arguments, result = [];
  for(var i = 0; i < args.length; i++) {
      result.push(args[i].replace('@', '//az414997.vo.msecnd.net/waz/syntax/scripts/'));
  }
  return result;
};
SyntaxHighlighter.autoloader.apply(null, stxpath(
  'bash shell             @shBrushBash.js',
  'c# c-sharp csharp      @shBrushCSharp.js',
  'js jscript javascript  @shBrushJScript.js',
  'text plain             @shBrushPlain.js',
  'xml xhtml xslt html    @shBrushXml.js'
));
SyntaxHighlighter.defaults['gutter'] = false;
SyntaxHighlighter.defaults['tab-size'] = 2;
SyntaxHighlighter.defaults['class-name'] = 'code';
SyntaxHighlighter.all(); //'code', false, true: tag, showGutter, showControls
</script>
<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2695771-1");
pageTracker._trackPageview();
</script>
<!-- Google Analytics end -->
  </body>
</html>