<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Jeff Wilcox</title>
 <link href="http://www.jeff.wilcox.name/atom.xml" rel="self"/>
 <link href="http://www.jeff.wilcox.name/"/>
 <updated>2020-12-20T23:41:46+00:00</updated>
 <id>http://www.jeff.wilcox.name/</id>
 <author>
   <name>Jeff Wilcox</name>
   <email>jwgithub@outlook.com</email>
 </author>

 
 <entry>
   <title>My $6,000 Tesla Wall Connector: the story of bringing Electric Vehicle charging to a high-rise condo tower in Seattle</title>
   <link href="http://www.jeff.wilcox.name/2019/11/evcondo/"/>
   <updated>2019-11-25T00:00:00+00:00</updated>
   <id>http://www.jeff.wilcox.name/2019/11/evcondo</id>
   <content type="html">&lt;p&gt;&lt;em&gt;After commuting home from the office I carefully park, step out of the car, grab the
charging cable looped around the Tesla Wall Connector, press the button on the cable,
and the car’s charge port door opens, letting me quickly plug in the car.
I wake up in the morning with the confidence that I can go anywhere I need to: work,
weekend errands, travel over a nearby mountain pass…yet &lt;strong&gt;getting to this basic routine
took over 4 years. EV charging can be an uphill battle in many condo associations&lt;/strong&gt;.
Without a clear path to charging at home, I wouldn’t have placed an order for a
Tesla and would still be driving a gasoline car.&lt;/em&gt;&lt;/p&gt;

&lt;h1 id=&quot;overview&quot;&gt;Overview&lt;/h1&gt;

&lt;p&gt;Our EV conversation started in 2010, a community charger was added in 2016, and in 2019 a policy
allowing “Limited Common” (individual chargers in owner’s parking spaces) was approved and
implemented in 2019, including installing new electric infrastructure.&lt;/p&gt;

&lt;p&gt;Installing Electric Vehicle Supply Equipment (EVSE) for any electric car is straightforward and
can often be done in a single-family home garage for under $700, including an electric permit and inspection;
yet an EVSE install in a large multi-family building can easily cost $3,000-10,000 or more per
port once electric infrastructure costs, wire, long conduit runs, and core drilling costs are factored in,
especially to non-adjacent locations.&lt;/p&gt;

&lt;p&gt;The downtown Seattle condo tower I live in was constructed in 2002 and has ~200 units, 240
parking spaces in 4 underground levels, constructed of steel and post-tensioned concrete. We
have gigabit community WiFi in the garage which is great for getting Tesla software updates.&lt;/p&gt;

&lt;p&gt;The building’s electricity is 3-phase 480Y/277V served by Seattle City Light. Even if a building
like ours has sufficient remaining capacity to support charging loads without a larger
utiliy transformer, preparing for many Electric Vehicle (EV) charging installations can get
expensive: there may be a need for switchgear work, breakers, step-down transformers,
new panels or sub-panels, running conduit hundreds of feet through multiple levels of concrete).&lt;/p&gt;

&lt;p&gt;Here’s a look at our Electric Vehicle charging infrastructure as deployed today, from the
building switchgear to a step-down transformer, dedicated EV circuit panel, conduit to individual EVSEs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;//az414997.vo.msecnd.net/waz/2019ev/mashup.jpg&quot; target=&quot;_new&quot;&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/mashup.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A set of photos from the installation in my building: the building switchboard, new transformer, EV panel and sub-meters, conduit, and Electric Vehicle Supply Equipment.&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Washington State is &lt;em&gt;not&lt;/em&gt; a “right-to-charge” state, so there is no law requiring an
apartment or condo to allow EV charging. The &lt;a href=&quot;http://www.seattle.gov/sdci/codes/codes-we-enforce-(a-z)/electrical-code&quot;&gt;Seattle Electric Code&lt;/a&gt; (2014, 2017)
is requiring new buildings to provision capacity (feeders, panel space, planned load) and conduit in
garages for EV charging, so new construction will be OK - but it will be a challenge for existing
multi-family communities to efficiently invest in charging infrastructure to remain competitive. In fact,
new developers are monetizing these code requirements by selling EV-enabled parking spaces similar to a granite 
kitchen backsplash upgrade.&lt;/p&gt;

&lt;p&gt;A condo building’s units are owned by individuals who form the members of a Home Owner’s Association (HOA),
governed by a board elected by the members, and all rights and privileges are granted through laws and
the association’s governing documents and rules.&lt;/p&gt;

&lt;p&gt;I was mentally prepared for a period of educating decisionmakers and residents, working to
help design a fair approach, and working to implement that policy through the association board,
but I was not expecting the inertia that yielded “false starts” and decisions to “wait and see.”&lt;/p&gt;

&lt;p&gt;After reservations started on the Tesla Model 3, interest increased in the community as
an affordable great product came on the horizon, but it was important to the HOA that any
private charging investments be paid for without long-term costs borne by all owners, to be fair.&lt;/p&gt;

&lt;p&gt;At our annual member’s meeting in 2019 we finally had enough interest to kick off a project,
hold an “EV Open House” to educate and inform owners, propose rules, and finally offer reservations
in our first phase &lt;em&gt;Limited Common EV Charging Policy&lt;/em&gt;, allowing individual owners to have
professionals install charges in the hub-and-spoke charging project.&lt;/p&gt;

&lt;p&gt;Often it just takes a few people to voice their opinions, present a reasonable plan,
and help see it through, but it takes hard work, educating the community, and
doing the legwork of finding an electrical engineering firm or electrician that you
can trust.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;As a result of our charging projects, the number of EVs in our building has rapidly
increased after years of “no demand”.&lt;/strong&gt; The information in this post is applicable to
any EV/PHEV charging program, it is not specific to Tesla.&lt;/p&gt;

  &lt;p&gt;In this post I wanted to share the experience we had and tips for others. Many EV
forums have anecdotes about condos and apartments but not many end-to-end stories. I
am not an expert, but feel there’s a lot to share.&lt;/p&gt;

  &lt;p&gt;Having EV charging available to those that need it can add that can benefit an
individual unit or an entire building. There are buyers who will expect options and
so have any EV policy in place can help attract and retain association members.&lt;/p&gt;

  &lt;p&gt;This recollection is based on several conversations and association notes, but
many of these events took place years before I purchased a property in the building,
so take this all with a grain of salt.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/TeslaGarageCropped.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;h1 id=&quot;limited-common-charging-2019&quot;&gt;Limited Common charging (2019)&lt;/h1&gt;

&lt;p&gt;In 2019 information gathered in the previous year was presented at the annual
January owner’s meeting, a proposal was posted in March, approved in May, and reservations
and installations happened through June and September by our first round of 8 owners
who reserved circuits in the infrastructure.&lt;/p&gt;

&lt;p&gt;The culmination of years of work,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Electric capacity and required infrastructure needed to be identified, including quotes/bids&lt;/li&gt;
  &lt;li&gt;Sufficient committed demand had to be identified to greenlight a project that would have no
long-term cost borne by the association&lt;/li&gt;
  &lt;li&gt;A policy to cover association requirements for installations, contractors, edge cases had
to be drafted, brought to the board for the required notice period, and implemented&lt;/li&gt;
  &lt;li&gt;Enough owners to reserve into the project without dipping into association funds was necessary&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;available-electric-capacity&quot;&gt;Available electric capacity&lt;/h2&gt;

&lt;p&gt;At the time of our building’s construction, electric cars were a pipe dream (GM’s EV-1 was California only),
so the building’s electric plans were designed to support just residential units
and building systems. The garage wasn’t wired with spare circuits in its slabs beyond
a few 120-volt outlets anticipated for maintenance.&lt;/p&gt;

&lt;p&gt;Our building’s connected to the grid by a 480Y/277V 3-phase 4-wire system with 2
switchgears: MDS-1 up to 1600 amps and MDS-2 up to 1200 amps.&lt;/p&gt;

&lt;p&gt;Many of our common hallway and garage lights are single-phase 277V fixtures, while
residences use energy stepped down to 120/208V, and we also have a diesel emergency
generator and transfer switch sitting behind a portion of the MDS-2 load.&lt;/p&gt;

&lt;p&gt;Having two separate switchgear turns out to be a significant positive development:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;MDS-1 switchgear (residential units) was designed for the building’s residential load and
any additional load would require load studies, plan review, potentially auditing appliances
and other use of all units, and adding new equipment to the switchgear would require turning
off power to all residential units for a few hours. Attached to this are a set of transformers
and all the individual utility meters for units.&lt;/li&gt;
  &lt;li&gt;MDS-2 (house/commercial) provides 480-volt and 277-volt electricity to a core set of lights
and elevators backed up by a diesel emergency generator, and then also additional lights
in common areas such as hallways, the lobby, exterior lighting. Thanks to the utility’s data
from its Peak Demand Meter, we learned that over the past several years, it is using at most
11% of its available capacity. &lt;em&gt;Perfect candidate to add EV infrastructure to without impacting
residential units.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If we had not identified such a place, we would have had to work with the utility to
bring in additional service, enlarge existing service, update switchgear with new breakers,
etc. A risk with a larger utility transformer can be fees if you do not end up utilizing the
new capacity sufficiently.&lt;/p&gt;

&lt;p&gt;We also learned that we could use the peak demand data to work with inspectors to install
the largest sized transformer and amperage panel that an over-the-counter (OTC) permit could
allow to minimize engineering, electric load study or plan review requirements (likely
not required with an OTC permit).&lt;/p&gt;

&lt;p&gt;To accomodate a group of 8-10 chargers (depending on the amperage of the EVSEs planned), we
would need:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;a new 3-phase 480Y/277V breaker installed in the MDS-2 switchgear&lt;/li&gt;
  &lt;li&gt;a 75KVA transformer to step down the power to 120/208V&lt;/li&gt;
  &lt;li&gt;a new electric panel dedicated to this set of EV branch circuits&lt;/li&gt;
  &lt;li&gt;an over-the-counter permit for the work and to have the authority having jurisdiction inspect and approve the install&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We received and reviewed bids and different approaches. It was determined that there was
sufficient space inside the main electric room, which is on one of the garage levels, for
this phase of the project.&lt;/p&gt;

&lt;h2 id=&quot;hubspoke-decision&quot;&gt;Hub/spoke decision&lt;/h2&gt;

&lt;p&gt;Except for the 3 parking spaces that the association owns for staff use, all other parking
spaces are assigned to individual units. The assignment is made in a table in the
declaration document that allocates units to “Limited Common” resources like parking,
unit balconies, and storage. In condo speak, a Limited Common part of the property is
commonly owned by the building but is intended for use by a specific 1 or more units.
Parking spaces can be reassigned and sold between owners, though this requires a declaration
ammendment and recording with the county, so can be expensive.&lt;/p&gt;

&lt;p&gt;It was determined that an EV project would be significantly cheaper for all owners if a
single row of chargers was installed, but asking owners to have to reassign spaces to
accomplish this goal would be a non-starter and halt the process as the “value” of parking
spaces could dramatically change from the original assignments.&lt;/p&gt;

&lt;p&gt;A “spoke” model was decided upon: from the new panel’s location, those who reserved circuits
in the panel would be responsible for hiring a licensed, bonded, insured electrician to
install the spoke from a circuit breaker in the panel to conduit mounted on the concrete ceilings
and then to the EVSE units. This would be the entire responsibility of the owner who would
need to hold harmless the association from the work. In return, they would be granted approval
from the association board for the installation in common and limited common, subject to
the policy.&lt;/p&gt;

&lt;h2 id=&quot;annual-meeting-momentum&quot;&gt;Annual meeting momentum&lt;/h2&gt;

&lt;p&gt;Leading up to the annual meeting in January 2019, significant legwork done in previous
years meant that we had a very clear vision for what our first private charging project
would look like. This is one meeting per year where a large set of members in the condo
are present to vote on board positions, so a great chance to poll many people and bring
forward priorities for the coming year.&lt;/p&gt;

&lt;p&gt;A brief presentation covered the false starts of the past decade (EV charging had come up
at almost every annual meeting for 4 years) to propose an EV project:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;presented new information about load and capacity for the building and being able to use MDS-2,&lt;/li&gt;
  &lt;li&gt;celebrated the success of the community’s one shared EV charger amenity,&lt;/li&gt;
  &lt;li&gt;recognized that private charging will be entirely paid for by owners who buy into the project,&lt;/li&gt;
  &lt;li&gt;set a range of expected cost per unit from $5,000-$10,000&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By a raise of hands, owners were excited about the option finally being considered in
a state to move forward in the year. Since there were many details to figure out, this
was about taking the temperature of a large group of owners, not about a motion or
specific plan.&lt;/p&gt;

&lt;p&gt;An outcome of the strong support was a hope to use monthly meetings to solidify a plan,
consult with the rules committee, hold an open house, and see if owners really were willing
to put money down to reserve the limited space in the anticipated project.&lt;/p&gt;

&lt;h3 id=&quot;ev-open-house-and-tour&quot;&gt;EV Open House and Tour&lt;/h3&gt;

&lt;p&gt;An EV open house was scheduled to present to the association’s interested owners information
about electric vehicles, charging, traveling with an EV, etc.&lt;/p&gt;

&lt;p&gt;The agenda for that open house was:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;half an hour briefing in the club room
    &lt;ul&gt;
      &lt;li&gt;all about EVs,&lt;/li&gt;
      &lt;li&gt;charging at work, on-the-go, at home,&lt;/li&gt;
      &lt;li&gt;we had a sample Tesla Wall Connector EVSE available to show everyone what it looks like&lt;/li&gt;
      &lt;li&gt;slides about available car models and price points,&lt;/li&gt;
      &lt;li&gt;the building’s anticipated approach to charging&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;half an hour garage tour
    &lt;ul&gt;
      &lt;li&gt;toured the main electric room to explain infrastructure requirements&lt;/li&gt;
      &lt;li&gt;looked at several electric vehicles available for owners to sit in, see&lt;/li&gt;
      &lt;li&gt;test drives and rides around the neighborhood in electric vehicles&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/openhouse.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A photo of a community Electric Vehicle open house&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The open house was a great inflection point for interest and brought a number of new
people into the conversation, immediately shifting the community toward “OK, let’s do this”.&lt;/p&gt;

&lt;h2 id=&quot;reservations&quot;&gt;Reservations&lt;/h2&gt;

&lt;p&gt;Past attempts in the building had always had to deal with the chicken-and-egg problem of
EV ownership: without a clear path to charging in the building, very few people owned
EVs.&lt;/p&gt;

&lt;p&gt;After the association installed the shared charger in 2016, there was an uptick in
EV ownership, but only to 2-3 vehicles, only 1 owner which wanted to have the right
to spend their own money on installing a private charger.&lt;/p&gt;

&lt;p&gt;With a desire to keep not have the community contributing to the private charging project,
the compromise was that a policy, contingent on a sufficient number of reservations, would
be approved. Reservations would be accepted on a first-come, first-served basis for
cicuits, and be refundable only if the project is not approved.&lt;/p&gt;

&lt;p&gt;The price of reservations was set slightly higher than the anticipated cost of a share
of the infrastructure work, so that if all available circuits were reserved, the project
would be fully funded by the owners, and a small surplus of money could be saved in an
account for future EV project planning.&lt;/p&gt;

&lt;p&gt;The board, taking community input, decided that if 5 reservations were placed, they
would approve the project.&lt;/p&gt;

&lt;p&gt;The rules would also be crafted to recognize that if an owner decided not to install
a circuit, they could transfer the reservation to another owner, to encourage potential
EV owners to buy in to the project.&lt;/p&gt;

&lt;h2 id=&quot;sub-meters&quot;&gt;Sub-meters&lt;/h2&gt;

&lt;p&gt;Our association’s declaration document is clear that for additional utility installations,
sub-meters can and should be used.&lt;/p&gt;

&lt;p&gt;To be most fair, and only charge owners for their energy used, it was decided that
participants in the EV charging project must have a specific revenue-grade sub-meter
product installed adjacent to the electric panel to record the individual circuit’s
energy use.&lt;/p&gt;

&lt;p&gt;Quarterly, our staff or management company would read the meters and charge units for
the net new energy used, at cost.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/submeters.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;A sub-meter adds around $1,000 to the installation cost of each spoke circuit. If
our declaration had been worded differently, we likely would not have required sub-meters
and instead considered other approaches that other buildings have used. However, this
was the most fair to the owners and board at the time of the decision.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;fees-for-ongoing-use&quot;&gt;Fees for ongoing use&lt;/h2&gt;

&lt;p&gt;Our condo already has several paid amenities, such as guest suites, and so regularly collects
payment by credit card and check for a number of different fees and fines defined by the rules
and policies.&lt;/p&gt;

&lt;p&gt;The three fees eventually agreed upon for the project were:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The one-time, non-refundable reservation fee to have a circuit assigned in the project.&lt;/li&gt;
  &lt;li&gt;An annual fee of $50 to cover the minimal overhead of the project
    &lt;ul&gt;
      &lt;li&gt;Quarterly meter reading by our staff, and processing of payments&lt;/li&gt;
      &lt;li&gt;Any credit card fees associated with energy reimbursement&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Quarterly energy reimbursement&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;level-2-evses-not-outlets&quot;&gt;Level 2 EVSEs, not outlets&lt;/h2&gt;

&lt;p&gt;In electric vehicle charging, there are 3 commonly recognized levels of charging:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Level 1 charging is a standard 120V 15-amp or 20-amp circuit that trickle charges&lt;/li&gt;
  &lt;li&gt;Level 2 charging is the home charging standard, 208/240V 20-amp or more circuit&lt;/li&gt;
  &lt;li&gt;Level 3 charging is DC fast charging, Tesla Supercharger, etc., which would be insanely expensive to install in a private residence&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Given this EV project was targeting early adopters, those willing to invest in the infrastructure,
and likely costing thousands of dollars, we decided that the project will target up to
10 Level 2 chargers. While owners would be allowed to install a Level 1 charger if they wanted,
or a trickle charger for an exotic car, they would not be the primary target of the program.&lt;/p&gt;

&lt;p&gt;The electric code requirements for garages such as ours indicates that an outlet (120V, 240V, etc.)
must now be installed on a circuit with ground protection, as they may be exposed to the
wet elements.&lt;/p&gt;

&lt;p&gt;Considering the grounding requirement and also that charging stations are much more clean than
having mobile charging connectors around, we decided that our 240V installations must all be of
an approved EVSE model, and not an outlet. Outlets would only be allowed for a Level 1 trickle charger.&lt;/p&gt;

&lt;h2 id=&quot;specific-breaker-sizes&quot;&gt;Specific breaker sizes&lt;/h2&gt;

&lt;p&gt;To maximize the use of the new infrastructure, there was a need to compromise some on
the size of circuit breakers (thereby setting the size of the EVSE units owners could install).&lt;/p&gt;

&lt;p&gt;The National Electric Code designates that an electric vehicle circuit be treated like
a continuous load, so there is a 125% buffer requirement on the load: a 40-amp EV charger
needs to be installed with a 50-amp circuit breaker, an 80-amp circuit would need a 100-amp
breaker, etc.&lt;/p&gt;

&lt;p&gt;In new single-family home installs, Tesla, Audi e-Ton, and other high-end EVs often opt
for the largest circuit their panel can support, to maximize the charging, and “because
the numbers are big and cool.”&lt;/p&gt;

&lt;p&gt;The reality is that an EV is rarely charging an empty battery - in common daily use, it’s
just topping off the battery over a few hours from that day’s drive. The acceptance rate
of many EVs is also not always high enough to support large breaker sizes. The
cost of wire and size of conduit increase as the 208/240V amperage goes up, too.&lt;/p&gt;

&lt;p&gt;The City of Seattle designates that a Level 2 EV charger is one that is 20-amps or more.
With a 20-amp charger and a regional daily commute, a typical EV would be able to recharge
for that commute in 3-5 hours, easily overnight, so we decided to accept the city’s minimum
Level 2 designation as the baseline.&lt;/p&gt;

&lt;p&gt;If enough owners were OK with a 20-amp charger on a 25-amp circuit breaker, we would
get more charging circuits out of the project.&lt;/p&gt;

&lt;p&gt;We set the reservation prices at:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$1,000 for a 20-amp EVSE (25-amp circuit breaker)&lt;/li&gt;
  &lt;li&gt;$2,000 for a 32-amp EVSE (40-amp circuit breaker)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We decided not to offer larger breaker sizes in this project to
maximize participation:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;40-amp EVSE on a 50-amp circuit (a very common EV circuit size)&lt;/li&gt;
  &lt;li&gt;50-amp, 60-amp and 80-amp (not necessary unless load sharing among multiple chargers)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There’s a lot of FUD from people less familiar with EVs - especially Audi dealers -
that you need to have the largest size installation, otherwise “your e-tron will take
days to charge.”&lt;/p&gt;

&lt;h2 id=&quot;cost-breakdown&quot;&gt;Cost breakdown&lt;/h2&gt;

&lt;h3 id=&quot;infrastructure-cost&quot;&gt;Infrastructure cost&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/transformerpad.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The best bid that we had on this project was as follows:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$10,900
    &lt;ul&gt;
      &lt;li&gt;Purchase an electrical permit and have the work inspected/signed-off by the authority having jurisdiction&lt;/li&gt;
      &lt;li&gt;Pre-inspection review of project&lt;/li&gt;
      &lt;li&gt;Purchase and install a switchgear breaker&lt;/li&gt;
      &lt;li&gt;Provide and install a 75KVA transformer&lt;/li&gt;
      &lt;li&gt;Form and pour a housekeeping pad for the transformer&lt;/li&gt;
      &lt;li&gt;Provide and install a 200-amp main breaker 3-phase 4-wire panel&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;$300
    &lt;ul&gt;
      &lt;li&gt;Provide and install 7 2P-40A and 1 2P-25A breakers&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Total of just over $11,000. There was no sales tax thanks to a Washington State
EV infrastructure exemption. Originally set to expire in 2019, it’s since been
extended into 2025.&lt;/p&gt;

&lt;h3 id=&quot;individual-cost&quot;&gt;Individual cost&lt;/h3&gt;

&lt;p&gt;This was the cost of my installation, about 250’ from the main electric room.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$2,000
    &lt;ul&gt;
      &lt;li&gt;Circuit reservation fee paid to the association to buy into the shared infrastructure project&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;$549 EVSE
    &lt;ul&gt;
      &lt;li&gt;Tesla Wall Connector&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;$3,500 Electrician Services
    &lt;ul&gt;
      &lt;li&gt;Wire in a 120/208V 1-phase 32-amp feed from the new EV1 panel to the specific parking column using 3/4” EMT conduit&lt;/li&gt;
      &lt;li&gt;Install a 60-amp HD disconnect on the feed ahead of the car charger (optional)&lt;/li&gt;
      &lt;li&gt;Wire in and configure an owner-provided Tesla Wall Connector&lt;/li&gt;
      &lt;li&gt;Provide and install an electric deduct meter adjacent to the panel to monitor car charging power&lt;/li&gt;
      &lt;li&gt;Purchase an electrical permit and have the work inspected/signed-off&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Total cost of $6,049. No sales tax thanks to 2019 EV infrastructure exemption.&lt;/p&gt;

&lt;h2 id=&quot;contingent-policy-approved&quot;&gt;Contingent policy approved&lt;/h2&gt;

&lt;p&gt;In one of the early meetings of the year the rules committee presented a proposed policy and
updates to the fees/fines table to cover the new project.&lt;/p&gt;

&lt;p&gt;Following the standard review period, in the May association meeting the policy and rules
were unanimously approved by the board and so the project entered the phase of waiting for
sufficient paid reservations.&lt;/p&gt;

&lt;p&gt;Owners were strongly encouraged to get quotes from multiple electricians as part
of determining whether they wanted to participate in the program. Interestingly, very
few of the owners believed the initial quotes that installs could be “$5,000 or so”. In
hindsight, we should have required that owners provided at least 1 quote to show that
they were very serious about the project and aware of the potential costs involved
in building out their spoke of the system.&lt;/p&gt;

&lt;p&gt;In the month following the approval, 5 owners paid the reservation fee, and the board
approved the electric infrastructure upgrades. The cost of the upgrades was around $11,000,
and with 5 owners reserved (4x 32-amp chargers and 1x 20-amp charger), the associated had
received $9,000, and once the additional reservations were sold, the project would have a
surplus.&lt;/p&gt;

&lt;h2 id=&quot;construction-begins&quot;&gt;Construction begins&lt;/h2&gt;

&lt;p&gt;In late April the electricians were on site. They pulled a permit from the city and
then schedule a pre-install inspection to meet with the inspector, discuss the project
approach, share the load data and other information, to make sure there would be no
roadblocks along the way for this straightforward project.&lt;/p&gt;

&lt;p&gt;Following the inspector meeting the crew started preparing the concrete housekeeping pad
for the new transformer, making preparations and ordering parts.&lt;/p&gt;

&lt;p&gt;The electricians also walked the garage with owners who had placed reservations to
offer quotes for their spoke installs. While our owners were free to solicit any licensed,
bonded, and insured electrician, many chose to work with the same firm performing the hub
installation.&lt;/p&gt;

&lt;h2 id=&quot;planned-power-outage&quot;&gt;Planned power outage&lt;/h2&gt;

&lt;p&gt;Installing the new breaker in the switchgear required shutting down power to
other portions of the garage and commercial area.&lt;/p&gt;

&lt;p&gt;This turned into a great opportunity to test the building’s diesel generator emergency
circuits, learn what systems worked as expected, and what did not. While we do
a quarterly generator test, these use a simulated transfer switch, and not an actual
transfer of the electric load off of the utility grid.&lt;/p&gt;

&lt;p&gt;Planned for 3:00am on a specific day to minimize impact, power was turned off
and it was fun seeing the emergency garage lights stay on, the elevators
continue to function, etc., once the diesel generator clicked on. We worked
with our on-site building manager to walk the facility and record systems of
note that were not functioning as expected, or on the wrong circuit, so it was
the first real test since the building opened to occupants over 15 years ago.&lt;/p&gt;

&lt;p&gt;Since the switchgear where the infrastructure was being connected is separate
from the residential systems, no residential units lost electricity, and while
we warned residents of the planned outage, we were confident they would not
be impacted.&lt;/p&gt;

&lt;h2 id=&quot;project-completion&quot;&gt;Project completion&lt;/h2&gt;

&lt;p&gt;In May, we received our 8th reservation check and the board closed the project
to new reservations. Our treasurer setup a new account dedicated to future EV
projects with the proceeds.&lt;/p&gt;

&lt;p&gt;Several of the owners went forward with ordering new cars such as the Tesla Model 3
and taking delivery.&lt;/p&gt;

&lt;p&gt;Circuits were installed throughout the garage; some were wired to EVSEs right away,
one was wired for a trickle charger today and also wire for a future Level 2 charger,
and a few had conduit installed with pull string but no wire for in anticipation of
the owner taking eventual delivery in 2020 or 2021 of an Audi they wanted to wait on.&lt;/p&gt;

&lt;p&gt;In the garage we now see several Teslas, another Chevy Volt, a Chevy Bolt, and the
community charger is now being used by 6 owners at various times who chose not
to invest in the Limited Common charging project.&lt;/p&gt;

&lt;h2 id=&quot;retrospective-learnings&quot;&gt;Retrospective learnings&lt;/h2&gt;

&lt;p&gt;In retrospect, if we were to revisit this project again, we may want to take
more information we have learned and consider alternative options.&lt;/p&gt;

&lt;h3 id=&quot;per-circuit-sub-meters-are-expensive&quot;&gt;Per-circuit sub-meters are expensive&lt;/h3&gt;

&lt;p&gt;Our community felt strongly that not only should the cost of the project
for private charging be covered exclusively by the individuals benefitting, but
similar to energy use at home, energy use should be metered and paid for by
the individuals.&lt;/p&gt;

&lt;p&gt;In some buildings it may be possible to add new meter stacks with utility
meters and separate bills, but since we used the “house meter” from the city,
this meant that the options were:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Put a single sub-meter on the entire EV panel, and evenly split the cost of energy used by all 8 participants&lt;/li&gt;
  &lt;li&gt;Place sub-meters on each EV circuit, having that individual owner reimbuse for their specific use&lt;/li&gt;
  &lt;li&gt;Estimate average energy use of an EV on a monthly basis and make this a flat, fixed rate fee for the EV circuits&lt;/li&gt;
  &lt;li&gt;Make charging free&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In retrospect, &lt;strong&gt;a single sub-meter split evenly&lt;/strong&gt; feels like a better approach, since it would have saved
each charger close to $1,000 by not having to have a sub-meter purchased and installed. However, it then
means that users are not directly paying for their energy use.&lt;/p&gt;

&lt;h3 id=&quot;owners-do-not-believe-their-install-cost-will-be-so-expensive&quot;&gt;Owners do not believe their install cost will be so expensive&lt;/h3&gt;

&lt;p&gt;Several owners paid the reservation fee but did not believe the estimate of “maybe $5,000 or more”
for the cost of installing their circuit. Even after multiple quotes from electricians, at least 1
of the owners who purchased a reservation has realized it’s beyond their comfort level to pay
on top of the cost of a vehicle, etc.&lt;/p&gt;

&lt;p&gt;As a result, these owners are now looking to transfer/resell their reservation, or figure out
what to do. We should have required that owners submit a quote along with their reservation to
indicate they do understand their specific costs.&lt;/p&gt;

&lt;h3 id=&quot;disconnect-switches-not-needed&quot;&gt;Disconnect switches not needed&lt;/h3&gt;

&lt;p&gt;For specific amperages on the higher end, the NEC requires a heavy duty disconnect
switch to be installed. This is not required for 32-amp or even 40-amp installations (I think
it is only at 50 amp+ that it is needed).&lt;/p&gt;

&lt;p&gt;When I had my install done, I requested the disconnect switch as part of my quote, which
cost probably another $400 or so in parts and time. This came from my previous research
into the higher amperage chargers when I had considered having a 50-amp charger put in prior
to our decision to reduce target amperage to get more participants in the project.&lt;/p&gt;

&lt;p&gt;Our other installs have not gone with a disconnect switch to save cost.&lt;/p&gt;

&lt;p&gt;A disconnect switch can allow the owner to lock the switch in the open position (not energized), to disallow access to the charging station by others. Since our panel is located in the locked electric room, this is
a decent approach.&lt;/p&gt;

&lt;h3 id=&quot;continuous-load-impact-on-charger-count&quot;&gt;Continuous load impact on charger count&lt;/h3&gt;

&lt;p&gt;Our earliest EV committees had estimated incorrectly the load for a given
set of chargers, either by not properly estimating the continuous load
and buffer (people assuming a 20-amp charger only requires 20-amps of
capacity in the fededers, when really it requires a 25-amp breaker),
or not estimating the per-phase load.&lt;/p&gt;

&lt;p&gt;Make sure to have your electrician clearly indicate available capacity
for chargers, since you do not want to expect to be able to install
more chargers than you can if you are taking reservation payments!&lt;/p&gt;

&lt;h3 id=&quot;6th-service-disconnect&quot;&gt;6th Service Disconnect&lt;/h3&gt;

&lt;p&gt;Our “house” service in the switchgear had 5 service disconnect breakers
attached to it before our project, and so our new breaker for the new
transformer became the 6th service disconnect.&lt;/p&gt;

&lt;p&gt;The code limits such a setup to 6 service disconnects, so when our
next phases kick off, the electricians will have a slightly increased
project scope to reconfigure the breakers to support additional transformers
or panels without adding a new service-level disconnect.&lt;/p&gt;

&lt;p&gt;This was learned during the project and we did not understand before. It
will probably add $2,000-$5,000 to the next phase, if that happens.&lt;/p&gt;

&lt;h1 id=&quot;program-preparations-2016-2018&quot;&gt;Program preparations (2016-2018)&lt;/h1&gt;

&lt;p&gt;For several years the topic of EV charging would come up at each annual
meeting and throughout monthly meetings every once and a while. There
was a significant amount of planning that went into running through
options and scenarios.&lt;/p&gt;

&lt;h2 id=&quot;peak-demand-meter&quot;&gt;Peak demand meter&lt;/h2&gt;

&lt;p&gt;In late 2017 our building’s “house meter” was updated to be a peak demand
meter to allow the city to charge us not only for energy consumed, but also
peak energy consumption.&lt;/p&gt;

&lt;p&gt;A nice side effect of this was that we were able to greenlight our 2019
project without requiring a demand study, since the peak demand data from
the meter gave us over 1 entire year of peak data. It indicated that our
house panel was using at peak only 11% of its available electrical capacity,
providing plenty of overhead for our project that an inspector could
agree with.&lt;/p&gt;

&lt;h2 id=&quot;microfilm-building-records&quot;&gt;Microfilm building records&lt;/h2&gt;

&lt;p&gt;Many of our original electric drawings (the “as-builts”) for the condo
have gone missing over the years as many contractors have borrowed pages
for different purposes.&lt;/p&gt;

&lt;p&gt;The City of Seattle maintains archival copies of all these as-builts in
the municipal tower, but for buildings built before a more recent time,
all the records are on microfilm.&lt;/p&gt;

&lt;p&gt;We were able to locate the necessary electrical plans to make copies
and scan for future use. This helped provide a good foundation for
our electricians to review and have handy throughout our EV journey,
although the clarity and quality of some of the figures in the
plans is very hard to read in the film prints.&lt;/p&gt;

&lt;h2 id=&quot;annual-community-interest&quot;&gt;Annual community interest&lt;/h2&gt;

&lt;p&gt;At both the 2017 and 2018 annual meetings held in early January
owners asked why progress was not being made on investigating a plan
or policy for EV charging. It was clear that a few people would
need to go get involved in learning about the real options.&lt;/p&gt;

&lt;h2 id=&quot;air-conditioning-policy&quot;&gt;Air Conditioning policy&lt;/h2&gt;

&lt;p&gt;When our building was constructed, only the top 2 floors of the tower
offered HVAC air conditioning. All other units did not have air
conditioning.&lt;/p&gt;

&lt;p&gt;A/C was not common in a majority of Seattle homes until more recently,
so this building being built in 2002 did not see A/C as a major feature.&lt;/p&gt;

&lt;p&gt;Since then, the condo market has evolved, and more people expect to
have A/C charging for the month or so of warmth each summer, so owners
had asked a lot about how to go about installing charging capabilities.&lt;/p&gt;

&lt;p&gt;Similar to the EV project, every year or two, people would ask about A/C,
and conversations started as early at 2005. A decade later, by 2016, there
was finally a policy that would allow a specific set of requirements to be
met in order to mount A/C split units on Limited Common balconies.&lt;/p&gt;

&lt;p&gt;This policy and managing the fear and uncertainty during the process helped
forge a good foundation for a similar approach for our EV project.&lt;/p&gt;

&lt;p&gt;Additionally, the A/C project clearly defined that there was a path to
owners paying, at their own cost, for a professional to make an
improvement that only benefits some owners. Installs easily cost as
much as $15,000 and demonstrated that if you provide a path and framework
for people, with a policy, they will appreciate it.&lt;/p&gt;

&lt;h2 id=&quot;garage-wifi&quot;&gt;Garage WiFi&lt;/h2&gt;

&lt;p&gt;As part of a building-wide security camera project, we moved from a traditional
analog security system to a power-over-Ethernet network approach which brought
online a number of new cameras, including the complete exterior of the building,
plus a rooftop terrace, and cameras throughout the garage.&lt;/p&gt;

&lt;p&gt;Since the underground garage does not receive traditional cell signals, it was
also affordable at the time to install WiFi access points in the garage to allow
the building staff to receive communications while on security walks, etc.&lt;/p&gt;

&lt;p&gt;A nice side effect is that residents now also have access to that WiFi network
in the garage and throughout the common areas, which means that cars that have
WiFi can also receive updates.&lt;/p&gt;

&lt;h1 id=&quot;community-charging-amenity-2015&quot;&gt;Community charging amenity (2015)&lt;/h1&gt;

&lt;p&gt;In 2015, as was becoming an annual habit, EV charging would become a topic at the annual
association meeting in January, followed by exploratory follow-up meetings.&lt;/p&gt;

&lt;p&gt;The 2015 EV committee focused on looking at a way to affordably bring both a community EV charger
to the community as a pilot to see how popular it gets, and to provide a path for owners to
install their own chargers, at their own cost.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/ev1space.jpg&quot; class=&quot;img-responsive&quot; title=&quot;The community charger Clipper Creek unit&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While talking to owners interested in charging, the economics of installing a
charging solution became a conversation: a few owners felt that the premise of an
Electric Vehicle was both about the environment but also cost savings compared to gasoline.
In their mind, any investment in the capital cost of infrastructure would diminish
the theoretical return on the investment in an EV. That was a bummer, because
it meant there were more EV and PHEVs in the garage than those interested in a
better charging solution.&lt;/p&gt;

&lt;p&gt;One key issue was that we had no known load info or load studies for any of our
electric service connections into the building, and installing equipment for
a load study could require a temporary power outage to install the load equipment,
and this would be extremely impactful to homes. Any initial approach would need
to go off of the known panel loads for existing garage circuits which had
limited electric capacity and limited physical breaker space in the panels.&lt;/p&gt;

&lt;p&gt;Eventually two proposals were prepared and presented:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Reallocate 2 unused motorcycle parking spaces to become parking space “EV1”, a paid
amenity: electric car charging by the hour. The best quote from an electrician would
use an existing penetration into the area which is directly above the main electric room,
then place a 240V breaker in the existing garage panel, and install an EVSE, for $3,000.&lt;/li&gt;
  &lt;li&gt;On top of proposal 1, allow owners, at their own cost, to have a branch circuit installed
in the existing garage panel, first-come, first-served. There may only be available
electric capacity for 1-2 chargers, at which point a more involved project would be needed.
No association cost but also not a scalable plan to anticipate growth.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;There was thoughtful discussion over the coming months after the proposals were
made.&lt;/p&gt;

&lt;p&gt;While the board had the authority to approve an owner to have an electrician install a one-off
charger and circuit in the building, it would not provide a scalable solution to future
owners or interest. There was a lot of concern about “what if this is the last charger the
building could install.”&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Shared charger approved&lt;/strong&gt;: Approval to install, using association funds as a new amenity, a
shared EVSE for up to $3,000. The bid included providing a sub-meter to monitor energy use, if needed.
As a new paid amenity, over time, the project would provide value to some owners
and would cover the cost of the installation and EVSE. We installed a Clipper Creek brand EVSE.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Private charger approach not approved&lt;/strong&gt;: Without a plan to allow more people than just 1-2 install
chargers, it was seen as not building a fair enough framework to be scalable.&lt;/p&gt;

&lt;p&gt;The installation went swiftly, though we did not realize that the original bid only covered
the installation of a NEMA 15-40 outlet, not an EVSE as well. We ended up having to approve
an additional expense to purchase a NEMA 15-40 ClipperCreek unit.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/communitycharger.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;p&gt;The cheap approach (by not buying a networked/integrated billing and metering solution) was
that the electric outlet is locked, and so an owner has to check out the key to plug the EVSE in
to the outlet before use, then return the key after using and disconnecting the EVSE.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Lesson learned:
&lt;strong&gt;Locking an outlet is a huge pain&lt;/strong&gt; and adds significant friction to using an EVSE. Our
owners with EVs would have to park in the space, take the elevator up to the concierge desk,
check out the key, then return to plug in the EVSE to the unlocked outlet, plug in their
car, and then return the key.&lt;/p&gt;

  &lt;p&gt;As of late 2019 we are still considering options to improve this experience, such as
moving to an honor-based system, but the opinion of the community is that charging cars
should be paid for and recouped.&lt;/p&gt;

  &lt;p&gt;In hindsight, we probably should have considered a networked ChargePoint-style system
that would allow owners to have their own ChargePoint card, then we would set a rate,
and billing would be easy and automatic, with no need to work with our concierge staff.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;deciding-to-wait-2010-2014&quot;&gt;Deciding to wait (2010-2014)&lt;/h1&gt;

&lt;p&gt;For many years, the decision of the association was to decide to wait for
future demand and to table any proposals or rules in the EV space.&lt;/p&gt;

&lt;h2 id=&quot;2014-learning-and-planning&quot;&gt;2014: Learning and planning&lt;/h2&gt;

&lt;p&gt;In 2014 our building had 2 EV/PHEV cars in it - a Chevy Volt and a Tesla Model S.
Both of these vehicles were becoming more popular throughout the Pacific
Northwest, and new owners were becoming interested in the convenience of
being able to charge at home.&lt;/p&gt;

&lt;p&gt;An EV committee was formed and began researching options, looking at what
other buildings had done to implement an approach, and try and form a basis
for an association opinion.&lt;/p&gt;

&lt;p&gt;A survey of owners in the building learned that in the next several years
there would be interest in charging.&lt;/p&gt;

&lt;p&gt;The owner who headed the committee did an amazingly solid job pulling
together resources, trying to identify incentives that might reduce the HOA’s
burden, find a cost-effective, scalable solution for charging in the building, and
soliciting information from other buildings and groups that have undergone
similar projects.&lt;/p&gt;

&lt;p&gt;The committee was not always able to get the best information from
electrical firms in the area, whether they had experience in EV-related work
or not: many would offer quotes contingent on available load, but were
not very forthcoming about how to obtain load information, or what that
might cost. Many electricians are much too busy to accept small projects.&lt;/p&gt;

&lt;p&gt;Two proposals were considered:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;For $17,000, the installation of an integrated EVSE charging system that
would be a single-port commercial charging unit with integrated billing
and metering.&lt;/li&gt;
  &lt;li&gt;For $12,000, installing a new 3-pole breaker in the existing switchgear to
feed a new 75KVA 480-120/208V 3-phase transformer, panel, core drilling to
another location in the garage concrete, and installing a single 50-amp 208V
dedicated outlet or EVSE.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The new transformer and panel would be an effective solution that would provide
additional capacity for future EV charging to be installed at owners’ individual
cost to their parking spaces.&lt;/p&gt;

&lt;p&gt;In July the recommendation to table the project again was made, recognizing that
there was insufficient demand to justify spending community association funds on
the project. (HOA budgets are run very efficiently and unbudgeted investments such
as these electrical infrastructure changes can be hard to justify, since they
only benefit those interested in the new addition.)&lt;/p&gt;

&lt;p&gt;A future solution would need to minimize the association investment or focus
just on the amenity angle.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/meterstack.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;h2 id=&quot;2010-2013-early-interest&quot;&gt;2010-2013: Early interest&lt;/h2&gt;

&lt;p&gt;In 2010 the association spent a lot of time working out cost savings
and efficiency improvements to offset rising utility rates.&lt;/p&gt;

&lt;p&gt;As a part of that process, a homeowner who was very interested in the
development of Tesla and EV, and considering a Tesla Roadster, asked
about the association’s roadmap to enable EV charging.&lt;/p&gt;

&lt;p&gt;The association entertained some early options with electricians, one
of which identified a plan that would bring in new meter stacks into the
building, transformers and other equipment, for over $47,500. It is
unclear in retrospect what the scope of the plan was.&lt;/p&gt;

&lt;p&gt;The decision was made that it was too soon to think about charging and the
question was tabled.&lt;/p&gt;

&lt;p&gt;In 2012, after a few continued conversations about charging, the
owner who wanted to invest in EV charging decided to sell their unit
in our building and purchase a unit in another downtown condo
building that had an EV charging offering program. They moved,
had a charger installed, and purchased an early Tesla Model S in 2013.&lt;/p&gt;

&lt;p&gt;In 2013, the question of allowing owners to install branch circuits
for trickle chargers for exotic cars came up: with easy access to a
120V outlet, owners of super cars could keep the 12V battery alive
between periods of rest for the car. This was not seen as a compelling
enough reason to invest in building out new infrastructure, but it
was understood that an eventual EV charging program might permit
trickle chargers.&lt;/p&gt;

&lt;h1 id=&quot;overcoming-fear-and-uncertainty&quot;&gt;Overcoming fear and uncertainty&lt;/h1&gt;

&lt;p&gt;Here’s a collection of things some people have asked during the years of
conversation on our condo’s charging program.&lt;/p&gt;

&lt;h2 id=&quot;i-must-have-a-100-amp-circuit&quot;&gt;“I must have a 100-amp circuit”&lt;/h2&gt;

&lt;p&gt;Some people who are interested in owning an EV, or who currently own one, are
looking to maximize their investment, feel that they must have the highest
specifications - so they want to “go big” on a large circuit breaker and charging
station.&lt;/p&gt;

&lt;p&gt;Help inform and educate everyone about this. It’s expensive to provision high
amperage circuits and not that helpful. Be wary of allowing large circuits if you do not have an insane amount of
electrical capacity available.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;With daily commuting or city use, a pure battery electric vehicle will only
use 5%, 10%, 15% of the battery - which can be recharged in a few hours on a
Level 2 charger&lt;/strong&gt;. This means you wake up with a full charge no matter what.&lt;/p&gt;

&lt;p&gt;It is incorrect to look at how long it would theoretically take to recharge from
0-100% a battery electric EV: this rarely happens, since a typical routine should
keep its use between 30% and 90% of battery charge.&lt;/p&gt;

&lt;p&gt;Consider focusing on 20-amp, 32-amp, and 40-amp charging stations as a key
place for your multi-family building. Allowing larger amperages will impact the available space you have in your
project to support additional users.&lt;/p&gt;

&lt;p&gt;Beware the infrastructure impact:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Larger gauge wire will be required for higher amperages&lt;/li&gt;
  &lt;li&gt;At 50-amps and above, the electric code will likely require you to have a heavy duty disconnect switch mounted within reach of the charging station&lt;/li&gt;
  &lt;li&gt;More amperage means less charging circuits on a panel or transformer&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We found the traditional car dealerships are especially uninformed here: one of
our residents who is looking into the Audi e-tron was told they should install
a Level 3 charger at home to charge in minutes… the reality is, Level 3 DC
charging is extremely expensive, and would not make sense for a private owner
to install. The dealer then warned the person: “with a Level 2 charger, it will
take you a day to charge”, and so the owner in our community had the impression
their car would always have to be charging, not understanding the daily impact.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.clippercreek.com/charging-times-chart/&quot;&gt;Clipper Creek’s Charging Times reference document&lt;/a&gt; is especially
helpful here to educate people.&lt;/p&gt;

&lt;p&gt;For PHEV hybrids, they have much smaller batteries, and so while they may need
to fully charge their battery overnight, on a Level 2 charger, that will also
just take a few hours.&lt;/p&gt;

&lt;h2 id=&quot;this-is-just-a-rich-people-problem&quot;&gt;“This is just a rich people problem”&lt;/h2&gt;

&lt;p&gt;Early on in our community’s days there were the exotic Italian sportscar
owners who wanted to have trickle charging to keep their 12V batteries alive
for cars that were rarely used;&lt;/p&gt;

&lt;p&gt;For many years, there was the perception that EVs were all $140,000 Tesla
models, and so this was not really something for the general community to care
about.&lt;/p&gt;

&lt;p&gt;Even today, in 2019, people still believe a Tesla Model 3 is a very expensive
car - yet our parking garage is already full of over a hundred German sports
cars that all cost more than a typical Model 3.&lt;/p&gt;

&lt;p&gt;Help inform people on the price of common electric cars, including used cars: the
Chevy Bolt, Tesla Model 3, KIA’s Niro and Soul, VW, so many great cars are out
there and affordable.&lt;/p&gt;

&lt;p&gt;Having an EV open house where you introduce people to models, price points, etc.
will help remove the belief here that’s it’s a “rich people” thing. Thankfully
the huge uptake of the Model 3 helps evolve the Tesla image.&lt;/p&gt;

&lt;h2 id=&quot;why-should-our-association-spend-time-on-this&quot;&gt;“Why should our association spend time on this?”&lt;/h2&gt;

&lt;p&gt;Many owners did not feel it was worth the association board’s time to investigate
options here, even when a committee was formed to do the heavy lifting and learning.&lt;/p&gt;

&lt;p&gt;In the end the board has the sole authority in Washington State to approve uses
of Limited Common and Common space in the building, covering assigned parking
spaces, and so the board must act here.&lt;/p&gt;

&lt;p&gt;The benefits are clear to the association:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fewer oil spots in the garage to have cleaned up&lt;/li&gt;
  &lt;li&gt;Attract new owners into the community who are interested in EV capabilities being available or at least considered&lt;/li&gt;
  &lt;li&gt;Retain current owners who feel they would like an EV, and so are going to consider purchasing in a community that supports their requirements&lt;/li&gt;
  &lt;li&gt;Can help even out electric bills and demand charges when charging at night&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Do take care to make sure the community is comfortable with the funding model.
Some condos have funded infrastructure as a community, others, like my association,
did not want private-benefit infrastructure to be funded by the association.&lt;/p&gt;

&lt;h2 id=&quot;were-not-even-going-to-have-cars-in-10-years&quot;&gt;“We’re not even going to have cars in 10 years”&lt;/h2&gt;

&lt;p&gt;One person in the community would say essentially, “with Uber and self-driving cars
coming, we’re not even going to have a need for cars in 10 years.”&lt;/p&gt;

&lt;p&gt;Just silly. This is overly optimistic. If that’s true, a much larger conversation will be what
to do with the hundreds of parking spaces in the garage, no whether it’s fair to
invest time and money into enabling EV charging.&lt;/p&gt;

&lt;h2 id=&quot;why-are-we-only-letting-some-people-benefit&quot;&gt;“Why are we only letting some people benefit”&lt;/h2&gt;

&lt;p&gt;Some owners felt “if we do anything, we must bring charging to every single parking
space in the building” - everyone gets it, or nobody.&lt;/p&gt;

&lt;p&gt;These owners were passionate about the concept that we should not do work that
benefits only some people.&lt;/p&gt;

&lt;p&gt;The reality is that condo communities are full of Limited Common features and
assignments and benefits that are not universal:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Parking spaces are assigned; some spaces are better than others&lt;/li&gt;
  &lt;li&gt;Storage units are different sizes, assigned, some have moved hands or been consolidated&lt;/li&gt;
  &lt;li&gt;A/C HVAC units are only available to some units in the building&lt;/li&gt;
  &lt;li&gt;Some outdoor terraces and balconies are only benefiting some of the owners&lt;/li&gt;
  &lt;li&gt;Bike racks are available for some, but not others&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The community must evolve and offer new things that interest people.&lt;/p&gt;

&lt;p&gt;The board authorized a 4th Internet and telecommunications company access to
the building, since some people wanted additional choice. While no cost to the
community, others have benefitted and enjoyed having that 4th option - it just
makes sense to evolve.&lt;/p&gt;

&lt;h2 id=&quot;electricity-is-not-green&quot;&gt;“Electricity is not green”&lt;/h2&gt;

&lt;p&gt;Some people believe the rhetoric that electricity is dirty and generated by
coal. In some states, this may be true, but in the Pacific Northwest, we are
blessed with a diversity of green electric generation opportunities, and make
extensive use of hydro, for example.&lt;/p&gt;

&lt;p&gt;Regardless, the electric grid is a part of life, and it’s much cleaner to
not have cars that are polluting all day long.&lt;/p&gt;

&lt;h2 id=&quot;conduit-is-ugly&quot;&gt;“Conduit is ugly”&lt;/h2&gt;

&lt;p&gt;Some owners felt that conduit mounted on the garage ceiling is not attractive.&lt;/p&gt;

&lt;p&gt;While true, and newer buildings can embed EV charging circuits in the concrete
slab running to parking spaces, the reality is that the garage is already
full of many building systems running on the ceilings: sprinkler systems,
network cables and camera systems, circuits for emergency power, etc.&lt;/p&gt;

&lt;p&gt;Once our first set of EV charging circuits went in, most owners could not even
identify which circuits were new and which had been on the ceiling for years.&lt;/p&gt;

&lt;h2 id=&quot;what-if-they-damage-the-post-tensioned-concrete&quot;&gt;“What if they damage the post-tensioned concrete?”&lt;/h2&gt;

&lt;p&gt;In our multi-level post-tensioned concrete garage, some have heard horror stories
about what happens if the PT cables are damaged during drilling.&lt;/p&gt;

&lt;p&gt;Using licensed, bonded, insured electricians is key, and professionals familiar
with the building construction and using shallow concrete mounting techniques,
but this is not a reason not to approve EV charging.&lt;/p&gt;

&lt;p&gt;Not all of our owners were aware that it is very common in the building to have
some level of drilling happen into the concrete by professionals.&lt;/p&gt;

&lt;p&gt;For core drilling, x-ray or other imaging solutions are used to safely look into
the slab before a penetration is made.&lt;/p&gt;

&lt;h2 id=&quot;not-all-parking-spaces-are-created-equal&quot;&gt;Not all parking spaces are created equal&lt;/h2&gt;

&lt;p&gt;It is true that not all parking spaces are equal, and has always been the way,
at least in our building.&lt;/p&gt;

&lt;p&gt;Some are closer to the main electric room or EV panel location your project may
have planned.&lt;/p&gt;

&lt;p&gt;Some spaces are close to the entrance/exit, others have slightly larger spots.&lt;/p&gt;

&lt;p&gt;Owners can purchase and transfer spaces between themselves if they feel they
need a different spot.&lt;/p&gt;

&lt;p&gt;This does mean that some people’s cost to install a branch circuit in a hub-and-spoke
model may be higher if they have more levels to penetrate, or other restrictions,
but this is not a reason not to offer an EV product.&lt;/p&gt;

&lt;h1 id=&quot;advice-to-condo-owners-and-boards&quot;&gt;Advice to condo owners and boards&lt;/h1&gt;

&lt;p&gt;I wanted to cover my take on some of the decision points in the hope that
it might be useful to others. Feel free to reach out on Twitter if it would
be useful to further expand on any of these topics.&lt;/p&gt;

&lt;p&gt;At a high level:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;If you’re a tiny building, you may not need to do much other than authorize someone to connect to an existing panel or garage circuit.&lt;/li&gt;
  &lt;li&gt;120V Level 1 chargers likely make sense for many fleet charging systems, but may not meet the expectations of early adopters or pilot participants&lt;/li&gt;
  &lt;li&gt;Load sharing solutions for Level 2 chargers are an absolutely great product, especially if they do not have per-port fees or expensive systems&lt;/li&gt;
  &lt;li&gt;Sub-metering may not always be worth it, but your community’s preferences may vary.&lt;/li&gt;
  &lt;li&gt;Solve for the near term and think about but do not let the long term sway your approach.&lt;/li&gt;
  &lt;li&gt;Charging-as-a-service providers are likely good for some communities, horrible for others: being locked into today’s
technology and a pricing structure for a long period of time will have some pain.&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;A note to board members: you may… have a duty, etc. … always act in the best interest of the association … will need to gather broad support for members not on the board. You can help to encourage and maintain a fair voice. Make your interest clear and only move forward once community …&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;the-luxury-of-of-personal-charging&quot;&gt;The luxury of of personal charging&lt;/h2&gt;

&lt;p&gt;“Private” or personal charging is a luxury best thought of when comparing having in-unit washer/dryer to
coin-operated laundry elsewhere in the building. It will not make sense to many but some will love it.&lt;/p&gt;

&lt;p&gt;Charging is something that will add value to your unit only if a future owner cares about or already has interest in EVs:
it’s unclear if the value will be appreciated by all.&lt;/p&gt;

&lt;h2 id=&quot;understanding-electric-distribution-infrastructure&quot;&gt;Understanding electric distribution infrastructure&lt;/h2&gt;

&lt;p&gt;The typical electric infrastructure in the city will be:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The utility’s distribution network (power lines underground or overhead)&lt;/li&gt;
  &lt;li&gt;The utility’s transformers will step-down electricity from their distribution lines to your building, typically inside your building’s electric vault or a nearby vault underground under a sidewalk or street&lt;/li&gt;
  &lt;li&gt;Your main electric room will have 1 or more electric service connections running from the electric vault to your main building switchgear or switchboard. In our building, we have a 480V 3-phase 4-wire system in place.&lt;/li&gt;
  &lt;li&gt;The switchgear will have service disconnects and other bus equipment in place. Attached to the 480V 3-phase breakers will be either 480V panels or step-down transformers. (Our single-phase common lighting in the garage runs at 277V, while most household and general outlets are running at 120V and require a transformer to be useful).&lt;/li&gt;
  &lt;li&gt;Unless you have an existing 120/208V panel that has significant spare capacity (&lt;em&gt;load&lt;/em&gt; available, not physical space) to install new circuit breakers for branch EV circuits, you will need to install a new step-down transformer for your EV charging system project. Our building chose to install a 75KVA transformer as it was the maximum size transformer that could be installed with an over-the-counter (OTC) permit, making the project less expensive and quicker to execute.&lt;/li&gt;
  &lt;li&gt;A new panel will be installed that connects to the transformer. This is where the branch connections to individual EV charging circuit owners will be made. Each branch circuit will have a 208/240V circuit breaker as required by their EVSE. If a sub-meter system is being used, a sub-meter will also need to be installed adjacent to the panel for the branch circuit.&lt;/li&gt;
  &lt;li&gt;Owners will work with an electrician, and the building manager, to seek approval to have their electrician install, at their own cost, the branch circuit conduit - including any penetrations through concrete, drilling costs, concrete x-rays, mounting the conduit, etc., to their parking spot.&lt;/li&gt;
  &lt;li&gt;The electrician would then install the EVSE in the parking space.
From the utility your building will have one or more electric service connections. The utility’s electric vault is where the utility brings in power from the grid.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;decisions-to-make&quot;&gt;Decisions to make&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Can someone spearhead this project?&lt;/li&gt;
  &lt;li&gt;Do we have existing electric vehicles who can help advocate and inform other owners in the community?&lt;/li&gt;
  &lt;li&gt;Will the utility help subsidize any of this system?&lt;/li&gt;
  &lt;li&gt;Are there government perks or benefits that could offset the cost of infrastructure investments?&lt;/li&gt;
  &lt;li&gt;What have other buildings in the neighborhood or city done?&lt;/li&gt;
  &lt;li&gt;Do our governing documents (declaration, etc.) allow the community to offer new amenities or approve new uses for Common and Limited Common spaces?&lt;/li&gt;
  &lt;li&gt;What is the process for creating a new policy or approving changes to Limited Common parking spaces?&lt;/li&gt;
  &lt;li&gt;Whose electric service will be used for the system?&lt;/li&gt;
  &lt;li&gt;Do we have sufficient available electric load for the project? Is there data available from the utility? Do we need a load study or plan review? What permit requirements will be made? The outcome of this data will be a few different choices including:
    &lt;ul&gt;
      &lt;li&gt;If you have a current panel that has spare load and spare physical space for new circuit breakers&lt;/li&gt;
      &lt;li&gt;If you have capacity for the load, but not physical space, and so need a new sub-panel&lt;/li&gt;
      &lt;li&gt;If you have load available from one of your building services, but would need to install a new main breaker, transformer, and panel&lt;/li&gt;
      &lt;li&gt;If your building does not have sufficient electrical service to support your desired new electric charging loads - and would require the utility to bring in new service to your building&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;What requirements do we have for contractors?&lt;/li&gt;
  &lt;li&gt;How will the association be repaid if its house meter is used?&lt;/li&gt;
  &lt;li&gt;Is there enough interest for a community charger?&lt;/li&gt;
  &lt;li&gt;Is there significant interest for the community as a whole to invest in infrastructure?&lt;/li&gt;
  &lt;li&gt;Is there interest to approve new infrastructure (“hub”) that owners reserve into and allow owners to install at their cost (“spoke”)?&lt;/li&gt;
  &lt;li&gt;Do we design a small incremental program, maximize what we can get on an over-the-counter permit, or go big and hiring an enginering firm to help land a large program?&lt;/li&gt;
  &lt;li&gt;Do we use a charging-as-a-service provider, or install a project that will have monthly port charges, or choose to keep it more simple?&lt;/li&gt;
  &lt;li&gt;Should our program offer Level 1 (120V) and/or Level 2 (208/240V) charging?&lt;/li&gt;
  &lt;li&gt;Should installations use a wall connector EVSE system, outlets, or allow either?&lt;/li&gt;
  &lt;li&gt;Do we allow owners to use load sharing to install charging in multiple parking spaces of theirs, or make charging available to their parking neighbors?&lt;/li&gt;
  &lt;li&gt;Are there specific models or charging systems that need approval?&lt;/li&gt;
  &lt;li&gt;Do we need to suggest a location for chargers to be mounted against walls, or pillars, or posts? Do our owners understand the authority having jurisdiction may require the use of bollards or posts or other protective devices?&lt;/li&gt;
  &lt;li&gt;How much community money are we willing to invest, if any, in charging that benefits individuals?&lt;/li&gt;
  &lt;li&gt;Would we approve using community money in the short term if over the remainder of the specific EV project the community money is completely repaid?&lt;/li&gt;
  &lt;li&gt;Do we allow reservation holders to reassign or sell their investment to other owners?&lt;/li&gt;
  &lt;li&gt;Do we require reservation holders to install a complete project, or can they wait until the future, or partially install the electric conduit system now?&lt;/li&gt;
  &lt;li&gt;What happens when there is demand for additional chargers after the project?&lt;/li&gt;
  &lt;li&gt;Do we want to setup a fund for helping with future plans, design or engineering work as the charging problem gets more challenging?&lt;/li&gt;
  &lt;li&gt;Do we have wireless Internet in the garage, or do we want to make it available?&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;program-outline&quot;&gt;Program outline&lt;/h2&gt;

&lt;p&gt;The program we used was essentially built on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Use the annual member meetings and surveys to measure broad interest&lt;/li&gt;
  &lt;li&gt;Setup a committee to investigate implementation details, learn about the local authority’s requirements for installations, load testing, etc.&lt;/li&gt;
  &lt;li&gt;Host an “EV Open House” or set of community events for interested owners to inform them about EV/PHEVs, charging essentials, etc.&lt;/li&gt;
  &lt;li&gt;Consider installing a community EV charging amenity if your building has available shared/community spaces&lt;/li&gt;
  &lt;li&gt;Work with the rules and architecture committees to develop a policy framework&lt;/li&gt;
  &lt;li&gt;Approve a policy contingent on receiving enough financial commitment to fund an infrastructure investment within a set period of time, first-come, first-served&lt;/li&gt;
  &lt;li&gt;Implement the project and gather feedback&lt;/li&gt;
  &lt;li&gt;Prepare a summary of advice or notes for the next iteration of the program&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;tips---shared-amenity-charging&quot;&gt;Tips - shared amenity charging&lt;/h2&gt;

&lt;p&gt;It’ll be cheaper to install a bank of load-sharing EVSE units, consider it if you have options.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019ev/chargingbay.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A Level 2 Destination Charging installation for Tesla and J1772-enabled vehicles in downtown Seattle&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Consider if you could make charging free, a fixed monthly cost, or install a ChargePoint or similar system
to make it easy to bill without jumping through complicated steps.&lt;/p&gt;

&lt;p&gt;Have sane rules to allow an overnight charge.&lt;/p&gt;

&lt;p&gt;Encourage your EV owners to get to know each other and communicate.&lt;/p&gt;

&lt;h2 id=&quot;evses-vs-outlets&quot;&gt;EVSEs vs Outlets&lt;/h2&gt;

&lt;p&gt;We learned that newer clarifications to the 2017 Seattle Electric Code alterations on top of the NEC require
a ground fault circuit breaker to be installed for anything in a garage, adding cost and confusion.&lt;/p&gt;

&lt;p&gt;Do you want to allow people to install a crisp, clean-looking charging station (EVSE), or do you want to
just ask them to have an outlet in their parking space, having to attach the “mobile connector” whenever
they charge?&lt;/p&gt;

&lt;h2 id=&quot;120v-vs-208240v&quot;&gt;120V vs 208/240V&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Level 1 or Level 2? Strongly recommend Level 2, but not too high an amperage.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;approaches-to-recovering-energy-costs&quot;&gt;Approaches to recovering energy costs&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;City meters?&lt;/li&gt;
  &lt;li&gt;Allow EV circuits onto existing residential service connections through new sub-panels?&lt;/li&gt;
  &lt;li&gt;Sub-meter each individual EV circuit?&lt;/li&gt;
  &lt;li&gt;Sub-meter all the EV circuits collectively and portion out?&lt;/li&gt;
  &lt;li&gt;Install a managed charging system that handles billing?&lt;/li&gt;
  &lt;li&gt;Fixed monthly cost to charge&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Offer free charging&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;NOTE that your utility’s specifics may impact this… may have time and demand-based charging rates&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;NOTE some jurisdictions may not allow you to sub-meter electricity&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As of this writing, in Seattle we do not have time-of-day rates, though our “house” circuit 
does have demand charges based on peak demand.&lt;/p&gt;

&lt;h2 id=&quot;tips---individual-charging&quot;&gt;Tips - individual charging&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Try to think of multiple units at once and do not authorize one-off installations using existing panels to be more efficient in rolling out a program that can scale and help many people&lt;/li&gt;
  &lt;li&gt;Do consider load sharing and managed service providers if there is significant initial demand&lt;/li&gt;
  &lt;li&gt;If setting up a community shared charger, price it to encourage use&lt;/li&gt;
  &lt;li&gt;Think about an efficient and fair chargeback scheme&lt;/li&gt;
  &lt;li&gt;Consider using a first-come, first-served reservation scheme&lt;/li&gt;
  &lt;li&gt;Consider specific circuit size limits&lt;/li&gt;
  &lt;li&gt;Make sure owners are approved by the board and/or building manager and use a licensed, bonded, insured electrician&lt;/li&gt;
  &lt;li&gt;Make sure owners’ electricians obtain a permit from city and that the work is signed off on by the authority having jurisdiction&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;thinking-about-load-sharing-and-fleet-charging-providers&quot;&gt;Thinking about load sharing and fleet charging providers&lt;/h2&gt;

&lt;p&gt;This space will continue to evolve. There are companies offering “charging-as-a-service” products, 
where they cover the capital infrastructure investment in return for the long-term right to collect 
monthly service and maintenance income from your building and owners.&lt;/p&gt;

&lt;p&gt;Many EVSEs can load share among multiple units: the Tesla Wall Connector, for example, can be configured to 
share power between 4 charging units that are each up to 50 feet apart.&lt;/p&gt;

&lt;p&gt;In the next decade it’s easy to imagine these large load sharing and power management platforms will be 
the de-facto approach to handling large fleets of vehicles or large residential garage projects. Maybe
there will be an open source platform for charging that will remove port costs or other overhead.&lt;/p&gt;

&lt;h2 id=&quot;approaches-we-did-not-pursue&quot;&gt;Approaches we did not pursue&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Allowing owners to branch their residential unit’s power and install conduit from that to their parking spaces&lt;/li&gt;
  &lt;li&gt;New utility meters dedicated to individual EV chargers&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;resources-you-can-use&quot;&gt;Resources you can use&lt;/h2&gt;

&lt;p&gt;Here’s a set of resources collected or created for our project. Happy to share.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://az414997.vo.msecnd.net/waz/2019ev/SampleOpenHouseDeck.pptx&quot;&gt;PPTX - EV Open House Deck - 55MB&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://az414997.vo.msecnd.net/waz/2019ev/BoilerplateEVPolicy.docx&quot;&gt;DOCX sample policy - 136KB&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;&quot;&gt;Seattle City Light electric code&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://energysolutions.seattle.gov/electric-vehicles/&quot;&gt;Seattle City Light Electric Vehicles home page&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://energysolutions.seattle.gov/wp-content/uploads/Electric_Vehicle_Service_Equipment_for_Multi.pdf&quot;&gt;Seattle City Light EV multi-family guidance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.tesla.com/where-you-park&quot;&gt;Tesla charging where you park page&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.tesla.com/support/home-charging-installation&quot;&gt;Tesla home charging page&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.tesla.com/support/home-charging-installation#multi-unit-dwelling&quot;&gt;Tesla letter to condo board&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.chargepoint.com/solutions/apartments/&quot;&gt;ChargePoint page on multi-family charging&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.clippercreek.com/charging-times-chart/&quot;&gt;Clipper Creek page on how logn it takes to charge&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;other-seattle-condo-approaches&quot;&gt;Other Seattle condo approaches&lt;/h1&gt;

&lt;p&gt;Here’s a summary of other buildings we researched and learned from as
part of our EV project.&lt;/p&gt;

&lt;p&gt;Given the sensitive nature of real estate transactions around condo amenities
in Seattle, I am not naming building names here.&lt;/p&gt;

&lt;p&gt;I am not aware of any downtown Seattle buildings that have invested in broad fleet-style load sharing
infrastructure systems at this time.&lt;/p&gt;

&lt;h2 id=&quot;fancy-tower-1&quot;&gt;Fancy Tower 1&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;270+ units&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Building built 2009, EV program implemented 2015&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Installed infrastructure including a panel in the middle garage level &lt;strong&gt;paid for by the entire community as part of a typical budget expense item&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;Priced at $250 for a 120V breaker in the panel, one-time, $500 for a 208V breaker in the panel&lt;/li&gt;
  &lt;li&gt;Monthly cost of $20 fixed, flat rate for all circuit users (no sub-meters)&lt;/li&gt;
  &lt;li&gt;No limit to spaces (sufficient panel capacity and building capacity)&lt;/li&gt;
  &lt;li&gt;Spoke installation paid for by individual owners at their cost&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;fancy-tower-2&quot;&gt;Fancy Tower 2&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Building built 1982, EV program implemented 2013&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;70+ units&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Installed infrastructure once enough owners wanted to purchase into the project. Reservations&lt;/li&gt;
  &lt;li&gt;8 spaces were made available for reservation by owners, 6 were purchased&lt;/li&gt;
  &lt;li&gt;Hub-and-spoke: hub infrastructure paid for by reservations, individual owners paid spokes&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;my-condo-building&quot;&gt;My condo building&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Building built 2002, EV program implemented 2019&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;170+ units&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Installed infrastructure including transformer and panel&lt;/li&gt;
  &lt;li&gt;8 spaces were made available for reservation by owners, 8 purchased&lt;/li&gt;
  &lt;li&gt;Hub-and-spoke: hub infrastructure paid for by reservations, individual owners paid spokes&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;other-nearby-tower&quot;&gt;Other nearby tower&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Building built 2008, EV program partially implemented 2019&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;180+ units&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Pilot program allowing a single owner to tap into an existing garage panel at their own cost.&lt;/li&gt;
  &lt;li&gt;Reimbursement method is TBD&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;new-fancy-tower&quot;&gt;New fancy tower&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Building built 2015, EV program implemented 2015&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;600+ units&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Building was constructed with 2 shared community ChargePoint stations for community use&lt;/li&gt;
  &lt;li&gt;Building was constructed with a set of private charging spaces made available to owners who have an EV and reserved the parking spaces&lt;/li&gt;
  &lt;li&gt;Unknown reimbursement program for private spaces&lt;/li&gt;
  &lt;li&gt;Association rules state that an assigned EV charging private space must be given up if the owner no longer has an EV, and a waitlist for other EV owners&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;downtown-fancy-tower&quot;&gt;Downtown fancy Tower&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Building built 2009, EV program implemented 2014 (?)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;200+ units&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;A single owner invested in electric upgrades and now offers to sell portions of the panel to owners at their cost.&lt;/li&gt;
  &lt;li&gt;Unclear on the specifics&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;new-construction-tower-2019&quot;&gt;New construction tower (2019)&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;EV charging parking spaces are being sold similar to a backsplash or appliance upgrade at time of sale. Unknown cost.&lt;/li&gt;
  &lt;li&gt;Expect this to be more common as developers look to monetize the city requirements to install charging capacity, conduit, etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;new-construction-tower-2019-1&quot;&gt;New construction tower (2019)&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;A new community amenity will be a fleet of shared EV cars available for rent to owners, called “Envoy”&lt;/li&gt;
  &lt;li&gt;Shared EV chargers also available.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;looking-forward&quot;&gt;Looking forward&lt;/h1&gt;

&lt;h2 id=&quot;washington-state-needs-right-to-charge-laws&quot;&gt;Washington State needs right-to-charge laws&lt;/h2&gt;

&lt;p&gt;A right-to-charge law would have entirely changed the conversation with my HOA. Instead
of moving from “no” to “yes”, the conversation would have immediately jumped to “how”.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;The State of Washington does not have “right to charge laws”&lt;/strong&gt; like some states do (California, Colorado, Florida and Oregon). In California, &lt;a href=&quot;[Law section](https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?sectionNum=4745.&amp;amp;lawCode=CIV)&quot;&gt;Civil Code 4745, 4745.1&lt;/a&gt; states that “HOAs may not prohibit or unreasonably restrict the installation or use of electric vehicle charging stations in a designated parking space.” As a result, in Washington there is a strong bias for inaction in Washington condo associations with regard to pilot programs and working to extend EV charging, since no charge is easiest to manage, and in general, and HOA board can simply deny any request. &lt;strong&gt;Washington needs a right-to-charge law&lt;/strong&gt; to help accelerate EV adoption by encouraging HOAs to think through how to implement and build a smart program for letting their owners, at their own individual cost, install electric charging equipment in a fair manner, or invest in shared infrastructure.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;While I believe apartment buildings will notice the demand and revenue opportunity as EVs roll
out broadly, I imagine many apartment dwellers feel they have even less control to request an
EV amenity, so right-to-charge could help them, too.&lt;/p&gt;

&lt;h2 id=&quot;new-condos&quot;&gt;New condos&lt;/h2&gt;

&lt;p&gt;In cities like Seattle that are requiring provisioning and planning for electrical charging in all
new parking spaces, developers will look to monetize that requiremenet in new construction by selling
EV-enabled parking spaces as an upgrade when purchasing units. This will put pressure on existing buildings
to offer EV in some form to remain competitive.&lt;/p&gt;

&lt;p&gt;Will be fun to watch.&lt;/p&gt;

&lt;h2 id=&quot;the-next-project-ev2&quot;&gt;The next project: EV2&lt;/h2&gt;

&lt;p&gt;Our 2nd EV project will likely be very similar or identical in scope to our EV1 Limited Common project:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Will reuse the policy implemented in phase 1&lt;/li&gt;
  &lt;li&gt;Will need to get quotes from electricians to identify the next location for a transformer, panel, etc. near the garage&lt;/li&gt;
  &lt;li&gt;Will price reservations to meet the cost requirements for the common portion of the project&lt;/li&gt;
  &lt;li&gt;Reservations offered contingent on enough people reserving to greenlight the project&lt;/li&gt;
  &lt;li&gt;Requiring sub-meters in the same fashion&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-big-project-ev3&quot;&gt;The big project: EV3&lt;/h2&gt;

&lt;p&gt;If and when demand increases so much that a much larger approach is needed, we’ll likely eventually look
to using a fleet or charging-as-a-service provider, or doing a bulk community investment in the system an
electrical engineering firm may offer.&lt;/p&gt;

&lt;p&gt;Time will tell.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Scaling from 2,000 to 25,000 engineers on GitHub at Microsoft</title>
   <link href="http://www.jeff.wilcox.name/2019/06/scaling-25k/"/>
   <updated>2019-06-25T00:00:00+00:00</updated>
   <id>http://www.jeff.wilcox.name/2019/06/scaling-25k</id>
   <content type="html">&lt;p&gt;At Microsoft today we have almost 25,000 engineers participating in our official
GitHub organizations for open source, a great number of them contributing to open source
communities throughout GitHub. It’s been quite a ride: that’s 10X the engineers
we were working with when I posted in 2015 about our experience
&lt;a href=&quot;https://jeffwilcox.blog/2015/11/azure-on-github/&quot;&gt;scaling from 20 to 2,000 engineers&lt;/a&gt;
in the &lt;a href=&quot;https://github.com/azure&quot;&gt;Azure open source org&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;As a member of Microsoft’s Open Source Programs Office (OSPO) team, it’s been exciting to
be a part of this growth, and I wanted to take some time to write down some of the
investments we have made so that others could get a peek inside.&lt;/p&gt;

&lt;p&gt;Using data gathered through an open source project I’ll mention in this post, I was able to
query our GitHub entity data to create this chart of Microsoft’s public repos created since 2011:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/dataexplorer-msftreposovertime.png&quot; class=&quot;img-responsive&quot; title=&quot;A look at the number of public open source repositories created since 2011 in Microsoft's GitHub organizations. The chart shows clear growth over time, taking off in 2015. Now, in 2019, there are months periods of time where over 500 net new repos are being created.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Some of our employees have always been on GitHub, contributing to projects, sharing
their ideas and insights. Many of our teams are new to social coding and working in the open, and
look to OSPO to help provide documentation and guidance.&lt;/p&gt;

&lt;p&gt;We have engineers who are busy contributing to projects all over GitHub, donating their time and code or
entire projects, many I am sure enjoy working with open source in an official capacity, others after
hours, or just hacking away. Looking at the contributors to &lt;a href=&quot;https://github.com/virtual-kubelet/virtual-kubelet&quot;&gt;virtual-kubelet&lt;/a&gt;, a project that’s part of the Cloud Native Computing Foundation, I see familiar names of
people I’ve worked with.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/microsoft/vscode&quot;&gt;Visual Studio Code&lt;/a&gt; team has been on fire, moving
at a fast pace for years. There’s an entire community of awesome people from around the world
on GitHub every day opening issues, performing code reviews, and contributing code to VSCode.&lt;/p&gt;

&lt;p&gt;These teams are finding new ways to communicate, to build consensus and governance models, and to
invite maintainers into the fold.&lt;/p&gt;

&lt;p&gt;In this post, I will cover:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Core principles the Open Source Programs Office uses to guide the open source and GitHub experience&lt;/li&gt;
  &lt;li&gt;Technical investments we have made to scale GitHub&lt;/li&gt;
  &lt;li&gt;Program investments&lt;/li&gt;
  &lt;li&gt;Key learnings&lt;/li&gt;
  &lt;li&gt;Looking to the future&lt;/li&gt;
  &lt;li&gt;Resources including the open source projects mentioned in this post&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I’m going to be focusing more on the tactical approach we took to enabling GitHub at scale
and not any specific project’s experience - though I hope to track down and share the experiences
that projects like the &lt;a href=&quot;https://github.com/microsoft/terminal&quot;&gt;Terminal&lt;/a&gt;,
&lt;a href=&quot;https://github.com/microsoft/typescript&quot;&gt;TypeScript&lt;/a&gt;,
&lt;a href=&quot;https://accessibilityinsights.io&quot;&gt;Accessibility Insights&lt;/a&gt;, and the
&lt;a href=&quot;https://github.com/microsoft/calculator&quot;&gt;Windows Calculator&lt;/a&gt; have had.&lt;/p&gt;

&lt;p&gt;We work hard to build the right experiences so that engineers have everything they need,
without the OSPO team getting in their way.&lt;/p&gt;

&lt;p&gt;It should be no surprise that open source is a big part of what has helped us to
scale, and we continue to give back and contribute where we can:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;we’ve adopted CLA Assistant, an open source project started by SAP, and now contribute to the project (we threw away our home-built, aging Contributor License Agreement (CLAs) bot!)&lt;/li&gt;
  &lt;li&gt;we’re using an open source attribution engine built by Amazon&lt;/li&gt;
  &lt;li&gt;our self-service GitHub management tooling is open source&lt;/li&gt;
  &lt;li&gt;we’re collaborating on &lt;a href=&quot;https://clearlydefined.io/&quot;&gt;Clearly Defined&lt;/a&gt;, an OSI project, to crawl all the open source projects we can find to discover license, copyright, and other data, curating and sharing the resulting data in the open&lt;/li&gt;
  &lt;li&gt;our team has invested in moving to more common open services and systems such as containers and Postgres and MongoDB to make it easier to collaborate with other companies and their preferred tech stacks&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Looking forward, we have a lot more work to do to focus on developing our
capabilities - evolving our maturity models around what healthy and awesome
projects look like, helping graduate work into the community and to
foundations, and continuing rapid iteration, experiments, and learning from
all of this.&lt;/p&gt;

&lt;p&gt;I’m so excited to see where we are at in another few years, and encouraged by
the collaboration happening on open source projects across the industry, the
developing communities around specific Microsoft technologies, and all the
random contributions that Microsoft engineers are making to open source all over
GitHub as their teams take dependencies on and get involved in the associated
communities.&lt;/p&gt;

&lt;h1 id=&quot;principles-weve-adopted&quot;&gt;Principles we’ve adopted&lt;/h1&gt;

&lt;p&gt;To encourage the right behaviors and teach Microsoft employees how to use
GitHub and participate in communities, we’ve identified a number of tenants or
principles that we try and use in everything that OSPO does specific to our
tooling and approach.&lt;/p&gt;

&lt;p&gt;For example, we encourage teams to work in the open on GitHub, getting to learn
the tools and lingo.&lt;/p&gt;

&lt;h2 id=&quot;eliminate--simplify&quot;&gt;Eliminate + Simplify&lt;/h2&gt;

&lt;p&gt;We’d rather remove a complex process to reduce the work our engineers need to do if
it is not providing the right return or value.&lt;/p&gt;

&lt;p&gt;If we need to ask teams questions about the project they want to release as open
source, we focus on what problem we’re trying to solve, and we have been able to
eliminate questions that we used to ask, after thinking through the outcomes with
stakeholders and advisors.&lt;/p&gt;

&lt;p&gt;Looking back five years, we used to have a number of manual registration systems
where engineers would let us know what open source they use. These were often free-form
text fields, and many teams would only take a best-faith effort to share that data.&lt;/p&gt;

&lt;p&gt;Today we’ve been able to eliminate many of the registration scenarios by detecting
the use of open source in many scenarios across the company, just asking follow-up
questions or going through reviews for certain projects when necessary or needing
more information.&lt;/p&gt;

&lt;p&gt;Eliminating process is not always possible, but if we continually ask questions about
the workflows and guidance, and ask the teams using these systems to provide
feedback and suggestions, hopefully we’ll test the edges and eliminate where possible.&lt;/p&gt;

&lt;h2 id=&quot;self-service&quot;&gt;Self-service&lt;/h2&gt;

&lt;p&gt;At scale, we cannot be a roadblock, and we trust and encourage our engineers to learn
through experience. We want to make sure users learn about GitHub teams, and how to
request to join them.&lt;/p&gt;

&lt;p&gt;There is no possible way that we would have been able to get 25,000 people
collaborating on GitHub so quickly without building a self-service experience whereby
our engineers could join our GitHub orgs at their pace as they have a need to learn
and participate.&lt;/p&gt;

&lt;p&gt;Traditionally, a GitHub invitation needs to be sent by an org owner to a specific
username or e-mail address, and that just would not work well at our scale, without
being in the way of our engineers. Thanks to the GitHub API and our GitHub management
portal, things are smooth.&lt;/p&gt;

&lt;p&gt;Whenever possible, we want to provide documents, guidance, and other reusable resources,
instead of having to rely on special knowledge or process that has manual steps.&lt;/p&gt;

&lt;h2 id=&quot;delegation&quot;&gt;Delegation&lt;/h2&gt;

&lt;p&gt;Our office provides guidance and resources to help advise Microsoft businesses
in their approach to contributing to, using, and releasing open source, but we
leave the business decisions with the particular business.&lt;/p&gt;

&lt;p&gt;Decisions such as whether to release open source go through a question/answer
experience, and the outcome is either automatic approval, or a business approval
workflow that kicks off, allowing a team’s business and legal
representatives make the final decisions and choices.&lt;/p&gt;

&lt;p&gt;We also have begun deputizing “open source champs”: people who can help spread
the good word and provide opinions and advice to their teams about how to think
about open source.&lt;/p&gt;

&lt;h2 id=&quot;transparency&quot;&gt;Transparency&lt;/h2&gt;

&lt;p&gt;Open source centers around collaboration, but one of the challenges today with
GitHub orgs full of many repos is identifying what teams have access to accept
pull requests or administer settings.&lt;/p&gt;

&lt;p&gt;While GitHub shows a lot of this data if you start with the Teams view in an org
and drill into a specific team, there’s no view for a given repo’s teams, unless
you’re an admin for that repo.&lt;/p&gt;

&lt;p&gt;For all of our repos, releases and reviews,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Our portal exposes the given teams that control each repo&lt;/li&gt;
  &lt;li&gt;All the release requests and data are stored in work items available to any employee&lt;/li&gt;
  &lt;li&gt;Our portal for GitHub management shows all GitHub Teams, including ‘secret’ or hidden teams&lt;/li&gt;
  &lt;li&gt;We enable cross-org search in our portal, to more easily locate similarly named teams and repos across orgs, reducing confusion and internal support costs&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Thanks to this, out of the 1000s of repos, it’s relatively painless to
find the right contacts for a project inside the company.&lt;/p&gt;

&lt;h2 id=&quot;authentic-github&quot;&gt;Authentic GitHub&lt;/h2&gt;

&lt;p&gt;Engineers should learn how the GitHub interface works, how pull requests and
reviews, issues, forks, organization teams, and collaborators function.&lt;/p&gt;

&lt;p&gt;Whenever possible, we hope that our users go directly to GitHub to manage their
teams, configure team maintainers, welcome new community members into their
projects as maintainers or contributors.&lt;/p&gt;

&lt;p&gt;While we do have separate internal interfaces and tools, these ideally augment the
native experience. We’ve built a browser extension that our users can install
to help light up GitHub to make it easier to find employees, resources, or internal
tools.&lt;/p&gt;

&lt;p&gt;It’s important to us that engineers learn the GitHub fork and pull request model
for contributing, as we strive to use a similar experience for “inner source”
work.&lt;/p&gt;

&lt;h1 id=&quot;technical-investments&quot;&gt;Technical investments&lt;/h1&gt;

&lt;p&gt;Our engineering team has made many technical investments to help scale
the company to be able to participate in open source better.&lt;/p&gt;

&lt;p&gt;Whenever possible we want to use open source to make open source better and
share those learnings and contributions for other companies and individuals to use.&lt;/p&gt;

&lt;p&gt;We’ll invest in our own tooling when we must, but look to the marketplace and
work that others are doing on the horizon: we are excited to see GitHub’s
Enterprise Cloud product evolve and drive new features and capabilities into
the product to make enterprise-scale open source easier.&lt;/p&gt;

&lt;h2 id=&quot;adopting-cla-assistant&quot;&gt;Adopting CLA Assistant&lt;/h2&gt;

&lt;p&gt;Today we host an instance of an open source project for Contributor License Agreement (CLA)
management, integrated with GitHub, called
&lt;a href=&quot;https://github.com/cla-assistant/cla-assistant&quot;&gt;CLA Assistant&lt;/a&gt;. This allows us to make sure that
people contributing to our projects have signed the appropriate CLA before we
accept a contribution.&lt;/p&gt;

&lt;p&gt;Once the CLA for an entity is signed once by a community member, they can then
contribute to all other repos, so it’s really a relatively low burden that helps
keep our lawyer friends happy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/cla.png&quot; class=&quot;img-responsive&quot; title=&quot;CLA Assistant uses a pull request status check to indicate whether the pull request is by a person who has already signed the CLA or not. If they need to sign the CLA for the first time, it comments on the pull request to help the contributor through the process.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CLA Assistant is an open source project that was started by SAP and is &lt;a href=&quot;https://github.com/cla-assistant/cla-assistant/blob/master/LICENSE&quot;&gt;licensed as Apache 2.0&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We’ve contributed to the project functionality to help with scale issues and rate limiting,
automatic signing to handle when employees join and leave the company, and are
excited to be able to support a new class of corporate CLAs thanks to contributions made
by others to that project.&lt;/p&gt;

&lt;p&gt;In 2017 we migrated to this new open solution from the in-house CLA bot that we abandoned.
I really like how the
&lt;a href=&quot;https://github.com/Microsoft/vscode/issues/34239&quot;&gt;VSCode team messaged this to their community with a GitHub issue&lt;/a&gt; (#34239).&lt;/p&gt;

&lt;p&gt;The system is powered by GitHub org-level webhooks, so it is “always on” and teams do not
need to worry about whether their repos are protected with the CLA and ready for contribution.&lt;/p&gt;

&lt;h2 id=&quot;data-and-insights&quot;&gt;Data and Insights&lt;/h2&gt;

&lt;p&gt;GitHub provides useful information including traffic stats, contributor info and
other breakdowns at the repository level.&lt;/p&gt;

&lt;p&gt;Across Microsoft’s open source projects, however, we have a need to be able to slice
and dice data looking for trends over time, analyzing investments at scale, and so realized
early on that we needed to import all of the available data we can from our GitHub
open source releases into our own big data systems such as Azure Data Lake and Azure Data Explorer.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.blog/2019-05-23-build-like-an-open-source-community-with-github-enterprise/&quot;&gt;Newer GitHub Enterprise Cloud features&lt;/a&gt; look
to help provide organization insights, and we’re super excited to give those a
try to augment the other data and insight methods we are using today.&lt;/p&gt;

&lt;p&gt;Here are some of the projects we’ve used, created, or collaborated on.&lt;/p&gt;

&lt;h3 id=&quot;ghtorrent&quot;&gt;GHTorrent&lt;/h3&gt;

&lt;p&gt;Our team is one of the sponsors of the &lt;a href=&quot;http://ghtorrent.org/&quot;&gt;GHTorrent Project&lt;/a&gt;,
an effort to create a scalable, queryable, offline mirror of data offered through
the GitHub REST API. The repo is at &lt;a href=&quot;https://github.com/gousiosg/github-mirror&quot;&gt;github.com/gousiosg/github-mirror&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This data, similar to GHArchive, helps learn about the broad collaboration
happening on GitHub.&lt;/p&gt;

&lt;p&gt;We donate cloud compute resources to the project run by &lt;a href=&quot;http://gousios.org/&quot;&gt;Georgios Gousios&lt;/a&gt;
who kicked off the project with ideas and collaboration with &lt;a href=&quot;http://spinellis.gr/&quot;&gt;Diomidis Spinellis&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;At Microsoft, we ingest the data into Azure Data Lake to be able to run
interesting queries and learn more about trends and happenings beyond our
campus.&lt;/p&gt;

&lt;h3 id=&quot;ghcrawler&quot;&gt;GHCrawler&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/microsoft/ghcrawler&quot;&gt;GHCrawler&lt;/a&gt; is a robust GitHub API
crawler that walks a queue of GitHub entities transitively, retrieving and storing
their contents. The initial project launched in 2016 and evolved significantly
at the &lt;a href=&quot;https://todogroup.org/blog/todo-tools-hackathon/&quot;&gt;TODO Group tools hackathon in June 2017&lt;/a&gt;
while working with other companies to abstract the data stores to support
other technologies and stacks.&lt;/p&gt;

&lt;p&gt;The crawler taught us &lt;em&gt;a lot&lt;/em&gt; about the GitHub API and how to be friendly
citizens by focusing on the caching of entities, the use of e-tags, and being
careful to not repeatedly fetch the same resource.&lt;/p&gt;

&lt;p&gt;Different from GHTorrent, the crawler is able to traverse Microsoft’s own open
source organizations using tokens that can peer into our current GitHub team
memberships, retrieve info about maintainers, configuration, and private repos,
and so is very useful in answering operational questions about the growth of
GitHub at Microsoft.&lt;/p&gt;

&lt;p&gt;We ingest the data from GHCrawler into both Azure Data Lake
&lt;a href=&quot;https://azure.microsoft.com/en-us/pricing/details/data-explorer/&quot;&gt;Azure Data Explorer&lt;/a&gt;
and use that data in Power BI dashboards and reports, live data display on
internal sites, and other resources.&lt;/p&gt;

&lt;p&gt;The chart of new repos at the top of this post was created by querying this crawler
data as stored in Azure Data Explorer. Here’s a query that returns repos created
in the official Microsoft organization in the last 30 days (that are public):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/data-explorer.png&quot; class=&quot;img-responsive&quot; title=&quot;The Azure Data Explorer query UI, displaying GitHub repos created in the last 30 days that are public.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Since the data comes from GitHub but is stored internally, teams can make use
of the data for their own business needs and interests, without having to worry
about GitHub API rate limiting, the specifics around collecting that data, and
just being able to focus on using the data effectively to solve business
problems.&lt;/p&gt;

&lt;p&gt;A favorite resource for many teams looking to build new communities is the
data around pull requests and issues, and also collected traffic API data. Since
GitHub only provides a 2-week window of consolidated traffic info, storing the
data in our big data tools helps us look at trends more easily.&lt;/p&gt;

&lt;h2 id=&quot;clearlydefined&quot;&gt;ClearlyDefined&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://clearlydefined.io/about&quot;&gt;ClearlyDefined&lt;/a&gt; is an
&lt;a href=&quot;https://opensource.org/&quot;&gt;Open Source Initiative (OSI)&lt;/a&gt; project
that has a mission to help FOSS projects thrive by being “clearly defined”. The
lack of clarity around licenses reduces engagement that ends up meaning fewer
users, fewer contributors, and a smaller community.&lt;/p&gt;

&lt;p&gt;Communities choose a license for their project with the terms that they like.
Defining and knowing the license for an open source project is essential to
a successful community partnership, and so ClearlyDefined helps clarify that
by identifying key data such as license set, attribution parties, code
location, and when the data is missing, curation can help.&lt;/p&gt;

&lt;p&gt;Microsoft contributes to the effort and is making use of the data to help provide license
clarity in the tooling used to help teams understand their use of open source.&lt;/p&gt;

&lt;p&gt;As of June 2019, &lt;a href=&quot;https://clearlydefined.io/stats&quot;&gt;ClearlyDefined has over 6.3 million definitions&lt;/a&gt;. These
definitions are created by running tools such as &lt;a href=&quot;https://github.com/licensee/licensee&quot;&gt;licensee&lt;/a&gt;,
&lt;a href=&quot;https://github.com/nexB/scancode-toolkit&quot;&gt;scancode-toolkit&lt;/a&gt;, and
&lt;a href=&quot;https://github.com/fossology/fossology&quot;&gt;fossology tools&lt;/a&gt; across oodles of open source.&lt;/p&gt;

&lt;h2 id=&quot;repolinter&quot;&gt;repolinter&lt;/h2&gt;

&lt;p&gt;Another TODO Group project OSPO collaborates on is &lt;a href=&quot;https://github.com/todogroup/repolinter&quot;&gt;repolinter&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Given a source repository, you can run repolinter to learn basic information
that can help inform whether a project has all that is necessary to incubate
and build a healthy community, such as&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;license files&lt;/li&gt;
  &lt;li&gt;README files&lt;/li&gt;
  &lt;li&gt;Code of Conduct, governance or contribution information&lt;/li&gt;
  &lt;li&gt;No binaries&lt;/li&gt;
  &lt;li&gt;Licenses detectable by licensee&lt;/li&gt;
  &lt;li&gt;Source headers have license information&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We hope to be able to share this data in a more visible way to help teams see
where they can make simple improvements, or even by automatically opening pull
requests if they are missing the essentials such as a mention of the Code of Conduct.&lt;/p&gt;

&lt;h2 id=&quot;oss-attribution-builder&quot;&gt;oss-attribution-builder&lt;/h2&gt;

&lt;p&gt;We’ve collaborated with Amazon and use their
&lt;a href=&quot;https://github.com/amzn/oss-attribution-builder&quot;&gt;amzn/oss-attribution-builder&lt;/a&gt; project to
help build open source license notice files to help teams meet their legal
obligations.&lt;/p&gt;

&lt;h2 id=&quot;github-management-portal&quot;&gt;GitHub management portal&lt;/h2&gt;

&lt;p&gt;Microsoft’s GitHub management portal that employees to use,
&lt;a href=&quot;https://jeffwilcox.blog/2015/11/azure-on-github/&quot;&gt;detailed in my 2015 post on the portal&lt;/a&gt;,
handles:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;self-service org joining for employees&lt;/li&gt;
  &lt;li&gt;cross-organization search of people, repos, and teams&lt;/li&gt;
  &lt;li&gt;support jobs to maintain data&lt;/li&gt;
  &lt;li&gt;generating digests and reports&lt;/li&gt;
  &lt;li&gt;caching GitHub REST API responses&lt;/li&gt;
  &lt;li&gt;processing web hook events&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here you can see an experience where you can search, sort and filter repos across
all of the many GitHub orgs in one place, improving discoverability.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/cross-org-repos.png&quot; class=&quot;img-responsive&quot; title=&quot;A look at searching cross-organization, at repos across all of the various Microsoft GitHub orgs&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The portal itself is open source and has been rebuilt and refactored over the
past few years to try and be more useful and to allow other companies to use it:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Node service and site, now implemented in TypeScript&lt;/li&gt;
  &lt;li&gt;Backing stores supported include Postgres and others backed by interfaces&lt;/li&gt;
  &lt;li&gt;An out-of-the-box “run local in memory” experience is now available&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The repo is on GitHub at &lt;a href=&quot;https://github.com/microsoft/opensource-portal&quot;&gt;microsoft/opensource-portal&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;new-repo-wizard&quot;&gt;New repo wizard&lt;/h2&gt;

&lt;p&gt;While we have a very liberal and friendly policy to make it easy for an
engineering team to decide to share some code such as a sample, we do want to
make sure that there’s a process in place that includes a business decision and
legal team approval if there’s a major release being considered.&lt;/p&gt;

&lt;p&gt;Microsoft has chosen to turn off the “Allow Members to Create Repositories” option
on our open source GitHub organizations.&lt;/p&gt;

&lt;p&gt;Instead, we have our own “new repository wizard” within our GitHub management
tooling. This site collects information about the purpose of the repo, the
common GitHub Team permissions that will help a group of engineers get off and
running, and then populates the repo with the standard Microsoft open source
content such as Code of Conduct info in the README, an appropriate LICENSE file
for the project, and the original purpose and use of the repo, for data reporting
purposes internally.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/repo-wizard.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To make this experience easier to find, we work to educate people through
documentation and tools such as the previously mentioned Open Source Assistant
web browser extension. The extension is able to light up the green “new repo” button
on our orgs and link directly to the wizard, providing a better user experience
than the “you have insufficient permission to create a new repository” message
that our users would receive on GitHub otherwise.&lt;/p&gt;

&lt;p&gt;The outcome of the repo wizard will be the creation of a public or private
repo on GitHub.&lt;/p&gt;

&lt;p&gt;We ask, by policy, that teams only use our open source GitHub orgs for work
they are going to ship within the next 30 days.&lt;/p&gt;

&lt;h2 id=&quot;release-reviews&quot;&gt;Release reviews&lt;/h2&gt;

&lt;p&gt;The outcome of the &lt;em&gt;new repo wizard&lt;/em&gt; is either auto-approval to make a project
public, or the kick-off of a business and legal review process, to help comply
with policy, and inform leaders about important open source decisions that are
being made.&lt;/p&gt;

&lt;p&gt;We have an internal service called the Usage Service that creates a work item
in our work item tracking system (Azure Boards), and assigns that work
item to the appropriate legal and business reviewer. The work item is then
passed along, with fields or more info being filled out, discussions are had, and
eventually the review will be “final approved” and ready for teams to ship their
project to the world and go build that open community.&lt;/p&gt;

&lt;p&gt;Here is a screenshot, redacted of the details and names, showing the work
item for the release approval of the Windows Calculator:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/oss-release-approval.png&quot; class=&quot;img-responsive&quot; title=&quot;A sample work item that is the release review for the Windows Calculator&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After the final approval, an automated e-mail is sent to the original requester
with any guidance from the various reviewers involved in the process, to help
them understand any notifications, legal obligations, or other work that needs
to be done to support their release.&lt;/p&gt;

&lt;h2 id=&quot;open-source-assistant-browser-extension&quot;&gt;Open Source Assistant Browser Extension&lt;/h2&gt;

&lt;p&gt;Internally we ship a browser extension that lights up GitHub with Microsoft-specific
information and guidance.&lt;/p&gt;

&lt;p&gt;Since a GitHub username may not be related to a person’s recognized corporate
identity, the extension lights up the more common corporate alias inline throughout
GitHub - pull requests, issues, people profiles.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/extension-highlights.png&quot; class=&quot;img-responsive&quot; title=&quot;A screenshot showing a web browser where the extension has augmented the GitHub user interface. In the view, a full time employee, Immo, has their employee name, an indicator that they are a full-time employee, placed next to their GitHub username.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By highlighting other Microsoft employees on GitHub, people who use the extension
are able to dedicate additional focus on a good collaboration experience with
the community, while easily being able to better identify their coworkers on
the site.&lt;/p&gt;

&lt;p&gt;The extension helps people to continue to use the native GitHub experience,
while augmenting bits and pieces where we’ve made decisions around our GitHub
org settings, such as disabling New Repo creation direct on GitHub.&lt;/p&gt;

&lt;p&gt;The extension also is also to provide links to policy around open source,
link to the ‘new repository’ wizard.&lt;/p&gt;

&lt;p&gt;Since we disable native repo creation on GitHub
in order to ask engineers to complete our wizard to learn more about their intent
with their open source release, we often would get support questions about how
to create repos, since GitHub would display the message that the user could not
create repos.&lt;/p&gt;

&lt;p&gt;Now, this is what they see:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/new-repo-extension.png&quot; class=&quot;img-responsive&quot; title=&quot;The New Repository page is augented to add information about GitHub at Microsoft, and to point the users at our New Repo Wizard, which is hosted at a different site, and not performed directly on GitHub.com.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In another sceenshot, you can see a “Join” button that lets an employee self-service join
the GitHub organization through our GitHub management portal:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/join-button.png&quot; class=&quot;img-responsive&quot; title=&quot;The Join button, added to GitHub.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, since we want teams to use our official GitHub org that is configured automatically
with the CLA system, with compliance tools, audit logs, and the ability to manage the lifecycle of when
users join and leave, we do not allow teams to create new GitHub orgs for open source.&lt;/p&gt;

&lt;p&gt;By updating GitHub’s “new organization” page, we have a chance to let people know about the policy and other resources before they get too far down the road of trying to setup yet-another-org.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/org-create.png&quot; class=&quot;img-responsive&quot; title=&quot;By augmenting the text we can help prevent GitHub org proliferation, driving teams to use our existing, official open source organization.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The extension works Firefox, Chrome, and the new Edge based on Chromium.
Microsoft employees can learn more and install the extension at &lt;a href=&quot;https://aka.ms/1esassistant&quot;&gt;aka.ms/1esassistant&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;While this extenson is not open source today, if others think it could help
their organization, I can see what we can do.&lt;/p&gt;

&lt;h2 id=&quot;regular-automation-jobs&quot;&gt;Regular automation jobs&lt;/h2&gt;

&lt;p&gt;We’ve implemented jobs that do everything from keeping data and caches up-to-date to
helping make sure that we have confidence in the membership of our GitHub organizations.&lt;/p&gt;

&lt;p&gt;These jobs are all open source, implemented in TypeScript, as a part of the
&lt;a href=&quot;https://github.com/microsoft/opensource-portal&quot;&gt;opensource-portal&lt;/a&gt; repo.&lt;/p&gt;

&lt;h3 id=&quot;removing-former-employees&quot;&gt;Removing former employees&lt;/h3&gt;

&lt;p&gt;Connected to HR data sources, we can react when an employee leaves the company. In a
big company, people are always changing roles, trying new things, and sometimes they
leave for other opportunities.&lt;/p&gt;

&lt;p&gt;We &lt;em&gt;unlink&lt;/em&gt; people when they leave: removing the association between their GitHub
account and their corporate identity, and removing their GitHub organization
membership(s).&lt;/p&gt;

&lt;p&gt;We welcome former employees to continue to contribute and participate to projects
where they should continue to be maintainers, but for clarity, do not allow them
to remain as org members.&lt;/p&gt;

&lt;p&gt;We also send an e-mail to their former manager, so they have confidence that the
right things have happened with permissions and system access.&lt;/p&gt;

&lt;h3 id=&quot;enforced-system-teams&quot;&gt;Enforced “system teams”&lt;/h3&gt;

&lt;p&gt;To help enable operations, support, meet security obligations, and light up bots
such as our CLA system, we have a set of GitHub teams that are &lt;em&gt;automatically&lt;/em&gt;
and &lt;em&gt;permanently&lt;/em&gt; added to every repository in our GitHub orgs, when the job is
configured.&lt;/p&gt;

&lt;p&gt;By monitoring the GitHub event bus, the job adds what we call &lt;em&gt;system teams&lt;/em&gt; to
a repo the instant a new repo is created. And, if a repo admin tries to remove
or change the permissions that such a system team has, the job automatically
restores its permission.&lt;/p&gt;

&lt;p&gt;An occassional cronjob also runs to validate and reenforce these teams as needed.&lt;/p&gt;

&lt;h3 id=&quot;preventing-big-permission-grants&quot;&gt;Preventing big permission grants&lt;/h3&gt;

&lt;p&gt;As the number of members in a GitHub organization grows high, you’ll also start
to see very large teams.&lt;/p&gt;

&lt;p&gt;We have teams such as “All Employee Members” that are designed to give easy read
access to private repos that are being finished up and polished before going open
source.&lt;/p&gt;

&lt;p&gt;An unintended side effect we found: some people wanted to just give “all members”
administrative access over their repo, to make the act of onboarding get much
easier.&lt;/p&gt;

&lt;p&gt;Trouble is, with admin comes great power, and any of the thousands of members of
the org could then delete the repo, change whatever they want, override branch
protections, etc.&lt;/p&gt;

&lt;p&gt;This also would automatically subscribe thousands of people
to spammy notification messages, depending on their GitHub notification
preferences.&lt;/p&gt;

&lt;p&gt;As a result, we have a “large permissions” job that monitors for grants of write or
admin access to an org-defined “large” number of people. Once such a grant is made,
and the team is too large, the job will automatically downgrade the permissions to
try and prevent mistakes, and then send an e-mail address to the person who
made the permission choice, hoping to educate them about the risks and help them
understand what changes were made.&lt;/p&gt;

&lt;h3 id=&quot;github-username-changes&quot;&gt;GitHub username changes&lt;/h3&gt;

&lt;p&gt;GitHub allows users to change their username. This is excellent: many people start
with a cute screen name or other indicator, then realize they’re professionally
developing software with their peers in the industry, and often want to change that
username.&lt;/p&gt;

&lt;p&gt;Not all users know that they can rename their account, so we do get people who delete
an account, just to create a new one.&lt;/p&gt;

&lt;p&gt;However, the majority of GitHub apps and APIs work off of GitHub &lt;em&gt;usernames&lt;/em&gt; instead of
the integer-based &lt;em&gt;user ID&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;To help stay ahead of this, we have a cronjob that looks up GitHub users by &lt;em&gt;ID&lt;/em&gt; and then
refreshes our internal data store of those usernames, in the hope that we can improve
the API success rate and reduce support costs when renames happen.&lt;/p&gt;

&lt;p&gt;For critical operations, additional logic has been added to GitHub apps to anticipate
the potential of a user rename happening, and being able to smartly attempt to fallback to
looking up the user first by ID, or alerting and sending the issue to operational support.&lt;/p&gt;

&lt;h3 id=&quot;weekly-and-daily-digests&quot;&gt;Weekly and daily digests&lt;/h3&gt;

&lt;p&gt;We have a cronjob that sends updates about new changes and interesting happenings on
GitHub repos. These are typically only send to repo admins, to not spam too many
people.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/ospo-digests.png&quot; class=&quot;img-responsive&quot; title=&quot;A sample digest mail that is sent weekly to let repo and team maintainers know about new activity, updates, and abandoned repositories or other issues they need to take a look at.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The digests are personalized to the receipient, and cover scenarios such as:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;notifying the creator of a repo, and their manager, of the new repo&lt;/li&gt;
  &lt;li&gt;notifying when the # of admins becomes rather high, so that team maintainers can cleanup permissions&lt;/li&gt;
  &lt;li&gt;abandoned repos that haven’t been touched in years&lt;/li&gt;
  &lt;li&gt;when a team is down to a single maintainer, suggesting they appoint another maintainer or two&lt;/li&gt;
  &lt;li&gt;when a repository has been flipped from private to public&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;program-investments&quot;&gt;Program investments&lt;/h1&gt;

&lt;p&gt;More important than the technical tools and hacks we put in place, the programs
that we run in the Open Source Programs Office help drive process improvements,
awareness of features and capabilities, roll out new functionality, and to
emphasis the work that is happening in the open in new ways.&lt;/p&gt;

&lt;p&gt;Here’s a set of the OSPO investments we have been making or put in place to help
drive improvement in the open source maturity level of the company.&lt;/p&gt;

&lt;h2 id=&quot;docs&quot;&gt;Docs&lt;/h2&gt;

&lt;p&gt;We have a central documentation repository that is easily accessible to employees
where they can read through guides on how to go about releasing open source, or
contributing to it. The hope is that teams new to many of the tools and approaches
in open source can refer to the material, share it with others, and help us to
scale this to others.&lt;/p&gt;

&lt;p&gt;Here’s a rough look at the outline of some of that material. In time I hope we
can prepare a version of these docs to share with the world…&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- General Information
  - What exactly is Open Source?
  - When and why Open Source
  - Can I use it?
  - Misconceptions
  - Bad Practices
  - Benefits
- Use
  - Overview
  - Security and vulnerability management
  - Copyleft obligations
  - Code signing
  - Attribution guidelines
  - Business review process
  - Required notice generation
  - Automated registration of use
- Contribute
  - Contribution overview
  - Forking repositories
  - Business review, if required
- Release
  - Release overview
  - Checklist
  - Copyright headers
  - Foster your community
  - Build and publish your project
  - Code signing
  - Business review, if required
- Data and Insights
  - GitHub insights
  - Registrations and request insights
- GitHub information
  - GitHub overview
  - Accounts and linking
  - Repositories
  - Teams
  - Organizations
  - Transferring and migrating repos
  - Service accounts
  - Two-factor authentication
  - Apps, services and integrations
  - Large files, LFS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;monthly-newsletter&quot;&gt;Monthly newsletter&lt;/h2&gt;

&lt;p&gt;The team prepares a monthly newsletter to all interested parties in the company,
including all linked GitHub users, with a distribution north of 25,000
members. As a low-frequency resource, the hope is that the newsletter helps
provide useful information without inundating teams.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/ospo-newletter.png&quot; class=&quot;img-responsive&quot; title=&quot;A screenshot of the OSPO Newsletter&quot; style=&quot;max-height:400px&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Typical newsletters will include 3-5 topics and updates of note, some data or
graphs and charts of adoption and community health, and the date for the next
open source meetup.&lt;/p&gt;

&lt;h2 id=&quot;open-source-meetup&quot;&gt;Open Source Meetup&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/meetup.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A photo from a recent Open Source Meetup at Microsoft, a fun informal event.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A monthly gathering on the Microsoft campus (or online), the meetup is a quick
event that starts off with networking, a quick lunch, and then 3-4 speakers
who share their recent open source experiences.&lt;/p&gt;

&lt;p&gt;This helps connect people, have interesting conversations, and build community.&lt;/p&gt;

&lt;h2 id=&quot;open-source-champs&quot;&gt;Open Source Champs&lt;/h2&gt;

&lt;p&gt;A cross-company group of people who “get it”, these are some of the best open
source minds at Microsoft, who have connections, experience, data, and can help
drive best practices and advise on situations.&lt;/p&gt;

&lt;p&gt;The champs primarily get involved in a specific discussion list in the company
today, but hopefully in time they will also be able to help share information
with their organizations, and build a two-way conversation channel with more
stakeholders and businesses across the company.&lt;/p&gt;

&lt;p&gt;The champs will be a key part of helping us continue to scale and share and
get subject matter experts connected with the right teams as they open up.&lt;/p&gt;

&lt;h2 id=&quot;internal-support&quot;&gt;Internal support&lt;/h2&gt;

&lt;p&gt;OSPO offers an internal support experience, with internal mail, a Teams channel,
and other places, to help support people as needed.&lt;/p&gt;

&lt;p&gt;The most common issues tend to be helping people find the documentation for what
they are looking to do, pointing them at the GitHub account linking experience or
new repo wizard, or helping answer policy clarifications and questions.&lt;/p&gt;

&lt;p&gt;Not all questions can be answered by OSPO - we do at times need people to reach
out to their legal contact for their organization to support their request.&lt;/p&gt;

&lt;p&gt;It is also super important to us that we update internal docs and tools when
we learn of gaps or improvements that can be made, so that the next group of
people with the same need will not need an escalation or support incident to
help answer their question.&lt;/p&gt;

&lt;p&gt;We look to our principles around delegation, self-service, and elimination to
help reduce support cost, solving problems before they grow too large. A
clever hack or targeted fix often helps a lot.&lt;/p&gt;

&lt;h2 id=&quot;executive-council-and-briefings&quot;&gt;Executive council and briefings&lt;/h2&gt;

&lt;p&gt;Appointed executives from across Microsoft’s businesses make up the majority
of the “OSS Exec Council” that meets at least quarterly to discuss progress on
evolving the culture, being available to advise how their groups are contributing
to open source, and otherwise helping provide a conduit with leadership, the
open source champs, and our open source office. In many ways, this group is the
“board of directors” of our OSPO team and we look forward to helping to tackle
whatever is next as a company in this space.&lt;/p&gt;

&lt;p&gt;Having this in place helps us take the temperature of leadership of where to spend
our effort and how to think about complicated issues and how to make things
friction-free for our engineering teams who want to contribute to and use
open source everywhere.&lt;/p&gt;

&lt;p&gt;We’re also available to brief business leaders and others on their approach, share
the learnings others have had, and strive to remove roadblocks with all teams.&lt;/p&gt;

&lt;h1 id=&quot;learnings&quot;&gt;Learnings&lt;/h1&gt;

&lt;p&gt;We’ve learned a lot, and continue to learn as we
scale the open source adoption across the company. Many of the specifics learnings
I’ve had relate to how we operate at scale, how much we can set teams free with
tools and access, and how to help others learn from the experiences.&lt;/p&gt;

&lt;p&gt;Just a few short stories…&lt;/p&gt;

&lt;h2 id=&quot;our-github-bedlam-moment&quot;&gt;Our GitHub Bedlam moment&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;GitHub is super real: we finally had our own “Bedlam” incident earlier this year&lt;/strong&gt;… we had a
GitHub team inside one of our largest GitHub orgs called “All Members”, to make it easy to quickly
give access to private repos ahead of the launch of new work at events.&lt;/p&gt;

&lt;p&gt;The idea is that as long as you give ‘all members’ read access to the repo, they
can then fork and submit pull requests, making it easier than trying to figure out
what teams may grant them the rights they need. It also encourages the more open
contribution model we love.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://help.github.com/en/articles/about-team-discussions&quot;&gt;GitHub Team Discussions&lt;/a&gt; shipped in late
2017 and essentially were not very frequently used by our open source teams for
quite a while.&lt;/p&gt;

&lt;p&gt;Finally, one quiet day in January, &lt;a href=&quot;https://www.businessinsider.com/microsoft-employee-github-reply-all-email-storm-2019-1&quot;&gt;it finally happened&lt;/a&gt;…&lt;/p&gt;

&lt;p&gt;… someone posted a message to the “all employees in this org” team discussion,
immediately going out to a lot of people … and then someone posted about how
to update your notification settings … and then it spiraled out from there.&lt;/p&gt;

&lt;p&gt;Along the way we learned a few things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;People learned about GitHub discussions&lt;/li&gt;
  &lt;li&gt;We may have found a few minor bugs in the notification settings on GitHub that were corrected&lt;/li&gt;
  &lt;li&gt;We realized there are downsides to &lt;em&gt;massive&lt;/em&gt; teams&lt;/li&gt;
  &lt;li&gt;We had some fun, too&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Old time Microsoft people smiled a lot. Bedlam was a classic Microsoft learning
lesson. It’s fun that we can still have similar experiences with the modern
developer toolkit, too…&lt;/p&gt;

&lt;h2 id=&quot;two-factor-authentication&quot;&gt;Two-factor authentication&lt;/h2&gt;

&lt;p&gt;A surprising amount of our internal support traffic comes from employees who
unfortunately lose access to their GitHub accounts.&lt;/p&gt;

&lt;p&gt;Since we require our users to use GitHub’s two-factor authentication, and this
is a separate two-factor system than the Azure Active Directory multi-factor
auth that our employees also use, it’s easy for people to get confused, or to
lose access to the GitHub side of things.&lt;/p&gt;

&lt;p&gt;Thankfully, GitHub does a great job of helping remind people to save their
two-factor authentication codes and to encourage other technology such as the use
of U2F devices.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Everytime a new iPhone model comes out,&lt;/em&gt; our support volume spikes… a lot of
people use two-factor authentication apps on their phone, but then forget to
store their backup codes or anticipate that wiping their phone and upgrading to a new
one may not always restore what they think it may.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I strongly recommend that everyone have a YubiKey to help make things easier when
using GitHub on a daily basis.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;github-api-user-renames&quot;&gt;GitHub API: user renames&lt;/h2&gt;

&lt;p&gt;Most &lt;a href=&quot;https://developer.github.com/v3/&quot;&gt;GitHub REST v3 API&lt;/a&gt; calls operate
on GitHub &lt;em&gt;username&lt;/em&gt; as opposed to &lt;em&gt;user IDs&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;GitHub allows users to change their username, which means that if you are not
also validating what their current username is, you could find that a few API
calls are not working for a particular set of users who have changed their
usernames.&lt;/p&gt;

&lt;p&gt;There is a GitHub API that can take a GitHub user ID and provide you the current
user information response, so you can hit that occassionally, such as in a daily
job which also respects e-tags and caches responses, to make sure you have the
accurate username before calling operational APIs.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;At scale, we tend to see about 25 user renames per week at Microsoft right now.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;github-api-conditional-requests&quot;&gt;GitHub API: conditional requests&lt;/h2&gt;

&lt;p&gt;The GitHub API’s &lt;a href=&quot;https://developer.github.com/v3/#conditional-requests&quot;&gt;conditional request&lt;/a&gt; guidance
is good, but many libraries or users of their APIs do not seem to use them by
default.&lt;/p&gt;

&lt;p&gt;As long as you keep a cached version of the entities you request, you can use
the e-tag and an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;If-None-Match&lt;/code&gt; header to help reduce your load on the rate
limits for GitHub. A request with the existing e-tag, to check if the entity
has changed, will not count against your rolling API limit if it has not changed.&lt;/p&gt;

&lt;p&gt;It’s great seeing more and more libraries such as &lt;a href=&quot;https://github.com/octokit/rest.js&quot;&gt;octokit/rest.js&lt;/a&gt;
supporting this concept in various ways, or having extensibility for it.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Be nice to GitHub’s API.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;team-vs-individual-repo-permissions&quot;&gt;Team vs Individual repo permissions&lt;/h2&gt;

&lt;p&gt;Whenever possible we &lt;em&gt;strongly encourage&lt;/em&gt; that the repositories that Microsoft
governs use team permissions instead of granting individual permissions.&lt;/p&gt;

&lt;p&gt;GitHub Teams support multiple team maintainers, helping projects evolve over
time, and making it easier to keep access and admin permission assigned as
needed.&lt;/p&gt;

&lt;p&gt;We’ve had to do a lot of user education on this topic: if someone opens a support
ticket needing access permissions, we will never grant them individual permissions
(“Collaborator” on GitHub) to a repo, but instead will ask them to help us find
or create a new Team on GitHub for that permission assignment to go to.&lt;/p&gt;

&lt;p&gt;** Team permissions. Teams with maintainers. Avoid individual permissions.** This helps keep things sane. Very sane.&lt;/p&gt;

&lt;h2 id=&quot;transparency-around-permissions&quot;&gt;Transparency around permissions&lt;/h2&gt;

&lt;p&gt;As previously mentioned, our GitHub management portal shows all employees all the permissions for teams,
including secret teams. Since we are focused on enabling open source on GitHub,
this helps answer questions people have about who has access to administer or
change settings on a repo and reduces support volume.&lt;/p&gt;

&lt;p&gt;On GitHub you can natively see, given a team, which repos and permissions it
has, if you are a member of the org. However, you cannot see easily from a given
repo who the teams are.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Transparent data in the portal reduces support costs around the “404 these aren’t the droids you are looking for” experience on GitHub&lt;/strong&gt;:
since GitHub will return a 404 for a repo that an org member does not have
access to, we used to get a decent amount of support traffic from people asking
if the URL they were sent by a team member was real or not.&lt;/p&gt;

&lt;h2 id=&quot;paying-github&quot;&gt;Paying GitHub&lt;/h2&gt;

&lt;p&gt;Before we spent a few billion dollars on GitHub, we had paid GitHub organization accounts
at various pricing tiers for our open source GitHub orgs: we needed private repo access for people getting
ready to release their open source.&lt;/p&gt;

&lt;p&gt;Early on we would have a bunch of people running around with corporate cards and expensing
GitHub. Over the years we were able to consolidate this spend and bring sanity as the
GitHub use scaled, and also to help use that as a forcing function: by centrally funding
the official GitHub organizations for open source in the OSPO team, we were able to
make it easy for teams to get going without having to worry about billing or setting up
new organizations and systems.&lt;/p&gt;

&lt;p&gt;GitHub offered a really useful annual invoice payment method, so instead of having
to worry about using a corporate card or other payment method each month, we would
just submit a single payment for a set of GitHub orgs, then process that for
payment. GitHub sales was super helpful and friendly.&lt;/p&gt;

&lt;p&gt;The only minor issue we’ve had with this is the few times that we had to make
changes to the LFS data packs for an org during the year… we would solve this
by approving the purchase order for GitHub to include some additional buffer, so
that GitHub sales could just invoice us for the additional data packs as needed.&lt;/p&gt;

&lt;p&gt;Before we used the invoice payment method, we did use corporate credit cards as
needed and approved by our finance team; it was nice that we could associate a
Billing Manager or managers to the orgs to help manage that without having to
worry about permission to be org owners or control the resource itself.&lt;/p&gt;

&lt;p&gt;Kudos to the friendly GitHub sales and their supporting staff - they were always
willing to jump on a Zoom video conference call and work through the details, such as
when we were signing the Corporate Terms of Service agreement for some of our orgs.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;GitHub’s annual invoice payment option is really straightforward and can help you reduce random one-off corporate card expenses.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;org-proliferation&quot;&gt;Org proliferation&lt;/h2&gt;

&lt;p&gt;Many Microsoft teams love to ship the org chart, but when it comes to reinforcing
Microsoft’s open source releases, we prefer all repos to go in our few main
organizations.&lt;/p&gt;

&lt;p&gt;This also helps make it easier for engineers to get going: they do not need to
identify both an org and a team to work on a repo, they just need to know the
repo name or team details.&lt;/p&gt;

&lt;p&gt;By policy and reinforced in our tooling and other systems, we have asked people
to just use the official Microsoft GitHub org since early 2017.&lt;/p&gt;

&lt;p&gt;This has been super important by providing a really straightforward way for people
to get access and not worry about cross-org permissions or finding things. We
also know that product names and teams change so often that these things just
would not scale. While the GitHub rename features provide some flexibility to
orgs and repos, we would prefer not to change too many things at once.&lt;/p&gt;

&lt;p&gt;Newer GitHub features such as an &lt;a href=&quot;https://github.blog/2019-05-23-build-like-an-open-source-community-with-github-enterprise/&quot;&gt;enterprise account&lt;/a&gt;
announced in May sound really useful to help address this in the future: if you
can combine compliance and billing together, perhaps it will be easier to have
additional organizations where it makes sense.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Build a strategy around how many GitHub organizations your organization will have for open source. The answer might be 1.&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;human-challenges&quot;&gt;Human challenges&lt;/h1&gt;

&lt;p&gt;We’re continually learning from people! People are great.&lt;/p&gt;

&lt;h2 id=&quot;products-vs-projects&quot;&gt;Products vs Projects&lt;/h2&gt;

&lt;p&gt;Microsoft is super crisp on the requirements to ship products and services: the
&lt;a href=&quot;https://www.microsoft.com/en-us/securityengineering/sdl&quot;&gt;Microsoft Security Development Lifecycle (SDL)&lt;/a&gt;
helps team to be mindful of security and how to build and ship software.&lt;/p&gt;

&lt;p&gt;As a company, our products also have requirements around code signing, packaging,
localization, globalization, servicing, accessibility, etc.&lt;/p&gt;

&lt;p&gt;Shipping an open source code project (a &lt;em&gt;repo&lt;/em&gt;) is a little less involved, but teams
still need to do the right thing.&lt;/p&gt;

&lt;p&gt;Our policies around releasing source code are more about business purpose and approval,
making sure governance information and LICENSE files and READMEs are in place, and that
teams are ready to support, build and evolve a friendly open community.&lt;/p&gt;

&lt;p&gt;We’ve had a few learning situations where teams thought that the full set of requirements
to release a product - such as localizing in many languages - were required to release
an open source repo.&lt;/p&gt;

&lt;p&gt;For now, we emphasize to teams that projects are not products, but often, they compliment
one another, and sometimes, they literally are the same thing.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Products and services are very different from open source code. That’s OK. Tell your friends.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;forking-guidance&quot;&gt;Forking guidance&lt;/h2&gt;

&lt;p&gt;Forking is a big deal in the open source world. There are times where a fork is the
right evolution or move for a community to evolve, but we’ve found that some teams view
forks as the way to contribute upstream.&lt;/p&gt;

&lt;p&gt;For example: if someone wants to contribute to CLA Assistant, one approach would be to
fork the repo to their &lt;em&gt;individual&lt;/em&gt; GitHub account, and then to submit a pull request to
that upstream project. Another approach would be to fork the project to the official Microsoft
organization, prepare changes, and then submit it as a pull request.&lt;/p&gt;

&lt;p&gt;While the second example
makes it clear that this is very much a Microsoft contribution, it creates confusion, because
Microsoft just wants to participate in the upstream project, and not fork it in any hard way.&lt;/p&gt;

&lt;p&gt;We strongly encourage teams to simply fork and submit pull requests, the GitHub way, from
their individual accounts, not from the official organization account.&lt;/p&gt;

&lt;p&gt;We want teams to always contribute to the upstream when possible and only fork as a last resort.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Forking can be a big deal. Upstream is the right place to contribute.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;support-volume-e-mail&quot;&gt;Support volume (e-mail)&lt;/h2&gt;

&lt;p&gt;Since we set the e-mail address &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opensource at microsoft&lt;/code&gt; as the e-mail address associated
with the official Microsoft organization on GitHub, we get &lt;em&gt;a lot&lt;/em&gt; of e-mail traffic from
people looking for help with issues and products.&lt;/p&gt;

&lt;p&gt;Within GitHub, if you’re browsing a repo and click “Contact GitHub” in the footer of the web
page, it essentially asks whether you are looking to report a GitHub issue or an issue with
the repo. This helps reduce issue/support traffic to GitHub for open source repos.&lt;/p&gt;

&lt;p&gt;GitHub then offers the e-mail address associated with the SUPPORT files for the repo, or falls
back to the org-wide e-mail address. So… we get a lot of e-mail.&lt;/p&gt;

&lt;p&gt;We’ve learned to improve spam filters and use templates and work to address issues, but
we do get a lot of mail.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Expect that support will need to happen.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;people-want-more-open-source-from-us&quot;&gt;People want more open source from us!&lt;/h2&gt;

&lt;p&gt;On the entertaining side, many passionate users of long-time Microsoft software regularly
write in to ask us to open source their favorite projects…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Flight Simulator&lt;/li&gt;
  &lt;li&gt;Microsoft Money&lt;/li&gt;
  &lt;li&gt;Age of Empires&lt;/li&gt;
  &lt;li&gt;our operating system&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It’s great that people really want to see this, but I think a lot of folks do not always
understand that commercial software often has many dependencies or licensed components
that may not be open source, or the code requires a very specialized build environment,
etc.&lt;/p&gt;

&lt;p&gt;I do love seeing the historical releases to share code, such as the
&lt;a href=&quot;https://github.com/microsoft/winfile&quot;&gt;original winfile.exe&lt;/a&gt; or
old-school &lt;a href=&quot;https://github.com/microsoft/MS-DOS&quot;&gt;MS-DOS 1.25 and 2.0&lt;/a&gt;! Hopefully
teams will find the time to share when it makes sense. It’s also a reality that historical
software releases are not a place that will be easy to build an active collaborative
community around unless a clean mechanism exists to release and build modern bits.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Open source all the things&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;exciting-new-github-features&quot;&gt;Exciting new GitHub features&lt;/h1&gt;

&lt;p&gt;As outlined in &lt;a href=&quot;https://github.blog/2019-05-23-build-like-an-open-source-community-with-github-enterprise/&quot;&gt;Build like an open source community with GitHub Enterprise&lt;/a&gt;, Mario Rodriguez from
GitHub highlights how the features that help make GitHub great for open source can
also be super useful for any organization.&lt;/p&gt;

&lt;p&gt;We’ve started moving to GitHub Enterprise Cloud for more of our open source
organizations and I’m excited to see what our engineering teams will do with
these new capabilities.&lt;/p&gt;

&lt;p&gt;A few capabilities in particular that we’re starting to use include:&lt;/p&gt;

&lt;h2 id=&quot;org-insights&quot;&gt;Org insights&lt;/h2&gt;

&lt;p&gt;Available in beta now for Enterprise Cloud accounts, you can take a look at the high-level
trends around new issues, closed issues, and other key specs and data points for all of your
repositories across the org.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/org-insights.png&quot; class=&quot;img-responsive&quot; title=&quot;Org insights in our Enterprise Cloud account&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another nice view is the “where members are getting work done” look at where time is being spent on GitHub by everyone contributing to the org.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/enterprise-getting-work-done.png&quot; class=&quot;img-responsive&quot; title=&quot;A view of where the activity is happening in the organization.&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;maintainer-roles&quot;&gt;Maintainer roles&lt;/h2&gt;

&lt;p&gt;Especially interesting to teams like .NET which have a large amount of activity and
maintainers, new roles beyond the classic “read/write/admin” on GitHub means that
they can appoint &lt;strong&gt;Triage&lt;/strong&gt; users (can manage issues and PRs, but not push code directly to the repo) or &lt;strong&gt;Maintain&lt;/strong&gt; users (additional settings on top of issues and PR management).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/new-github-maintainer-permission.png&quot; class=&quot;img-responsive&quot; title=&quot;New GitHub maintainer roles include the Maintain and Triage roles.&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;transferring-issues&quot;&gt;Transferring issues&lt;/h2&gt;

&lt;p&gt;Moving issues between repos used to be done by third-party, unofficial, or random tooling, and
now that GitHub directly supports issue movement, we’re pretty happy to see this additional option
open for communities who have issues spanning multiple repos.&lt;/p&gt;

&lt;h2 id=&quot;audit-logs&quot;&gt;Audit logs&lt;/h2&gt;

&lt;p&gt;GitHub has an audit log API beta for Enterprise Cloud customers now. Using GraphQL,
this means that we will be able to keep an audit log copy in our systems for review,
analysis, and without the manual or cumbersome approach required today to either
ingest and store webhook information in an append-only data store, and/or parse the
JSON and CSV versions of the audit log for a GitHub organization.&lt;/p&gt;

&lt;h1 id=&quot;looking-forward&quot;&gt;Looking forward&lt;/h1&gt;

&lt;p&gt;We have a lot left to do and our journey will continue to get more interesting as
Microsoft continues its open source adventure. Some of the things the Open Source
Programs Office will be thinking through will include…&lt;/p&gt;

&lt;p&gt;As a company we will continue to work to evolve our take on a “maturity model” for
open source organizations, and I can’t wait to see what is next.&lt;/p&gt;

&lt;h2 id=&quot;sharing-guidance-and-guides&quot;&gt;Sharing guidance and guides&lt;/h2&gt;

&lt;p&gt;Similar to the &lt;a href=&quot;https://opensource.guide&quot;&gt;Open Source Guides at //opensource.guide&lt;/a&gt; created
by GitHub, we’d love to share, to help others in the industry learn from our
progress.&lt;/p&gt;

&lt;p&gt;Playbooks around how to think about open source, making business decisions related to
open source, all are fun topics we would love to share our learnings and take on.&lt;/p&gt;

&lt;p&gt;We may also be able to share our docs, or a version of them, with the world. &lt;a href=&quot;https://opensource.google.com/docs/&quot;&gt;Major kudos to Google&lt;/a&gt; who already shares their open source guidance and policies
on their site.&lt;/p&gt;

&lt;h2 id=&quot;identifying-contribution-opportunities&quot;&gt;Identifying contribution opportunities&lt;/h2&gt;

&lt;p&gt;We are starting to look at ways to draw attention to contribution opportunities, such
as highlighting &lt;a href=&quot;https://opensource.microsoft.com/explore&quot;&gt;up-for-grabs issues across our releases&lt;/a&gt;,
and also recognizing when our employees contribute to open projects outside control of the
company, too.&lt;/p&gt;

&lt;p&gt;By updating the &lt;em&gt;opensource.microsoft.com&lt;/em&gt; site, we hope to be able to tell good
stories and share useful information about what our teams are up to.&lt;/p&gt;

&lt;p&gt;As a short-term experiment, we are listing “up for grabs” issues right on the homepage of
our open source site, to learn about whether people find that interesting.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2019gh/contribute.png&quot; class=&quot;img-responsive&quot; title=&quot;An experiment on the opensource.microsoft.com site to show up-for-grabs and available work items from Microsoft repositories&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;open-source-resources&quot;&gt;Open Source Resources&lt;/h1&gt;

&lt;p&gt;Here are open source GitHub repos mentioned in this post. Check them out!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/cla-assistant/cla-assistant&quot;&gt;cla-assistant/cla-assistant&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/amzn/oss-attribution-builder&quot;&gt;amzn/oss-attribution-builder&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/clearlydefined/crawler&quot;&gt;clearlydefined/crawler&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/todogroup/repolinter&quot;&gt;todogroup/repolinter&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/clearlydefined/curated-data&quot;&gt;clearlydefined/curated-data&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Microsoft/opensource-portal&quot;&gt;microsoft/opensource-portal&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/microsoft/ghcrawler&quot;&gt;microsoft/ghcrawler&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/fossology/fossology&quot;&gt;fossology/fossology&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/nexB/scancode-toolkit&quot;&gt;nexB/scancode-toolkit&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/licensee/licensee&quot;&gt;licensee/licensee&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/octokit/rest.js&quot;&gt;octokit/rest.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Hope you found this interesting, let me know what you think on Twitter. If you were expecting a
short or concise post, you may have clicked on the wrong thing…&lt;/p&gt;

&lt;p&gt;&lt;i&gt;Jeff Wilcox&lt;br /&gt;
Principal Software Engineer&lt;br /&gt;
Microsoft Open Source Programs Office&lt;/i&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>My home network: Ubiquiti UniFi gear, fiber gigabit Internet, CAT6 and CAT3 wiring</title>
   <link href="http://www.jeff.wilcox.name/2018/04/seattle-network/"/>
   <updated>2018-04-10T00:00:00+00:00</updated>
   <id>http://www.jeff.wilcox.name/2018/04/seattle-network</id>
   <content type="html">&lt;p&gt;WiFi that just works with multiple mounted access points. Symmetric 1000 Mbps 
symmetric gigabit Internet. Centrally managed enterprise network gear. Pulling 
new CAT6 while dealing with old CAT3 in a condo.&lt;/p&gt;

&lt;p&gt;This is my story, long overdue, about some of the experiences, challenges, and 
information about the connectivity tech I enjoyed at home. I love not having to 
worry about my WiFi ever having issues, even in the dense city, thanks to 
enterprise-grade gear.&lt;/p&gt;

&lt;p&gt;In Seattle we’re lucky to have broad access in apartments/condominiums to
gigabit Internet from providers such as 
&lt;a href=&quot;https://waveg.wavebroadband.com/&quot;&gt;Wave G&lt;/a&gt; (a.k.a. CondoInternet). Having a 
zippy connection without bandwidth caps means that I’m free to stream 4K content,
backup my on-premise storage to the cloud, and not worry about keeping 
operating system installation disc images around.&lt;/p&gt;

&lt;p&gt;My building’s gigabit is provided by a 10G fiber link to a data center just a 
few blocks away, which then has its own 40G link to classic peering location in
Seattle - . Our rooftop also has several 60GHz millimeter wave radio links, 
available either as backup or to serve nearby buildings. In this post 
I wanted to share how that infrastructure is deployed in my condo building.&lt;/p&gt;

&lt;p&gt;With fiber to our building there are minimal hops between major cloud 
providers and big networks thanks to the many peering opportunities in downtown
Seattle. The 
&lt;a href=&quot;https://www.westinbldg.com/&quot;&gt;Westin Building Exchange&lt;/a&gt; carrier hotel/colo is 
home to the important non-profit 
&lt;a href=&quot;https://www.seattleix.net/&quot;&gt;Seattle Internet Exchange&lt;/a&gt;, moving terabits per second, 
with a transparent approach that lets you peek at their stats, story and customers.&lt;/p&gt;

&lt;p&gt;Having fast Internet creates pressure to be able to move a lot of packets to 
take advantage of the speed, and that’s where enterprise-grade managed network
equipment comes in. There’s a lot of value in the data and featureset of the 
UniFi line from &lt;a href=&quot;https://www.ubnt.com/&quot;&gt;Ubiquiti Networks&lt;/a&gt; when it comes to 
routing, switching, and access points.&lt;/p&gt;

&lt;p&gt;I’ve been running a Ubiquiti network at home for over 2 years and have been very
happy with that investment.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/post-collage.jpg&quot; class=&quot;img-responsive&quot; title=&quot;From left-to-right: UniFi security gateway pro, PoE switch, and other rack gear; a screenshot of the deep packet inspection features of the UniFi Controller; an access point glowing; screenshot of my 2G RF environment; picture of one of the intermediate distribution frame (IDF) near my unit&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, I wanted to document some of the challenges with old CAT3 and 
pulling new pulling CAT6 within the constraints of my condo building, mostly to
share my pain.&lt;/p&gt;

&lt;p&gt;Apologies in advance, this post is full of up-optimized images and is much too
long.&lt;/p&gt;

&lt;p&gt;&lt;small&gt;Disclaimer:&lt;br /&gt;
I’m a tech enthusiast in this space but don’t represent any of the companies 
mentioned. While my initial Ubiquiti buildout in Feb. 2016 was my own, in 
Dec. 2017 I was provided a demo AC-HD access point to evaluate. 
I’ve since purchased my own AC-HD.&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4/15/18 update:&lt;br /&gt;
Through follow-up conversations on Twitter following this post, I discovered 
something amazing: our building was originally provided Internet through 
millimeter wave, and still has it as a backup and to provide coverage to other 
nearby buildings, but our building is actually connected directly through a 
10 Gigabit fiber link. Cool!
&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4/16/18 update:&lt;br /&gt;
Wave G (Spectrum and family) actually has at least 1x 100 Gbit fiber connection 
to the SIX, soon to have a second.
&lt;/strong&gt;&lt;/p&gt;

&lt;!-- ---------------- WAVE G ---------------- --&gt;

&lt;h1 id=&quot;wave-g--condointernet&quot;&gt;Wave G / CondoInternet&lt;/h1&gt;

&lt;p&gt;Even today, I remember a conversation with my friend Alex a decade ago when 
15 Mbps down, 2 Mbps up cable Internet was a common offering from Comcast and 
competitors, and if you used DSL, it’d be even slower.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Alex (in 2008): “My apartment building just got CondoInternet. 100 Mbps up and down, no caps or contracts.”&lt;/p&gt;

  &lt;p&gt;Jeff: “That’s hard to believe, that’s like what I had in my university dorm room, but no commercial providers offer that sort of speed. There must be caps or something. It can’t be  that fast!”&lt;/p&gt;

  &lt;p&gt;Alex: “It’s true, and I hear you can also get a 1000 Mbps connection. This is the future.”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Alex was right, I was wrong. 
If you live in an apartment or condo in Seattle, chances are you’re reading this 
via your &lt;a href=&quot;https://waveg.wavebroadband.com&quot;&gt;Wave G&lt;/a&gt; connection, but for those 
that are not familiar with the service, this is a primer.&lt;/p&gt;

&lt;p&gt;Wave G, formerly known as CondoInternet before being acquired by the Wave 
conglomerate, was founded a decade ago by techies who ran their own wholesale 
bandwidth business and wanted to have fast Internet at home in their condos.&lt;/p&gt;

&lt;p&gt;Today, the Wave G gigabit product is the gold standard for everyone from tech 
employees working from home to being the best ISP in town to stream content with.
It’s basically the opposite of Comcast: no contracts, no upward pricing pressure,
quick service, no cable modem required, no bundling.&lt;/p&gt;

&lt;p&gt;If your multi-family building is connected to Wave G (hundreds are), often you
only need to make a phone call and patch your unit’s home run network cable 
to your router or computer.&lt;/p&gt;

&lt;p&gt;From the home run, a nearby comms closet holds Wave G’s managed switch equipment,
at which point you’re on their network: fiber from our building runs to a 
nearby data center, then Seattle’s central peering fiber hotel.&lt;/p&gt;

&lt;h2 id=&quot;locations&quot;&gt;Locations&lt;/h2&gt;

&lt;p&gt;Wave G is available today in several cities in Western Washington including 
Seattle, Bellevue and Everett; Portland, Oregon; and in California, Roseville 
and then San Francisco all the way to San Jose.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/wave-locator.png&quot; class=&quot;img-responsive&quot; title=&quot;A screenshot of the Wave G service locator&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There’s some competition, too - while Wave acquired a previous similar company,
Cascadelink, Google Fiber’s Webpass is available in the neighborhood,
and I’m seeing more expansion there. Wave was recently purchased by a 
leveraged buyout and investment firm, TPG Capital, and I’m interesting to see 
what happens to the service. Hopefully no change.&lt;/p&gt;

&lt;h2 id=&quot;pricing&quot;&gt;Pricing&lt;/h2&gt;

&lt;p&gt;If you pay for gigabit, Wave G configures your switch port for full duplex 
1000 Mbps negotiation; otherwise your link will negotiate to 100 Mbps.&lt;/p&gt;

&lt;p&gt;The pricing as far as I can remember has been $60/month for 100 Mbps 
or $80/month for 1000 Mbps. A few years ago gigabit was double the price of the 
hundred megs, so there was a price reduction.&lt;/p&gt;

&lt;h2 id=&quot;most-of-the-web-is-slow&quot;&gt;Most of the web is slow…&lt;/h2&gt;

&lt;p&gt;While you can stream 4K content just fine without buffering, or download an OS 
image in seconds, at home you don’t really need a gigabit connection for most 
daily web tasks (yet).&lt;/p&gt;

&lt;p&gt;While just under 1000 Mbps is the theoretical gigabit maximum, most web sites 
and cloud services aren’t going to be able to make full use of your connection 
in a sustained manner. Large files hosted on CDNs should be quick at least:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/quick-windows-download.png&quot; class=&quot;img-responsive&quot; title=&quot;At least you can download Windows and Linux ISO images in a few minutes&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Having gigabit at least feels like a key requirement to experiment with 4K
content, keeping all your storage in the cloud, VR, and other up-and-coming 
advancements.&lt;/p&gt;

&lt;h2 id=&quot;wave-gs-network&quot;&gt;Wave G’s network&lt;/h2&gt;

&lt;p&gt;Once your home is connected to Wave G’s network, they have their own 
efficient gear that connects to their fiber, eventually peering with 
others inside data centers and nearby colo facilities like the 
&lt;a href=&quot;https://www.westinbldg.com/&quot;&gt;Westin Building Exchange (WBX)&lt;/a&gt; and the 
&lt;a href=&quot;https://www.seattleix.net/&quot;&gt;Seattle Internet Exchange (SIX)&lt;/a&gt;,
providing short hops and low latency. Buildings near ours connect to the 
10 Gbit fiber backhaul our building has underground using millimeter wave 
radios on the roof of our building.&lt;/p&gt;

&lt;p&gt;This is where the original Condo Internet company took advantage of their
parent company, Spectrum Networks, and their wholesale bandwidth offerings and
connectivity.&lt;/p&gt;

&lt;p&gt;From my home network, my CAT6 networked machines get sub-millisecond - to - 1ms
ping times to Google, Microsoft, and all the major modern Internet services, just 
a few hops away…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/waveg-ping-times.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;890-940-mbps-typical-test-speeds&quot;&gt;890-940 Mbps typical test speeds&lt;/h2&gt;

&lt;p&gt;Testing with &lt;a href=&quot;http://www.speedtest.net/&quot;&gt;SpeedTest.net&lt;/a&gt; I’ll usually see 
download speeds between 850-950 Mbps depending on the test site selected, and 
interestingly, my upload speeds are usually measured consistently around 950 Mbps.&lt;/p&gt;

&lt;p&gt;In my home, only wired equipment experiences the full potential of this
connectivity, since WiFi is very dense in my neighborhood - lots of interference 
means that devices individually often connect at a slower line rate.&lt;/p&gt;

&lt;p&gt;According to Netflix’s &lt;a href=&quot;https://fast.com&quot;&gt;fast.com&lt;/a&gt;, when I recently checked, 
my connection was approximated to 920 Mbps. Fast.com does a nice job of 
estimating various data sources to find a number that represents how your 
Netflix experience should be.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/netflix-fast.png&quot; class=&quot;img-responsive&quot; style=&quot;max-width: 360px&quot; title=&quot;According to Netflix fast.com, the connection speed is approximately 920 Mbps.&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;fiber-backbone&quot;&gt;Fiber backbone&lt;/h2&gt;

&lt;p&gt;While many buildings in Wave G’s network are connected by millimeter wave 
rooftop connections, our building has a 10G fiber connection. Our building also
has rooftop millimeter wave dishes to serve other nearby buildings that do not
have fiber runs.&lt;/p&gt;

&lt;p&gt;If you look out from our tower’s roof toward Elliott Bay, you can see a few of
the other nearby buildings that we connect to:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/other-buildings.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A look toward Elliott Bay, highlighting microwave Internet rooftop connections as part of the neighborhood mesh network.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Turning around and facing downtown Seattle, looking across the Belltown
neighborhood, there are many rooftop sites, likely all part of the Wave G
network:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/other-buildings2.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Looking across the Belltown neighborhood, nearly every rooftop has microwave backhaul equipment.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Our roof has 6+ &lt;a href=&quot;https://bridgewave.com/bw64/&quot;&gt;BridgeWave 60GHz millimeter wave radios&lt;/a&gt;.
Each of these antennas provides a 1 Gbps full-duplex encrypted link between locations,
essentially a large private mesh network.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/rooftop-microwaves.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Rooftop 60GHz microwave backhaul equipment.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In our building’s garage basement, that network connects to the 10 Gigabit 
backbone network that Spectrum networks and Wave G runs.&lt;/p&gt;

&lt;h2 id=&quot;static-ipv4-ipv6-blocks&quot;&gt;Static IPv4, IPv6 blocks&lt;/h2&gt;

&lt;p&gt;I don’t actually know the latest on this story (whether it’s a monthly or a
one-time charge now), but when I requested my static IP years ago, it was a one-time 
$15 fee for a static static IPv4 address, and now I also have my own IPv6 block.&lt;/p&gt;

&lt;p&gt;When moving between buildings and units, I’ve needed to get a new static IP 
address, but have been happy with the great support experience in requesting 
those changes and coordinating my moves.&lt;/p&gt;

&lt;h2 id=&quot;great-tech-support&quot;&gt;Great tech support&lt;/h2&gt;

&lt;p&gt;I’ve never experienced a large outage, but when I was first setting up my
connection, due to the CAT3 wiring to my unit, I was only able to get 100 Mbps
connection to the carrier switch.&lt;/p&gt;

&lt;p&gt;Wave G’s primary equipment has commercial UPS units present, and the switching
gear throughout the building runs off of the emergency generator circuit in
our building.&lt;/p&gt;

&lt;p&gt;When I first moved to my condo, I had a tech come out to help me look into why 
I was only able to get a 100 Mbps connection, and in the end I learned a lot
about CAT3 and the heavy signal degradation I was experiencing. (More about my
CAT3 woes later in this post)&lt;/p&gt;

&lt;p&gt;The tech even came out with a box of CAT5e cable in case we wanted to pull a new
home run to my unit. Appreciate the enthusiasm and free support.&lt;/p&gt;

&lt;h2 id=&quot;easy-activation&quot;&gt;Easy activation&lt;/h2&gt;

&lt;p&gt;Since there are no contracts, and so many multi-family buildings are already
wired for Wave G - with a switch near you - it’s easy to get going.&lt;/p&gt;

&lt;p&gt;If your unit has been served by Wave G in the past, chances are you have an
Ethernet jack in your unit that is still patched into to their switch, with
a disabled port. This can be remotely reactivated once you establish an
account.&lt;/p&gt;

&lt;p&gt;I’ve lived in 3 different buildings with Wave G service in the past, and in all
cases was able to get up and running over the phone or quickly after signing up
for the service.&lt;/p&gt;

&lt;p&gt;If your unit hasn’t been served by them in the past, there are a few different
scenarios, but they all play out quickly by a tech:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Your unit’s cable may need to be punched down or patched to a Wave G switch port&lt;/li&gt;
  &lt;li&gt;Your unit’s interior network closet may need to get patched to the Wave G uplink&lt;/li&gt;
  &lt;li&gt;You may need to have an existing telephone jack converted to a CAT6 keystone jack (if you’re served by CAT3, which was my case)&lt;/li&gt;
  &lt;li&gt;You might need a VDSL or other device to handle very old wiring (probably more rare today)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;a-valuable-building-amenity&quot;&gt;A valuable building amenity&lt;/h2&gt;

&lt;p&gt;I made it a point while looking to purchase a home that I know what current
Internet offerings available for each potential property.&lt;/p&gt;

&lt;p&gt;I’m surprised that more apartment rental ads and real estate listings don’t
clearly call out that they are served by a gigabit Internet provider beyond the
cable company. I still meet fellow tech employees and residents in my building
who aren’t aware of how great the offering is.&lt;/p&gt;

&lt;p&gt;One other small branding issue - when Wave renamed Condo Internet to Wave G,
I’ve found that some of my building’s residents believe that Wave G is the same
thing as the Wave cable/coax-based broadband product.&lt;/p&gt;

&lt;p&gt;I try to tell them that Wave G is an amazing product, great connectivity and all.&lt;/p&gt;

&lt;p&gt;Seems worth highlighting, similar to letting people know that your property
is within walking distance of a Microsoft Connector bus stop for employees.&lt;/p&gt;

&lt;h2 id=&quot;building-infrastructure&quot;&gt;Building infrastructure&lt;/h2&gt;

&lt;p&gt;Having helped maintain and upgrade some of our building’s tech, I’m familiar
with its communication infrastructure. Here’s how our building’s communications
equipment works.&lt;/p&gt;

&lt;p&gt;The Main Distribution Frame (MDF) is located 3 levels below ground (the “C level garage”) 
in the core of our high-rise tower. The MDF is where the phone company, multiple cable
companies, and other services come together. For Wave G, this is where they 
have installed their core switching equipment, fiber splices, and UPS backup.&lt;/p&gt;

&lt;p&gt;Here’s our MDF:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/2018-mdf-2.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A look at the main distribution frame (comms room) serving the building, including traditional telco, multiple cable providers, DirecTV, and our rooftop microwave backhaul provider.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From left to right::&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;traditional telephone provider&lt;/li&gt;
  &lt;li&gt;various business phone lines&lt;/li&gt;
  &lt;li&gt;fire equipment&lt;/li&gt;
  &lt;li&gt;VoIP lines and our building’s private network&lt;/li&gt;
  &lt;li&gt;Comcast coax cable&lt;/li&gt;
  &lt;li&gt;Wave G network rack&lt;/li&gt;
  &lt;li&gt;Wave G fiber underground run from a nearby data center&lt;/li&gt;
  &lt;li&gt;Wave Broadband coax cable&lt;/li&gt;
  &lt;li&gt;DirecTV cable&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Focusing on Wave G, from the MDF, fiber and CAT5 runs in 3 directions: the fiber
splits off - it runs up 15 floors to the rooftop, another connects 
hundreds of feet away to the other tower in our building, into its first 
communications room, and the backbone comes from an armored fiber run 
that goes several blocks away to the data center at 3101 Western Ave.&lt;/p&gt;

&lt;p&gt;Within the core of the building, telco rooms alternate with power generation 
and electric meter utility rooms as you move up the risers. The communication 
rooms are also known as Intermediate Distribution Frame (IDF) rooms.&lt;/p&gt;

&lt;p&gt;The IDFs are  a mess, mostly the cable companies who leave the rooms full of
splitters and amplifiers. I respect the contractors who visit and leave the IDF
cleaner than they found ‘em!&lt;/p&gt;

&lt;p&gt;Here’s the IDF on my floor… from left to right: a panel where the fiber 
and some network cabling goes up to the rooftop, Comcast, some of our building’s 
private network cable, Wave G equipment and switch, traditional telco, 
individual unit CAT3 patch panels, coax and other equipment, and a bunch of messy 
coax splitters and amplifiers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/idf-11.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A sample IDF, full of equipment, switch, lots of different communications providers in one place.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Each unit in our building has a choice between multiple providers, so a unit’s 
coax cable connects to either Comcast, Wave broadband, or DirecTV in the IDF.&lt;/p&gt;

&lt;p&gt;The network home run for our units is a single CAT3 6-pair cable that can carry
both network signals and POTS. Wave G patch cable is then punched into the network
terminals for customer units.&lt;/p&gt;

&lt;p&gt;Here’s a closer look at the short patch runs from the switch down to the
CAT3 patch panels:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/idf-patch.jpg&quot; style=&quot;max-width: 300px&quot; class=&quot;img-responsive&quot; title=&quot;A closer look at the patch connections between the Wave G switch, individual units punchdown terminals, and telco pairs&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From the punchdown panels, the cables for all the units run to the ceiling 
and then into conduit embedded in the concrete slab.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/idf-conduit-homeruns.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Conduit homeruns embedded in the slab&quot; /&gt;&lt;/p&gt;

&lt;!-- ---------------- SIX, WBX ---------------- --&gt;

&lt;h1 id=&quot;seattles-internet-connectivity&quot;&gt;Seattle’s Internet connectivity&lt;/h1&gt;

&lt;p&gt;Not counting my favorite Azure data center where I spend a lot of my days
virtually, the Pacific Northwest’s Internet gravity is at the edge of Belltown, 
at the corner of Virginia Street and 6th Avenue… not because of the thousands 
of Amazonians looking for lunch around there every day, but because of the 
Westin Building office tower next to the Westin hotel.&lt;/p&gt;

&lt;p&gt;The Westin Building, named for the corporate headquarters of the Westin hotel 
chain (before they were purchased by Starwood Hotels and then a much more boring hotel
conglomerate), is an office building turned carrier and fiber hotel.&lt;/p&gt;

&lt;p&gt;From my condo building we have fiber to a data center a few blocks away at 
3101 Western Ave - home of the NYI SEA1 DC - and Wave / Spectrum has multiple 
fiber connections to the Westin Building from there, at least one of which is 
a 100 Gbit connection. Spectrum is also an extension member of the Seattle Internet Exchange 
hosted in the Westin Building.&lt;/p&gt;

&lt;h2 id=&quot;westin-building-exchange&quot;&gt;Westin Building Exchange&lt;/h2&gt;

&lt;p&gt;Today the 34-story Westin Building is mostly colo space, tons of network gear 
and fiber, and I can only imagine the building’s bandwidth, as they are home to 
over 200 ISPs. According to 
&lt;a href=&quot;https://www.westinbldg.com/Content/PDF/WBX_Fact_Sheet.pdf&quot;&gt;the Westin Building Exchange datasheet&lt;/a&gt;,
they have over 19.5 megawatts of backup generation available from 17 diesel
generators.&lt;/p&gt;

&lt;p&gt;While a lot of the classic hosters and companies are located here, an example 
of the scale is Equinix, a major connectivity company: their SE2 data
center is located within the Westin Building, and a few years ago they built
an orange/concrete-colored 8-story building, SE3, located right next door to the
Westin Building’s garage… and Palace Kitchen. Tasty.&lt;/p&gt;

&lt;h2 id=&quot;seattle-internet-exchange-six&quot;&gt;Seattle Internet Exchange (SIX)&lt;/h2&gt;

&lt;p&gt;The &lt;a href=&quot;https://www.seattleix.net/about&quot;&gt;Seattle Internet Exchange&lt;/a&gt; (SIX) has a cool 
story… as a non-profit that is now more than 20 years old, they offer the 
community a great service by peering terabits of traffic. They started out in 
a small closet in the Westin Building.&lt;/p&gt;

&lt;p&gt;SIX is completely transparent, their website is full of near real-time graphs 
of their aggregate traffic, lists of all their peering members, etc. 
&lt;a href=&quot;https://www.seattleix.net/statistics/&quot;&gt;Really do go check out the SIX statistics page now&lt;/a&gt;. 
While you’re at it, I also enjoyed a &lt;a href=&quot;https://www.youtube.com/watch?v=N2ChhZcH2ok&quot;&gt;YouTube video about SIX with Jared Reimer&lt;/a&gt; that helps share some of this story from a conference.&lt;/p&gt;

&lt;p&gt;The story about SIX is that a few engineers were super frustrated to find that 
they were seeing “a 111ms round trip time between 2 companies on the very same 
19th floor of the Westin Exchange”… turns out their traffic was going from 
the 19th floor… to Texas… back to the 19th floor of the building. Peering 
sure could help.&lt;/p&gt;

&lt;p&gt;As of 2017 they had 284 participants in the exchange who pay a one-time
reasonable fee for their port; today at peak they aggregate over a
terabit of traffic, and their members have over 4 Tbps of capacity.&lt;/p&gt;

&lt;p&gt;Here’s &lt;a href=&quot;https://www.seattleix.net/topology&quot;&gt;their topology, including the switch equipment and models&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you happen to be sitting nearby to SIX, they do not charge monthly port 
connection fees, just the one-time… $100 for a 1000 Mbps port, $2,000 for 10 GbE, 
and $10,000 for 40 GbE or 100 GbE SFP modules.&lt;/p&gt;

&lt;p&gt;Since they are very transparent in all things, you can review &lt;a href=&quot;https://www.seattleix.net/participants/&quot;&gt;the whole list&lt;/a&gt; or 
&lt;a href=&quot;https://www.seattleix.net/participants/switches/SIX_7512R.txt&quot;&gt;this list&lt;/a&gt; and 
&lt;a href=&quot;https://www.seattleix.net/participants/switches/SIX_7508E.txt&quot;&gt;that list&lt;/a&gt; of 
the companies and providers who peer with them, including:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Amazon&lt;/li&gt;
  &lt;li&gt;Dropbox&lt;/li&gt;
  &lt;li&gt;Facebook&lt;/li&gt;
  &lt;li&gt;Google&lt;/li&gt;
  &lt;li&gt;GitHub&lt;/li&gt;
  &lt;li&gt;Microsoft&lt;/li&gt;
  &lt;li&gt;Netflix&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Having all the cloud computing providers close is great. Wave G / Spectrum is 
part of the SIX extension and has a 100 Gbps port between its network and SIX, 
&lt;a href=&quot;https://twitter.com/jwvo/status/986104140307750912&quot;&gt;soon to be more&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If I &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;traceroute&lt;/code&gt; from my home to a VM I have in Azure, I see just a hops,
each a millisecond or two at most:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;My UniFi router&lt;/li&gt;
  &lt;li&gt;My building’s router&lt;/li&gt;
  &lt;li&gt;Wave G / Spectrum network&lt;/li&gt;
  &lt;li&gt;Seattle Internet Exchange router&lt;/li&gt;
  &lt;li&gt;Microsoft’s network edge at the Seattle Internet Exchange&lt;/li&gt;
  &lt;li&gt;A few hops around Microsoft&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;If I trace the route to Google, they peer directly with Spectrum, so it’s even
fewer hops to them (8 hops from my PC to 8.8.8.8).&lt;/p&gt;

&lt;!-- ---------------- UBIQUITI ---------------- --&gt;

&lt;h1 id=&quot;ubiquiti-unifi&quot;&gt;Ubiquiti UniFi&lt;/h1&gt;

&lt;p&gt;With a very fast Internet connection comes the responsibility of managing your
home network with a mind toward simplicity, performance, and awesomeness.&lt;/p&gt;

&lt;p&gt;While many customers of CondoInternet enjoy the typical consumer gear - Asus,
Linksys, Apple - it makes sense to invest in business-grade equipment that
will last longer, offer advanced features, and be able to move as many packets
as possible.&lt;/p&gt;

&lt;p&gt;I invested in a set of Ubiquiti Networks gear in 2016 after deciding I had had 
enough with consumer WiFi equipment. I had a decent Cisco managed switch sitting 
behind an Asus router, and an Apple AirPort Extreme acting as an additional AP. 
Nothing fit together, I had to reboot the router constantly, and I knew there 
had to be something better out there.&lt;/p&gt;

&lt;p&gt;While I first adopted their EdgeRouter PoE device, and appreciated its declarative 
configuration story, I found myself wanting the integrated experience and dashboards 
that the Ubiquiti &lt;a href=&quot;https://unifi-sdn.ubnt.com/&quot;&gt;UniFi line of enterprise WiFi systems”&lt;/a&gt;
had.&lt;/p&gt;

&lt;p&gt;Today my home network is built from:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;UniFi Security Gateway Pro&lt;/li&gt;
  &lt;li&gt;UniFi 24-port 250W PoE switch&lt;/li&gt;
  &lt;li&gt;2x UniFi UAP AC-HD Access Points&lt;/li&gt;
  &lt;li&gt;UniFi 8-port PoE switch&lt;/li&gt;
  &lt;li&gt;UniFi CloudKey&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With 2 years of experience with UniFi, I must say, I am a very happy customer, as
evidenced by the build-outs I’ve done in my unit, in my building at large,
convinced friends to do, and yes, my Twitter feed. I love their stuff!&lt;/p&gt;

&lt;p&gt;I enjoyed reading &lt;a href=&quot;https://www.troyhunt.com/ubiquiti-all-the-things-how-i-finally-fixed-my-dodgy-wifi/&quot;&gt;Troy Hunt’s post&lt;/a&gt;;
also, a shoutout to &lt;a href=&quot;https://twitter.com/ClintRutkas&quot;&gt;Clint Rutkas&lt;/a&gt; for sharing his
experience - he embarked on a similar journey around the same time as I did,
and I know many of my coworkers at Microsoft also have great Ubiquiti experiences.&lt;/p&gt;

&lt;p&gt;I absolutely love the advanced features that Ubiquiti offers at in easy-to-use manner. From
VLAN tagging to multiple wireless networks, guest network features and advanced
connectivity options, its all there.&lt;/p&gt;

&lt;p&gt;So, what are some of the components, features, and so on?&lt;/p&gt;

&lt;h2 id=&quot;rackmount&quot;&gt;Rackmount&lt;/h2&gt;

&lt;p&gt;A favorite of mine is that the UniFi line has a silver distinctive finish that 
looks great in a home media rack.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/2018-rack.jpg&quot; class=&quot;img-responsive&quot; title=&quot;My home media rack, including a UniFi Security Gateway Pro, UniFi 24-port PoE switch, a Synology storage device, and an Xbox One&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While the Security Gateway Pro router that I have is rackmount-only, the 
Security Gateway model does a great job for home use and is tiny, like a simple 
network switch.&lt;/p&gt;

&lt;p&gt;The UniFi 8-port switches are desktop friendly, and with the 16-port switches 
you have a choice of included rack ears for mounting or keeping it on a shelf 
or desktop. The 24+ switches are rackmount only.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/updated-home-network-rack.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;
&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/rackview.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;
&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/rack-with-sgpro.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;h2 id=&quot;unifi-cloudkey-controller&quot;&gt;UniFi CloudKey Controller&lt;/h2&gt;

&lt;p&gt;All of your UniFi equipment’s managed through the central UniFi controller. 
While you could install the controller software on a notebook or a
server, the best route to go is to pick up the UniFi CloudKey - that way you 
can avoid having to install the Java runtime. The CloudKey
has the controller installed on it and then you can access the management
website from anywhere.&lt;/p&gt;

&lt;p&gt;Instead of independently configuring your router’s via its IP address and its
portal, then the same for your managed switches, everything is consistent in
the controller.&lt;/p&gt;

&lt;p&gt;Think of the CloudKey as the best $100 investment in the UniFi lineup, saving 
you from Java. It’s a nice, small PoE-powered Raspberry Pi-like server. Here 
is the key attached to a simple rack tray.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/cloudkeytray1.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A CloudKey controller attached to a rack tray, providing UniFi Controller services to manage the network&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here’s a look at the home screen in the controller, where you can see overall
site status, stats on connected devices, throughput.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-overview-home.png&quot; class=&quot;img-responsive&quot; title=&quot;Accessible from anywhere online, the UniFi controller software provides a simple, clean interface that lets you manage the family of network devices from a central place.&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;devices-view&quot;&gt;Devices view&lt;/h3&gt;

&lt;p&gt;All of the UniFi network devices that are a part of your network site appear within
the ‘Devices’ page.&lt;/p&gt;

&lt;h4 id=&quot;device-adoption&quot;&gt;Device adoption&lt;/h4&gt;

&lt;p&gt;New devices need to be “adopted” into your managed network.  In this “devices”
view of my home UniFi network, you can see:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;My USG Security Gateway Pro (router)&lt;/li&gt;
  &lt;li&gt;Multiple UniFi managed switches&lt;/li&gt;
  &lt;li&gt;An access point&lt;/li&gt;
  &lt;li&gt;A new UniFi AP AC-HD access point that is ready to be adopted&lt;/li&gt;
  &lt;li&gt;A disconnected/disabled device - an old access point (that I was replacing in this screenshot)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-device-adoption-screen.png&quot; class=&quot;img-responsive&quot; title=&quot;When you connect a new UniFi device to your local network, you 'adopt' the device through the controller, at which point you can configure and control it. You can also see devices that are disabled or not currently connected, but that have been adopted.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here’s my condo building’s security camera and office network - it has more devices, and I’ve
opened up the details for one of the PoE switches in this view.&lt;/p&gt;

&lt;p&gt;For each connected port, you get high-level status, information about whether it is powered
by PoE, and then a summary for the device - stats including how long it’s been up, what version
of the UniFi firmware it is running, overall power consumption and temperature.&lt;/p&gt;

&lt;h4 id=&quot;wan-config&quot;&gt;WAN config&lt;/h4&gt;

&lt;p&gt;The security gateway can be configured with multiple WAN connections, in case 
you need redundant providers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-sg-home.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; style=&quot;max-width:480px&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;configuring-a-switch&quot;&gt;Configuring a switch&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-devices-building.png&quot; class=&quot;img-responsive&quot; title=&quot;In the Devices view, you see all the Ubiquiti UniFi equipment you have such as access points, the router, and managed switches. This view is from a larger network deployment for our condo building common areas and staff use.&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;access-point-properties&quot;&gt;Access point properties&lt;/h4&gt;

&lt;p&gt;For each access point you can configure the various wireless networks that 
should be broadcast by the AP, radio settings, and get an idea of the RF 
utilization near the device.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-rf-utilized.png&quot; class=&quot;img-responsive&quot; title=&quot;Access point properties and RF utilization information&quot; style=&quot;max-width:420px&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;clients-view&quot;&gt;Clients view&lt;/h3&gt;

&lt;p&gt;Within the controller you can drill down into the client view that shows you
individual devices that have connected.&lt;/p&gt;

&lt;p&gt;For each device you can learn how it is connected to the network, whether a switch
port or a specific wireless network, its current activity level and stats, and how
long it has been on the network.&lt;/p&gt;

&lt;p&gt;You can filter and sort the view by type of connection or other properties.&lt;/p&gt;

&lt;p&gt;You can also manually add clients or view all configured clients if you are managing
devices that have static IPs, specific tags or properties, but are currently not
connected.&lt;/p&gt;

&lt;p&gt;This view is of the clients connected to my condo building’s private network (this is
not my home network). It has more clients connected so looks more interesting.&lt;/p&gt;

&lt;p&gt;On the right side, there’s a panel open taking a look at one of the UniFi PoE switches
on the network and also one of the access points - you can have multiple configuration
panels open at once to maintain your productivity in managing the site.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-clients-building.png&quot; class=&quot;img-responsive&quot; title=&quot;The  clients view shows all of the connected devices, high-level stats, current activity, and the ability to configure, tag and customize connections for that client.&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;events&quot;&gt;Events&lt;/h3&gt;

&lt;p&gt;A rolling stream of events can be accessed within the UniFi Controller, and I also have these events
streamed to a remote syslog server running on my network-attached storage server.&lt;/p&gt;

&lt;p&gt;It’s especially interesting to watch access points that experience interference and need to switch
channels and watch clients come and go.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-events-building.png&quot; class=&quot;img-responsive&quot; title=&quot;Events such as interference on wireless channels, administrators signing into the controller, PoE devices coming online, and new clients are all shown in this area. I also pipe all of these events to my network attached storage.&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;topology&quot;&gt;Topology&lt;/h3&gt;

&lt;p&gt;While my home network is rather simple - a router, a primary switch, two access
points and a switch under my desk, the topology view for the UniFi network is
super interesting and helpful when building out larger networks.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-topology-home-simple.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By being able to visualize the network, understand which ports are uplinks and
downlinks, the channels in use by various access points, all in one place is
super.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-topology-home.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-topology-building.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can toggle link labels and clients on/off.&lt;/p&gt;

&lt;h3 id=&quot;switch-stats&quot;&gt;Switch stats&lt;/h3&gt;

&lt;p&gt;Similar to the topology view, there are multiple ways to dig through the
data regarding your switch ports. In the Switch Stats view you can see aggregate 
stats for individual ports over time, the name and type of connection for the 
client connected to a port, etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-switchstats-graphs-home.png&quot; class=&quot;img-responsive&quot; title=&quot;The switch stats view helps show per-port aggregated stats and other information, such as the name of the connected client&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For any individual switch, you can always see the summary of its ports and types 
of connections from any part of the UniFi UI.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-switch-view-southb.png&quot; class=&quot;img-responsive&quot; style=&quot;max-width:420px&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;vpn&quot;&gt;VPN&lt;/h3&gt;

&lt;p&gt;Lots of great VPN support is of course built into the UniFi Security Gateway.&lt;/p&gt;

&lt;h4 id=&quot;remote-vpn&quot;&gt;Remote VPN&lt;/h4&gt;

&lt;p&gt;Being able to remotely connect via L2TP is nice to let me get to my home 
network and its devices from anywhere in the world, whether that’s my iPhone,
a notebook computer somewhere, etc.&lt;/p&gt;

&lt;p&gt;It’s easy to setup and configure, and the latest release of the UniFi controller 
software has a built-in RADIUS server - so for me, I’ve found it even easier 
than before, when I used to run a RADIUS server on my network storage server instead.&lt;/p&gt;

&lt;h4 id=&quot;site-to-site-vpn&quot;&gt;Site-to-site VPN&lt;/h4&gt;

&lt;p&gt;Although I no longer utilize it, I used to run an Azure site-to-site VPN 
connection between my local network and my personal vnet in the cloud. This
made it super simple to connect to and debug a Kubernetes cluster I was
experimenting with.&lt;/p&gt;

&lt;h4 id=&quot;virtual-lans&quot;&gt;Virtual LANs&lt;/h4&gt;

&lt;p&gt;I make use of VLAN tagging to keep my guest network separate from my primary 
network, and also to separate most of my “Internet of Things” connections from 
my other gear.&lt;/p&gt;

&lt;h2 id=&quot;unifi-access-points&quot;&gt;UniFi Access Points&lt;/h2&gt;

&lt;p&gt;Power over Ethernet makes it super simple to add access points exactly where
you want them, instead of where it’s close to your Internet router or cable
modem.&lt;/p&gt;

&lt;p&gt;The only job of an AP is to make wireless happen; being able to offload that
from the router makes diagnostics easier.&lt;/p&gt;

&lt;p&gt;Here’s one of the access points I’ve installed along an edge of a kitchen living
area. Plenum CAT6 runs through the soffit to where the access point is mounted
on the wall.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ubnt-wifi-hallway.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A UniFi access point is wall mounted above a hallway&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In a bedroom, I have installed another access point.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ubnt-wifi-bedroom.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A UniFi access point mounted alongside a bedroom wall&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;wall-or-ceiling-mount&quot;&gt;Wall or ceiling mount&lt;/h3&gt;

&lt;p&gt;UniFi Access Points (UAP) are easy to mount to the wall or ceiling.&lt;/p&gt;

&lt;p&gt;While I would love to have this mounted on the ceiling for the best reception
and range, my ceiling is concrete, so no options there without running exposed
CAT6 or conduit along the ceiling.&lt;/p&gt;

&lt;p&gt;While you could mount the access point around a low voltage old work box or
near a CAT6 keystone, I’ve chosen to keep a service loop of CAT6 in the wall
and then simply attached a CAT6 end that I’ve poked through the wall.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ubnt-uap-wall-install.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Wall mounting an access point&quot; style=&quot;max-width:500px&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The access point rotates onto the base frame, and to remove it, you can use a
paperclip or removal tool to wedge tab and allow you to rotate the AP.&lt;/p&gt;

&lt;h3 id=&quot;led-indicator-light&quot;&gt;LED indicator light&lt;/h3&gt;

&lt;p&gt;At the site-wide level you can toggle LED indicator lights on and off, and then
per Ubiquiti device, you can configure whether to override that setting by
forcing the LED on or off.&lt;/p&gt;

&lt;p&gt;The soft blue glow when the access point may be nice in a business setting or
a living room to indicate that the connectivity is good, but I have chosen to
turn off the glow in my other location in a bedroom.&lt;/p&gt;

&lt;p&gt;The indicator light can also illuminate in different colors and patterns if
it is upgrading firmware, having connectivity issues, etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ubnt-uap-blue-night.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A soft blue glow indicates that the access point is powered, connected and healthy&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;pro-mounting-system&quot;&gt;Pro mounting system&lt;/h3&gt;

&lt;p&gt;While installing some access points in shared community areas of my condo
building, I discovered the &lt;a href=&quot;https://store.ubnt.com/products/unifi-professional-mounting-plate&quot;&gt;UniFi Professional Mounting System&lt;/a&gt;
which is a $9 precision-crafted bracket.&lt;/p&gt;

&lt;p&gt;We’ve used this system in our parking garage to easily mount to j-boxes on
the ceiling.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-pro-kit.jpg&quot; class=&quot;img-responsive&quot; title=&quot;The pro mounting kit, useful in commercial or business environments&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;In the above photo, on the left: the bracket mounted to a 4”x4” square junction
box. Flexible conduit attaches to the j-box and CAT6 runs through it into the box
and then through the hole to be plugged into the AP. On the right, the access
point once mounted and powered up via PoE with its signature blue glow.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The brackets are a fair value and have holes for traditional wall mount, 
T-bar ceiling mounts (common commercial drop ceilings), 3.5” round j-boxes, 
4” square j-boxes, 1-gang outlet boxes, 4” round j-boxes, and European outlet 
boxes.&lt;/p&gt;

&lt;h3 id=&quot;configuring-wifi-networks&quot;&gt;Configuring WiFi networks&lt;/h3&gt;

&lt;p&gt;You can configure several WiFi networks, for your corporate or private use, 
guests, and other purposes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-wireless-networks.png&quot; class=&quot;img-responsive&quot; title=&quot;The controller configuration screen&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With VLAN tagging, the ability to configure different auth profiles, you can 
setup a more advanced RADIUS-backed network for yourself, then let everyone 
else use a more general traffic network when they visit.&lt;/p&gt;

&lt;p&gt;While I don’t use the guest portal features, there’s a whole system to setup 
accepting payments, generating use tokens, etc., if you feel the urge to 
start a cybercafe.&lt;/p&gt;

&lt;h3 id=&quot;neighboring-access-point-data&quot;&gt;Neighboring access point data&lt;/h3&gt;

&lt;p&gt;One of the unfortunate side effects of living in the city is that you are
competing with hundreds of other access points, wireless devices, even radar.&lt;/p&gt;

&lt;p&gt;If I open my Mac and try and pick a wireless connection, there are hundreds to
scroll through.&lt;/p&gt;

&lt;p&gt;The UniFi controller is also always collecting data on neighboring access points. In
the past they called this the “Rogue AP report”, but it was renamed.&lt;/p&gt;

&lt;p&gt;I could imagine a business using this to keep tabs on whether people are bringing
their own wireless access points or routers into the corporate environment,
but in a city, it’s mostly interesting to just get a bird’s eye view of how
much connectivity is around.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-neighboring-access-points-home.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I regularly see 200-300 access points listed in this report.&lt;/p&gt;

&lt;h2 id=&quot;rf-environment&quot;&gt;RF environment&lt;/h2&gt;

&lt;p&gt;If you are OK to take an access point offline for a few minutes, UniFi APs are
able to perform a scan of the 2G and 5G wireless utilization around that access
point. This can be very helpful in planning how to allocate channels and
diagnose performance issues.&lt;/p&gt;

&lt;p&gt;Here’s a side-by-side of the 2G and 5G environment in my main living area. The
2G wireless spectrum is almost entirely bogged down by all of the competing
devices, but the 5G channels are much more readily available.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-wireless-rf-environment.png&quot; class=&quot;img-responsive&quot; title=&quot;A screenshot after performing radio frequency (RF) scans of both the 2.4GHz and 5GHz spectrum near one of my access points. Lots of contention in the 2G space.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I must use 5GHz wireless devices as much as possible!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/living-room-problem-connection.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;uap-ac-hd-upgrade&quot;&gt;UAP AC-HD Upgrade&lt;/h2&gt;

&lt;p&gt;In late 2017 I moved to the &lt;a href=&quot;https://unifi-hd.ubnt.com/&quot;&gt;UAP AC-HD&lt;/a&gt;
and have been very happy with this beefier 
access point. A swap-in replacement for the UAP AC Pro, it can reuse the pro’s 
mounting bracket, making it a very quick swap out.&lt;/p&gt;

&lt;p&gt;The HD access points are 802.11ac Wave 2 MU‑MIMO (Multi‑User, Multiple Input, Multiple Output) 
devices, designed to support tons of clients. For me, I believe this helps me 
better cut through the noise and still get decent performance in the 
interference-ridden city.&lt;/p&gt;

&lt;p&gt;Comparing specs, the pro has a radio rate 450 Mbps (2.4 GHz) and 1300 Mbps (5 GHz), 
the HD has respective rates of 800 Mbps and 1733 Mbps max.&lt;/p&gt;

&lt;p&gt;The units are physically larger; here’s an overhead shot of the UAP AC HD on the 
left of the previous UAP AC Pro model.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-hd-pro-overhead.jpg&quot; class=&quot;img-responsive&quot; title=&quot;An overhead look at the UniFi UAP AC Pro next to the beefier UAP AC HD.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And a side view shows that the AC HD does protrude more from the mounting surface.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-hd-pro-side-by-side.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A side view of the UniFi UAP AC Pro next to the beefier UAP AC HD.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After upgrading to the UAP AC-HD, I’m able to get 400 Mbps+ from my wireless devices,
where before I was more often in the 140 Mbps range.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/wireless-speed-testing.png&quot; class=&quot;img-responsive&quot; title=&quot;Over WiFi, a speed test showing download speeds of 423 Mbp and upload of 474 Mbps with the UAP AC-HD&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Getting 400+ up an down over WiFi is quite an accomplishment for me, with all
the interference in the city, this is about the most that I’ve ever been able
to maintain beyond the wired network.&lt;/p&gt;

&lt;h2 id=&quot;unifi-deep-packet-inspection&quot;&gt;UniFi deep packet inspection&lt;/h2&gt;

&lt;p&gt;If you turn deep packet inspection (DPI) on, you begin to collect statistics 
and all sorts of interesting information about how your WAN connection is being
used by clients.&lt;/p&gt;

&lt;p&gt;At a high level, in aggregate, you’ll be able to learn where your household 
or business spends a lot of time, and at the individual client connection level, 
you can get summary stats there, too.&lt;/p&gt;

&lt;p&gt;Since many web sites and services are encrypted these days (a good thing!), you 
end up with some easily identified sources of data and then a lot falls by the 
wayside… most sites are just “encrypted”, and then the really big cloud 
services and streaming services I think are identified by IP range/bucket:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;406 GB of HTTP over TLS (encrypted web traffic, could be nearly any site)&lt;/li&gt;
  &lt;li&gt;216 GB of HBO streaming&lt;/li&gt;
  &lt;li&gt;193 GB of Netflix&lt;/li&gt;
  &lt;li&gt;130 GB of SSL/TLS&lt;/li&gt;
  &lt;li&gt;51 GB of YouTube&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-traffic-home.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If I select a client from the clients view, like my Apple TV, I can then see
its individualized totals…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-clients-home-plus-dpi-apple-tv.png&quot; class=&quot;img-responsive&quot; title=&quot;In this screenshot, I've selected my Apple TV client entry. The Deep Pack Inspection experience lets me see a summary of the services that the client has been using. Looks like we use most of our media streaming bandwidth on HBO Now, Netflix, etc.&quot; /&gt;&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-dpi-my-phone.png&quot;
style=&quot;max-width: 320px&quot;
class=&quot;img-responsive&quot;
     title=&quot;The DPI view for my iPhone shows details about how I use my phone on the home network.&quot; /&gt;
--&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-traffic-building.png&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;h2 id=&quot;fan-noise&quot;&gt;Fan noise&lt;/h2&gt;

&lt;p&gt;The higher-end PoE and security gateway products are not quiet. They aren’t
really designed for my use case - home office, media cabinet.&lt;/p&gt;

&lt;p&gt;If sound is an issue, do note that the 8-port PoE switch would be a great 
product to buy if you want quiet, and the standard Security Gateway is very 
nice, too.&lt;/p&gt;

&lt;p&gt;I replaced the Ubiquiti stock fans with Noctua’s quiet fans. It’s very quiet
now, though my warranty is probably void.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/unifi-fan-modification.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Noctua replacement fans I have put in the security gateway device.&quot; /&gt;&lt;/p&gt;

&lt;!-- ---------------- CONDO WIRING ---------------- --&gt;

&lt;h1 id=&quot;condo-wiring&quot;&gt;Condo wiring&lt;/h1&gt;

&lt;p&gt;Many condos today are built with at least a modern Ethernet network in mind, so 
when they pull coax to the media jacks in the unit, they also pull CAT5e or CAT6.&lt;/p&gt;

&lt;p&gt;These then terminate in a structured media cabinet (SMC) enclosure embedded in a 
wall. Usually made by Leviton, they tend to be in an office or by the electrical 
panel.&lt;/p&gt;

&lt;p&gt;Here’s one from a condo I used to live in at Hotel 1000 / Madison Tower in 
Seattle. Pretty good work was done, and I was able to add a CAT6 patch panel to 
the SMC to easily build a wired network in that unit. The SMC has:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A simple map of the unit and the jack identifiers&lt;/li&gt;
  &lt;li&gt;CAT5e punch-down block&lt;/li&gt;
  &lt;li&gt;Simple switch for the VOIP phone system&lt;/li&gt;
  &lt;li&gt;Unterminated coax running to all the wall plates&lt;/li&gt;
  &lt;li&gt;Terminated CAT5e (though not patched to wall jacks)&lt;/li&gt;
  &lt;li&gt;Home runs from the various providers&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/leviton-in-wall.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A Leviton SMC with unterminated and terminated cables including network and coax, VOIP switch, etc.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The building I live in was built in 2003, a time when CAT5 or CAT5e would be 
an entirely common cabling choice, but … yeah, I wasn’t so lucky. While I was 
aware of this before closing my real estate transaction, this isn’t the sort of 
thing that is a deal breaker.&lt;/p&gt;

&lt;p&gt;Even worse than not having an SMC were 2 other things: the home run to my unit 
was not modern network cable, and also that the units in my building were 
not built with network drops running throughout the units!&lt;/p&gt;

&lt;h2 id=&quot;office-rack&quot;&gt;Office rack&lt;/h2&gt;

&lt;p&gt;My network terminates in the office/media closet: a simple small rack that
houses the UniFi network equipment, UPS, storage, media and IoT systems.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/office-rack6.jpg&quot; class=&quot;img-responsive&quot; title=&quot;In the office closet is a simple small rack with the network equipment, 3-zone media receiver, and other devices like an Xbox One and an Apple TV&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The CAT6 I’ve pulled through my walls terminates into keystone jacks along the 
closet ceiling, and then patch cables connect to the switch.&lt;/p&gt;

&lt;p&gt;This was different than a more traditional commercial termination where you 
might bring the network bundles together to a patch panel in the rack itself.
This way, if and when I move out, the keystone jacks will be able to stay as-is.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/closet-running-cat6.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A photo from the process of running wire down to the rack during installation&quot; style=&quot;max-width: 420px&quot; /&gt;
--&gt;

&lt;p&gt;Getting here took a lot of time and effort…&lt;/p&gt;

&lt;h2 id=&quot;cat3&quot;&gt;CAT3&lt;/h2&gt;

&lt;p&gt;My building’s developer was cheap, and unfortunately that means that we were 
cursed with &lt;em&gt;Category 3&lt;/em&gt; (CAT3) cable daisy-chained throughout the individual 
unit, running all the way from the telecommunication room through to the last 
RJ11 jack in the unit after being terminated at 5 wall plates along the way.&lt;/p&gt;

&lt;p&gt;Not knowing the intentions of the developer, my guess is that they saw CAT3 as 
a great way to save money when building out 200 units… while our original 
building electrical plan includes reference to structured media centers and 
network cable, all we got was CAT3.&lt;/p&gt;

&lt;p&gt;What’s CAT3? &lt;a href=&quot;https://en.wikipedia.org/wiki/Category_3_cable&quot;&gt;According to wikipedia&lt;/a&gt;, it “was widely
used in computer networking in the early 1990s for 10BASE-T Ethernet”.&lt;/p&gt;

&lt;p&gt;My building used 6-pair CAT3 (12 conductors), the idea being that it was a 
compromise: you could offer a 10/100 network potentially alongside traditional 
telephone service on the same cable.&lt;/p&gt;

&lt;h2 id=&quot;home-run-risky-to-replace&quot;&gt;Home run: risky to replace&lt;/h2&gt;

&lt;p&gt;A conundrum with the CAT3 run between my unit and the IDF runs 
through 1/4” flex conduit that’s embedded in the concrete slab of the ceiling. 
It isn’t an entirely straight shot.&lt;/p&gt;

&lt;p&gt;While it does have a pull string, preliminary testing and planning to replace 
the CAT3 with 2x CAT6 cables indicates that there may be snags or other 
obstacles in the conduit.&lt;/p&gt;

&lt;p&gt;The risk: trying to replace the CAT3 could risk being left without phone or 
Internet service to the unit. The decision was to not try and replace it at all.&lt;/p&gt;

&lt;h2 id=&quot;cat3-terminating-daisy-chain&quot;&gt;CAT3: Terminating daisy chain&lt;/h2&gt;

&lt;p&gt;For units in my building, the daisy chain design means that at most you can 
punch down a single network jack in the unit, and in the name of not making 
large alterations to units, this means that when Condo Internet first came by 
to install their service for a previous owner of my unit, they punched down 
the jack without terminating the CAT3 cable there…&lt;/p&gt;

&lt;p&gt;As a result, by my estimates after poking around inside the walls, the length 
of the CAT3 wire being used was:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;60 feet from the IDF to the conduit termination in the ceiling above my kitchen&lt;/li&gt;
  &lt;li&gt;15 feet from the conduit to a blank wall plate and junction box in a closet&lt;/li&gt;
  &lt;li&gt;300 feet from the j-box past 4 RJ11 jacks and a few rooms&lt;/li&gt;
  &lt;li&gt;The office Ethernet jack&lt;/li&gt;
  &lt;li&gt;150 feet of additional cable past 2 RJ11 jacks&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This means an effective cable distance of 525 feet, likely leading to cross-talk or 
general signal degradation. Higher-grade CAT6 spec cable should only be 
run 328 ft. (100 m).&lt;/p&gt;

&lt;p&gt;My link was therefore negotiating to 100 Mbps full duplex. Not horrible, but 
also not 1000 Mbps, and not as future-friendly.&lt;/p&gt;

&lt;p&gt;I went into experimentation mode and tested punching down network jacks at all 
the RJ11 jacks in the unit to see what my network test equipment would say for 
distance, as well as the negotiated link quality with Condo Internet, and nothing 
improved much.&lt;/p&gt;

&lt;p&gt;This is not your standard T56B coloring, by the way, since the 
orange and blue pairs are used for POTS.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/cat3-jack.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Connecting to CAT3 - note the conductor colors, not traditional T56B&quot; style=&quot;max-width: 420px&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At one of the closer jacks in terms of cable distance, I finally was able to 
get a full duplex 1000 Mbps connection negotiated, but then the connection was 
rather poor: speed test results around 200 Mbps, lots of dropped packets, etc.&lt;/p&gt;

&lt;p&gt;Back at the original blank wall plate (where a structured media cabinet really 
should’ve been), I decided to clip and terminate the 4 pairs of network wire 
right there.&lt;/p&gt;

&lt;p&gt;While not clean, you’ll see that this 2-gang junction box is stuffed with the 
coax splitter and cables, CAT3 cable, and now I’ve added to it keystone jacks 
for CAT6 I later pulled. This lets me tap into whichever segment I need.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/cat6-cat3-wall-mess3.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; style=&quot;max-width: 420px&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I connected my Asus router I was using as a test, turned it on, and was 
happy to discover a 1000 Mbps full duplex gigabit connection to Condo Internet, 
yielding speed tests over 900 Mbps up and down. Low latency. No dropped packets. 
Hooray! Good outcome.&lt;/p&gt;

&lt;h2 id=&quot;pulling-cat6-in-unit&quot;&gt;Pulling CAT6 in-unit&lt;/h2&gt;

&lt;p&gt;While I wouldn’t be able to replace the home run CAT3 to my unit easily, I did 
decide that having a wired network is very important to my home network 
configuration.&lt;/p&gt;

&lt;p&gt;I wanted to be able to install a small rack as a media closet, and that was 
located 80 feet away from the termination point. I also wanted to hardwire my 
office computers, pull CAT6 to the television mounts to do HDMI-over-HDBase, etc.&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/cat6-splicing.jpg&quot; class=&quot;img-responsive&quot; title=&quot;CAT6 keystone punchdown&quot; /&gt;
--&gt;

&lt;p&gt;In the end I pulled over 2,400 feet of CAT6 throughout my condo and was able to 
bring online 20 CAT6 jacks.&lt;/p&gt;

&lt;h2 id=&quot;steel-studs&quot;&gt;Steel studs&lt;/h2&gt;

&lt;p&gt;My condo does not have wood studs, but instead steel, supporting the walls.&lt;/p&gt;

&lt;p&gt;Metal studs are perforated already with holes for wires to be pulled through, 
as long as you remember to use wire grommits to protect from fraying and damaging 
the wire.&lt;/p&gt;

&lt;p&gt;A positive for metal studs is that there’s no drilling through wood fire blocks 
or studs themselves, as long as you can carefully fish wire through the 
existing wire holes.&lt;/p&gt;

&lt;h2 id=&quot;interior-vs-exterior-walls&quot;&gt;Interior vs exterior walls&lt;/h2&gt;

&lt;p&gt;Our condo association rules are well-defined and strict about any changes to 
“limited common” shared walls. While it’s easy to run wires within my interior 
walls, I’m not able to just run cable through the shared walls, and instead 
would need to use exposed concrete, wire behind the baseboards, or under the 
floors. I’ve had to use all of these approaches in my unit.&lt;/p&gt;

&lt;p&gt;In my office I run speaker wire, several CAT6 pulls, and 2x digital optical 
audio cables through the floor instead of the shared wall with an adjacent 
unit.&lt;/p&gt;

&lt;h3 id=&quot;drop-ceilings&quot;&gt;Drop ceilings&lt;/h3&gt;

&lt;p&gt;Thankfully my unit’s utilities tend to run in the ceiling above the kitchen, 
bathrooms and other spaces. The living areas have no drop ceiling, so there is 
only concrete above, leaving no wiring space.&lt;/p&gt;

&lt;p&gt;Here’s a look inside the ceiling above a bathroom - lots of electrical 
steel conduit.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/electrical-in-ceiling.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A peek inside the ceiling above a bathroom at the electrical flex conduit&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Challenges include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Not running network cable parallel to electrical when close&lt;/li&gt;
  &lt;li&gt;Pulling conduit and wire with minimal wall damage and patching&lt;/li&gt;
  &lt;li&gt;Navigating obstacles including fire systems and forced air ducts&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In several locations I decided to run flex conduit to make pulling wire later 
easier, and then have both CAT6 and speaker wire running inside. Here you 
can see a flex conduit coupling, ductwork, sprinker system water pipes, and 
the hot and cold water pipes running above the kitchen cabinets:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ceiling-running-cables.jpg&quot; class=&quot;img-responsive&quot; title=&quot;Running conduit and cabling in the ceiling above the kitchen cabinets&quot; style=&quot;max-width: 420px&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Old work low voltage boxes are used where CAT6 terminates in closets, along 
walls and other locations. Besides the service loop with 2x CAT6 runs is also 
pull cord to make future changes easier.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/cat6-wiring-service-loop.jpg&quot; class=&quot;img-responsive&quot; title=&quot;A 2-gang old work low voltage opening with pull cord and CAT6&quot; style=&quot;max-width: 420px&quot; /&gt;&lt;/p&gt;

&lt;!--
&lt;img src=&quot;//az414997.vo.msecnd.net/waz/2018network/ubntuap.jpg&quot; class=&quot;img-responsive&quot; title=&quot;&quot; /&gt;
--&gt;

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;

&lt;p&gt;Some interesting resources I found while researching parts of this post:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;https://www.reddit.com/r/IAmA/comments/2m3awz/we_are_the_founders_of_condointernet_and_were/&lt;/li&gt;
  &lt;li&gt;http://www.bbpmag.com/2013mags/october/BBC_Oct13_CondoInternet.pdf&lt;/li&gt;
  &lt;li&gt;http://www.geekwire.com/2013/spectrum-wave-condointernet/&lt;/li&gt;
  &lt;li&gt;http://www.geekwire.com/2013/condointernet-expands-service-ballard/&lt;/li&gt;
  &lt;li&gt;http://www.bbpmag.com/2013mags/october/BBC_Oct13_CondoInternet.pdf&lt;/li&gt;
  &lt;li&gt;https://twitter.com/TimB0nd/status/985638564984573952&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Deploying Node.js apps in Azure App Service using private npm feeds from Visual Studio Team Services</title>
   <link href="http://www.jeff.wilcox.name/2017/02/azure-private-npm/"/>
   <updated>2017-02-28T00:00:00+00:00</updated>
   <id>http://www.jeff.wilcox.name/2017/02/azure-private-npm</id>
   <content type="html">&lt;p&gt;In this post I’m going to walk through using Visual Studio Team Services Package Management as a private npm
registry for scoped npm packages using a custom deployment script for Azure App
Service.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;2019 update: this content is no longer considered useful, accurate, or appropriate… there are newer Azure DevOps Pipelines features today that can update a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; file, etc.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Many Node.js developers are probably familiar with npm private feeds but may not have
used them yet in the Microsoft Cloud + Node.js stack. I wanted to share the experience that
I have had: my team is running a ton of small-to-medium Node.js services within Microsoft
and we’re eager to share our experiences for the good of the community.&lt;/p&gt;

&lt;p&gt;I’ll also show how my team is able to use Azure KeyVault at deployment time to
enable credential rotation without having to manage secrets at the individual app level.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vsts-new-package.PNG&quot; class=&quot;img-responsive&quot; title=&quot;The VSTS Package Management site&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;While this is a long post in explanation and detail, someone using App Service for their Node.js
deployments today should be able to connect to a private npm feed in about 15-30 minutes if they have
not yet adopted a custom deployment script. Of course KeyVault and other aspects could add time.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Let’s get started.&lt;/p&gt;

&lt;h1 id=&quot;private-npm-modules&quot;&gt;Private NPM modules&lt;/h1&gt;

&lt;p&gt;Node.js developers know that “there’s an npm module for nearly everything”, but it turns
out that sometimes you need to host your own private npm registry to store &lt;a href=&quot;https://docs.npmjs.com/private-modules/intro&quot;&gt;private modules&lt;/a&gt;
specific to your organization, policies or business rules, or to share custom code
amongst your internal projects.&lt;/p&gt;

&lt;p&gt;Common scenarios include corporate-specific Express middleware, private business
logic plugins to open source systems, supporting configuration-as-code,
and getting an npm module ready to ship to the world ahead of release.&lt;/p&gt;

&lt;h2 id=&quot;scoped-packages&quot;&gt;Scoped packages&lt;/h2&gt;

&lt;p&gt;When looking to use private npm registries, you’ll need to decide whether you
intend for the private npm registry to be the “primary” registry for all packages,
including popular packages you would otherwise get from the public registry -
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;express&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;moment&lt;/code&gt;, etc. - or if you want to use scoping.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.npmjs.com/misc/scope&quot;&gt;Scopes are built into npm&lt;/a&gt; and are the only native
way to support multiple registries. You can configure npm to visit a specific registry for a
given scope instead of the global registry.&lt;/p&gt;

&lt;p&gt;A downside to using scopes is that modules intending to go public will cause some churn in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;package.json&lt;/code&gt; files. A
private npm that uses a scope today but ships to the world tomorrow will likely lose or change its scope, requiring
you to edit your various package and source files.&lt;/p&gt;

&lt;p&gt;For this post I’m using a custom &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@jeffwilcox&lt;/code&gt; scope; within the Open Source Programs Office
at Microsoft we use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ospo&lt;/code&gt; scope, since that’s the short name we use for our team.&lt;/p&gt;

&lt;p&gt;Scopes are not unique to private repos. For example, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@microsoft&lt;/code&gt; scope is for
Microsoft open source npm modules that are shipping to the world.&lt;/p&gt;

&lt;h2 id=&quot;paid-npmjs&quot;&gt;Paid NPMJS&lt;/h2&gt;

&lt;p&gt;The official NPMJS registry sells private npm registry feeds for &lt;a href=&quot;https://www.npmjs.com/pricing&quot;&gt;$7/user/mo. or so&lt;/a&gt; and
this may be sufficient for many users.&lt;/p&gt;

&lt;p&gt;However, those using Visual Studio Team Services may want to use the great
package management integration and private feed support available in that product. On our
team we like that the private NPM feeds live alongside our source code in
VSTS, are contained, and the existing permission settings we use for the team just
work with the private feed.&lt;/p&gt;

&lt;h2 id=&quot;configuring-your-scoped-npm-environment&quot;&gt;Configuring your scoped npm environment&lt;/h2&gt;

&lt;p&gt;To enable private npm use you’ll need to login to npm (for the official private npm feed support) or
configure your Node environment to use a specific credential or credential helper (i.e. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; file
customizations).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;npm config set @YOUR_SCOPE:always-auth true
npm config set @YOUR_SCOPE:registry REGISTRY_URL_HERE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you didn’t want to use scoping but were replacing the entire npm environment, you would leave
off the scope part of the commands.&lt;/p&gt;

&lt;p&gt;For VSTS Package Management users on Windows, there is also a credential helper, but for the
deployment-focused purposes of this post, I am skipping that detail.&lt;/p&gt;

&lt;h3 id=&quot;deployment-environment&quot;&gt;Deployment environment&lt;/h3&gt;

&lt;p&gt;On a deployment or CI server, you will often need to commit a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; file directly into
your environment; while that is out of scope for this post, do note that such files can
use environment variable replacement:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//registry.npmjs.org/:_authToken=${NPM_TOKEN}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For this guide, I’m going to use a custom script to customize the Azure App Service
environment at deployment time to handle other scenarios including KeyVault. If you are
interested in simple CI/CD environments you can &lt;a href=&quot;https://docs.npmjs.com/private-modules/ci-server-config&quot;&gt;read about the scenarios at npmjs.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The custom script for this post is called &lt;a href=&quot;https://github.com/Microsoft/configure-azure-appservice-private-npm-feed&quot;&gt;configure-azure-appservice-private-npm-feed&lt;/a&gt;. Very exciting name.&lt;/p&gt;

&lt;h1 id=&quot;vsts-package-management&quot;&gt;VSTS Package Management&lt;/h1&gt;

&lt;p&gt;Visual Studio Team Services (VSTS), located at visualstudio.com, is a set of
clcoud-scale hosted Microsoft services for engineers to share code, track work, ship software, etc.
VSTS is fast, easy, and offers private source code hosting of Git repositories free for up to 5 users.&lt;/p&gt;

&lt;p&gt;Package Management is a VSTS add-on, available as an extension that can be licensed,
and today it provides both NuGet and npm private feed/registry hosting capabilities. Your VSTS
administrator needs to install the extension and make it available to you.&lt;/p&gt;

&lt;h2 id=&quot;adding-the-package-management-extension&quot;&gt;Adding the Package Management extension&lt;/h2&gt;

&lt;p&gt;VSTS administrators have an “extensions” menu under the project-wide settings.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/extensions-menu.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From the extensions page, you can then browse the VSTS extensions marketplace.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/extensions-marketplace.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Package Management is a key extension, you should be able to quickly locate it on one of the main pages
of the VSTS extensions marketplace.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vsts-package-management.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On the Package Management extension info page you can learn plenty more, but we are just interested in the “buy” button.
You can also start a 30-day trial easily.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vsts-buy.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The process will confirm your Azure subscription as part of the licensing process. It took me about 20 seconds to install.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vsts-buy2.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After installation, the &lt;em&gt;Build &amp;amp; Release&lt;/em&gt; menus within the project will light up with the new &lt;em&gt;Packages&lt;/em&gt; extension. Let’s go there now.&lt;/p&gt;

&lt;h2 id=&quot;creating-a-new-private-feed&quot;&gt;Creating a new private feed&lt;/h2&gt;

&lt;p&gt;From a project’s &lt;em&gt;Packages&lt;/em&gt; extension, you’ll find a mail delivery person character if you do not yet have any feeds.
Select “New feed”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vsts-new-package.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can then configure the feed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The name for the feed&lt;/li&gt;
  &lt;li&gt;Whether it will be open to your entire team, including who can publish to the feed&lt;/li&gt;
  &lt;li&gt;Whether to include upstream sources (only select this if you are intending to completely replace the npm registy)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/create-new-feed.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now we’re ready to go! We just need credentials to authorize our local NPM environment to be able to publish packages to the private feed hosted by VSTS.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/private-feed-ready.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;generating-an-access-token&quot;&gt;Generating an access token&lt;/h2&gt;

&lt;p&gt;From the private feed’s page within the &lt;em&gt;Packages&lt;/em&gt; extension, select “Connect to feed”. This
screen will share the basic &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; configuration settings that you will need to get to the
feed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The registry URL&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;always-auth&lt;/code&gt; flag that should be true for private feeds&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/connect-to-feed.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While there’s a command for Windows users to install the credential helper, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vsts-npm-auth&lt;/code&gt;,
for this blog post I’m just going to use the non-Windows token. Part of the reason - I use a
MacBook Pro most of the day, so I’m going to need that token - but we’ll also save it to use
with our deployment environment (though in a real prod scenario you will want to use a service
account to probably generate such a token).&lt;/p&gt;

&lt;p&gt;Select “Generate npm credentials” to get the non-Windows token.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/connect-to-feed-non-windows.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Make sure to safely and securely store the token from the generated &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; file. I
stored my token inside Azure KeyVault, since that is eventually where I will be grabbing
this token from in a more advanced, automated scenario.&lt;/p&gt;

&lt;h2 id=&quot;configuring-your-development-environment&quot;&gt;Configuring your development environment&lt;/h2&gt;

&lt;p&gt;If you are configuring for scoped private npm packages, here are the commands you will
want to enter.&lt;/p&gt;

&lt;p&gt;First, follow the instructions from the token generation to update your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; file with
the token for your private registry.&lt;/p&gt;

&lt;p&gt;Second, configure the user-global environment using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm&lt;/code&gt; (though you could also just edit the same rc):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ npm config set @jeffwilcox:always-auth true
$ npm config set @jeffwilcox:registry https://jeffwilcox.pkgs.visualstudio.com/_packaging/PrivateTeamFeed/registry
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While you can confirm your settings with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm config list&lt;/code&gt;, note that private feed tokens will &lt;em&gt;not&lt;/em&gt; be shown
in this view:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/npm-config-output.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;publishing-a-private-npm&quot;&gt;Publishing a private npm&lt;/h2&gt;

&lt;p&gt;It’s time to ship some private code!&lt;/p&gt;

&lt;p&gt;I’ve created a super simple npm module: a function that will return a string value when called to “prove” that it
came from the module. After creating this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.js&lt;/code&gt; file, I run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm init&lt;/code&gt; to create a new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;package.json&lt;/code&gt; file
in the folder, give the component a name and version, etc.&lt;/p&gt;

&lt;p&gt;Include the scope in the name; in my case this means my package name is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@jeffwilcox/private-npm-package&lt;/code&gt;. Here’s my
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;package.json&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  &quot;name&quot;: &quot;@jeffwilcox/private-npm-package&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;This is the best 1.0 package release ever&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;amp;&amp;amp; exit 1&quot;
  },
  &quot;author&quot;: &quot;Jeff Wilcox &amp;lt;...&amp;gt;&quot;,
  &quot;license&quot;: &quot;MIT&quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.js&lt;/code&gt; source file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'use strict';

module.exports = function () {
  return 'This is a private npm package';
};
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Time to publish! Since my token to publish and consume the private feed is in my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; environment,
I can simply publish and it’s good to go.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ npm publish
+ @jeffwilcox/private-npm-package@1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now I can go back to the Package Management extension within VSTS and refresh the feed to see my npm package.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/private-npm-feed-after-publish.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;VSTS provides some options including unpublishing and deprecating the package that will help in the
lifetime of the npm module.&lt;/p&gt;

&lt;h2 id=&quot;using-the-module-with-your-app&quot;&gt;Using the module with your app&lt;/h2&gt;

&lt;p&gt;I have a basic Express web app created using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;express-generator&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;npm install -g express-generator
...
express website
cd website
npm install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This generates a new folder called “website” that I can initialize as a Git repository to
deploy.&lt;/p&gt;

&lt;p&gt;Now I’m ready to use my private NPM module. Let’s install it, saving the module, too.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;npm install --save @jeffwilcox/private-npm-package
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then I should get confirmation that this package was installed OK:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;website@0.0.0 C:\local\website
`-- @jeffwilcox/private-npm-package@1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And to integrate with my private npm, this is what my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;./routes/index.js&lt;/code&gt; file ended up as; it will
set the title of the page, used by the view engine, to the value returned from the function exported
by my private npm:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'use strict';

const express = require('express');
const router = express.Router();

const privateNpmPackage = require('@jeffwilcox/private-npm-package');

router.get('/', (req, res, next) =&amp;gt; {
  const title = privateNpmPackage();
  res.render('index', { title: title });
});

module.exports = router;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I can now run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm start&lt;/code&gt; and navigate to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;localhost:3000&lt;/code&gt; to confirm that the app is working just fine.&lt;/p&gt;

&lt;h1 id=&quot;deploying-to-azure-app-service&quot;&gt;Deploying to Azure App Service&lt;/h1&gt;

&lt;h2 id=&quot;selecting-the-deployment-type&quot;&gt;Selecting the deployment type&lt;/h2&gt;

&lt;p&gt;Azure App Service really is my favorite way of hosting Node.js apps on Azure. It’s
so easy to configure the web site as a Git repository itself, or connect it to GitHub, or
use VSTS and its build system to deploy to the site.&lt;/p&gt;

&lt;p&gt;Here I am using the Git repository hosted by the App Service instance, meaning
when I push to the repo, I am literally pushing and deploying right then onto the app service’s
storage. The deployment experience will be echoed back to my Git client, making it easy to watch how
that goes.&lt;/p&gt;

&lt;p&gt;I do not want to commit my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;node_modules/&lt;/code&gt; folder, however, because packages change and take up
space that is not my code - I want to use npm to resolve those packages at runtime. So my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; has
the modules folder in it.&lt;/p&gt;

&lt;p&gt;After committing I add my Git remote as the origin of this repo and push:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git remote add origin https://jmwblog@privatefeed.scm.azurewebsites.net:443/privatefeed.git
$ git push origin master:master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Within Git’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stdout&lt;/code&gt;, since I am using an App Service-hosted deployment, I will
get updates about the deployment. If I had connected the service instead up to
GitHub or similar, I’d have to go to the “Deployment Options” part of the Azure
portal to see how it’s doing… but this is a _#fail# visual:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/npm-push-fail.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The deployment failed because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@jeffwilcox/private-npm-package&lt;/code&gt; scoped
npm module isn’t in the global npmjs registry.&lt;/p&gt;

&lt;p&gt;Because it’s a private module.&lt;/p&gt;

&lt;p&gt;And App Service does not have any idea about my scoped private registry nor what credential/token
it would even use to connect to it.&lt;/p&gt;

&lt;h2 id=&quot;deployment-scripts&quot;&gt;Deployment scripts&lt;/h2&gt;

&lt;h3 id=&quot;automatic-kudu-deployment-script&quot;&gt;Automatic Kudu deployment script&lt;/h3&gt;

&lt;p&gt;By default the Kudu engine used for deployments actually dynamically generates a
deployment script based on how it identifies your application. If it looks like your
code is a Node.js app, it will generate a pretty good default.&lt;/p&gt;

&lt;p&gt;You can retrieve the script that was generated for your environment by going to the
“Advanced Tools” part of the web site in the portal to open up the Kudu site
administrator tools where there’s an option to download the script to take a peek.
The script generator itself is open source, too.&lt;/p&gt;

&lt;h3 id=&quot;custom-deployment-scripts&quot;&gt;Custom deployment scripts&lt;/h3&gt;

&lt;p&gt;To enable private NPM feed use, I’m going to need to go ahead and &lt;a href=&quot;customize my deployment&quot;&gt;https://github.com/projectkudu/kudu/wiki/Customizing-deployments&lt;/a&gt; with
a custom &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;deploy.cmd&lt;/code&gt; script. I’ll fork this from the best-known current generated
version for Node.js apps, adding value where I need to.&lt;/p&gt;

&lt;p&gt;I first need to create a file called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.deployment&lt;/code&gt; and commit it to my repo. The content of
the file points the deployment engine at my custom deployment script:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[config]
command = deploy.cmd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is my “current favorite” deployment script, reproduced here for anyone to use,
with the caveat that this is not in source control. That’s another future blog post
I hope.&lt;/p&gt;

&lt;p&gt;This is for Node.js deployment and it does a few things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;It installs npm prod and development packages (since I want to use grunt and some other tools)&lt;/li&gt;
  &lt;li&gt;It uses my npm deployment script for private repos, described at the end of this post, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configure-azure-appservice-private-npm-feed&lt;/code&gt; to configure private npm feed support&lt;/li&gt;
  &lt;li&gt;If you have a Gruntfile it will grunt&lt;/li&gt;
  &lt;li&gt;If you have a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bower.json&lt;/code&gt; file it will install any bower dependencies&lt;/li&gt;
  &lt;li&gt;It installs npm packages &lt;em&gt;before&lt;/em&gt; copying over the actively deployed site&lt;/li&gt;
  &lt;li&gt;Yes it is a batch file, because 2017. You can also write a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;deploy.sh&lt;/code&gt; bash script.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The important step for this blog post is just that it installs the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm&lt;/code&gt; script I wrote and executes it before installing npm modules. This way, scoped private feeds are configured either through the environment and/or configuration before the npm modules are officially installed.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@if &quot;%SCM_TRACE_LEVEL%&quot; NEQ &quot;4&quot; @echo off

:: ----------------------
:: Forked from KUDU Deployment Script
:: Version: 1.0.6
:: ----------------------

:: Prerequisites
:: -------------

:: Verify node.js installed
where node 2&amp;gt;nul &amp;gt;nul
IF %ERRORLEVEL% NEQ 0 (
  echo Missing node.js executable, please install node.js, if already installed make sure it can be reached from current environment.
  goto error
)

:: Setup
:: -----

setlocal enabledelayedexpansion

SET ARTIFACTS=%~dp0%..\artifacts

IF NOT DEFINED DEPLOYMENT_SOURCE (
  SET DEPLOYMENT_SOURCE=%~dp0%.
)

IF NOT DEFINED DEPLOYMENT_TARGET (
  SET DEPLOYMENT_TARGET=%ARTIFACTS%\wwwroot
)

IF NOT DEFINED NEXT_MANIFEST_PATH (
  SET NEXT_MANIFEST_PATH=%ARTIFACTS%\manifest

  IF NOT DEFINED PREVIOUS_MANIFEST_PATH (
    SET PREVIOUS_MANIFEST_PATH=%ARTIFACTS%\manifest
  )
)

IF NOT DEFINED KUDU_SYNC_CMD (
  :: Install kudu sync
  echo Installing Kudu Sync
  call npm install kudusync -g --silent
  IF !ERRORLEVEL! NEQ 0 goto error

  :: Locally just running &quot;kuduSync&quot; would also work
  SET KUDU_SYNC_CMD=%appdata%\npm\kuduSync.cmd
)
goto Deployment

:: Utility Functions
:: -----------------

:SelectNodeVersion

IF DEFINED KUDU_SELECT_NODE_VERSION_CMD (
  :: The following are done only on Windows Azure Websites environment
  call %KUDU_SELECT_NODE_VERSION_CMD% &quot;%DEPLOYMENT_SOURCE%&quot; &quot;%DEPLOYMENT_TARGET%&quot; &quot;%DEPLOYMENT_TEMP%&quot;
  IF !ERRORLEVEL! NEQ 0 goto error

  IF EXIST &quot;%DEPLOYMENT_TEMP%\__nodeVersion.tmp&quot; (
    SET /p NODE_EXE=&amp;lt;&quot;%DEPLOYMENT_TEMP%\__nodeVersion.tmp&quot;
    IF !ERRORLEVEL! NEQ 0 goto error
  )

  IF EXIST &quot;%DEPLOYMENT_TEMP%\__npmVersion.tmp&quot; (
    SET /p NPM_JS_PATH=&amp;lt;&quot;%DEPLOYMENT_TEMP%\__npmVersion.tmp&quot;
    IF !ERRORLEVEL! NEQ 0 goto error
  )

  IF NOT DEFINED NODE_EXE (
    SET NODE_EXE=node
  )

  SET NPM_CMD=&quot;!NODE_EXE!&quot; &quot;!NPM_JS_PATH!&quot;
) ELSE (
  SET NPM_CMD=npm
  SET NODE_EXE=node
)

goto :EOF

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:: Deployment
:: ----------

:Deployment
echo Handling customized node.js deployment.

:: Changes: KuduSync happens after installation of modules now

:: 1. Select node version
call :SelectNodeVersion

:: 2. Configure private npm feed
call npm install configure-azure-appservice-private-npm-feed -g --silent --only=prod
IF !ERRORLEVEL! NEQ 0 goto error

call :ExecuteCmd %APPDATA%\npm\kuduPrivateNpm.cmd
IF !ERRORLEVEL! NEQ 0 goto error

:: 3. Customize npm
IF EXIST &quot;%DEPLOYMENT_SOURCE%\package.json&quot; (
  pushd &quot;%DEPLOYMENT_SOURCE%&quot;
  call :ExecuteCmd !NPM_CMD! config set color false
  IF !ERRORLEVEL! NEQ 0 goto error
  call :ExecuteCmd !NPM_CMD! config set progress false
  IF !ERRORLEVEL! NEQ 0 goto error
  popd
)

:: 4. Install npm packages
IF EXIST &quot;%DEPLOYMENT_SOURCE%\package.json&quot; (
  pushd &quot;%DEPLOYMENT_SOURCE%&quot;
  echo Installing npm packages at the deploy source of %DEPLOYMENT_SOURCE%
  call :ExecuteCmd !NPM_CMD! install --production
  IF !ERRORLEVEL! NEQ 0 goto error
  popd
)

:: 5. Install npm development packages
IF EXIST &quot;%DEPLOYMENT_SOURCE%\package.json&quot; (
  pushd &quot;%DEPLOYMENT_SOURCE%&quot;
  call :ExecuteCmd !NPM_CMD! install --only=dev
  IF !ERRORLEVEL! NEQ 0 goto error
  popd
)

:: 6. Bower
IF EXIST &quot;%DEPLOYMENT_SOURCE%\bower.json&quot; (
  echo Installing Bower components...
  pushd &quot;%DEPLOYMENT_SOURCE%&quot;
  call node_modules\.bin\bower install
  IF !ERRORLEVEL! NEQ 0 goto error
  popd
)

:: 7. Grunt
IF EXIST &quot;%DEPLOYMENT_SOURCE%\Gruntfile.js&quot; (
  pushd &quot;%DEPLOYMENT_SOURCE%&quot;
  echo Grunting...
  call :ExecuteCmd !NPM_CMD! install grunt-cli
  IF !ERRORLEVEL! NEQ 0 goto error
  call node_modules\.bin\grunt --no-color default
  IF !ERRORLEVEL! NEQ 0 goto error
  popd
)

:: 8. KuduSync
IF /I &quot;%IN_PLACE_DEPLOYMENT%&quot; NEQ &quot;1&quot; (
  call :ExecuteCmd &quot;%KUDU_SYNC_CMD%&quot; -v 50 -f &quot;%DEPLOYMENT_SOURCE%&quot; -t &quot;%DEPLOYMENT_TARGET%&quot; -n &quot;%NEXT_MANIFEST_PATH%&quot; -p &quot;%PREVIOUS_MANIFEST_PATH%&quot; -i &quot;.git;.hg;.deployment;deploy.cmd&quot;
  IF !ERRORLEVEL! NEQ 0 goto error
)

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

:: Post deployment stub
IF DEFINED POST_DEPLOYMENT_ACTION call &quot;%POST_DEPLOYMENT_ACTION%&quot;
IF !ERRORLEVEL! NEQ 0 goto error

goto end

:: Execute command routine that will echo out when error
:ExecuteCmd
setlocal
set _CMD_=%*
call %_CMD_%
if &quot;%ERRORLEVEL%&quot; NEQ &quot;0&quot; echo Failed exitCode=%ERRORLEVEL%, command=%_CMD_%
exit /b %ERRORLEVEL%

:error
endlocal
echo An error has occurred during web site deployment.
call :exitSetErrorLevel
call :exitFromFunction 2&amp;gt;nul

:exitSetErrorLevel
exit /b 1

:exitFromFunction
()

:end
endlocal
echo Finished successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;configuring-private-feed-settings&quot;&gt;Configuring private feed settings&lt;/h2&gt;

&lt;p&gt;Now all that is left to do is to actually tell our custom deployment script about
the private npm feed token that we want to use.&lt;/p&gt;

&lt;p&gt;By default the script used is configured to look for environment variables named:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED_TOKEN&lt;/em&gt;: The token credential from VSTS Package Management that we generated earlier&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED_SCOPE&lt;/em&gt;: The scoped name to use, so &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jeffwilcox&lt;/code&gt; in my example. You can omit the @ symbol.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED&lt;/em&gt;: The path to the private feed hosted by VSTS for my npm scope&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The custom script run during deployment will use these values, if present, to configure the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; specific
to this single app service.&lt;/p&gt;

&lt;p&gt;Here’s a look at what this looks like, redacted partially:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/private-npm-config.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After setting these values I’m ready to deploy again. Fingers crossed.&lt;/p&gt;

&lt;h2 id=&quot;publishing-with-custom-deployment&quot;&gt;Publishing with custom deployment&lt;/h2&gt;

&lt;p&gt;So I just need to commit these deployment files and push to the remote to kick off
another build attempt.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git add .deployment deploy.cmd
$ git commit .deployment deploy.cmd -m &quot;Custom deployment script with private npm support&quot;
$ git push origin master:master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And here it goes…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/deployment-success-1.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Partly through the deployment process you should see that it installed the custom npm
script to help things get configured, and then it executed, since it recognized the
presence of the environment variables.&lt;/p&gt;

&lt;p&gt;I get some feedback here about the private scoped feed being configured.&lt;/p&gt;

&lt;p&gt;Also some good news: I see that the private npm package is successfully installed now
that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.npmrc&lt;/code&gt; on the App Service side is properly configured inside the sandboxed
environment.&lt;/p&gt;

&lt;p&gt;Finally I get that great “deployment successful” message and know it’s time to go visit
the site.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/deployment-success-2.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;success&quot;&gt;Success!&lt;/h2&gt;

&lt;p&gt;Navigating to the App Service web URL I will now see the title that is generated
by my private npm function.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/edge-private-npm-package.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this point we’re done covering the basics and you could successfully use this
just fine to deploy App Services using your private npm package(s) for your Node.js apps.&lt;/p&gt;

&lt;h1 id=&quot;azure-keyvault-support&quot;&gt;Azure KeyVault support&lt;/h1&gt;

&lt;p&gt;While storing the private feed token to get to my package inside the Application Settings
for the App Service works to an extent, it has some issues.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The token has been manually placed inside the configuration. A typo or extra space
could cause problems.&lt;/li&gt;
  &lt;li&gt;If I have 50 web site deployments that use the private npm feed, I have 50 places to configure the token&lt;/li&gt;
  &lt;li&gt;If the credential leaks, is exposed, or as a general practice I want to reguarly rotate my secrets, I will have to update the secret token in at least 50 places. This will take time.&lt;/li&gt;
  &lt;li&gt;If I accidentally grant someone broad access to my web site instance, they may easily get to the token&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;The KeyVault support in this post, I should mention, is what works for my team, but is not official guidance. Use at your own risk and level of understanding of your needs and vault scenarios.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;While KeyVault can be used for many scenarios, I’m most interested here in these:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Preventing developer mistakes, especially from manual operation or settings data entry&lt;/li&gt;
  &lt;li&gt;Potentially being able to build a production environment that very few, or no one, have access to, including the token&lt;/li&gt;
  &lt;li&gt;Authorizing an individual app and its deployment to have access to a token, instead of having to configure more&lt;/li&gt;
  &lt;li&gt;Being able to rotate a secret, knowing that the next deployment will pick up the latest secret version and use that to connect to my feed, enabling great cred rotation options&lt;/li&gt;
  &lt;li&gt;Enabling configuration-as-code scenarios… I can actually store KeyVault secret paths inside private source control repositories without worrying the same way I would about committing an actual secret value&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;authoring-the-vault-in-the-portal&quot;&gt;Authoring the vault in the portal&lt;/h2&gt;

&lt;p&gt;There are many ways to authorize an app to have access to KeyVault, from client ID and secret pairs
to certificates and other methods. In the most simple case, supported in this script, my web site
has an Azure Active Directory application registration that provides an app client ID and a client secret
key that is good for 1-2 years.&lt;/p&gt;

&lt;p&gt;I’m able to authorize the application identity to have access to the KeyVault, so it can read the
secrets, and then I can use a custom protocol scheme supported by this script to point the various
Application Settings to the vault.&lt;/p&gt;

&lt;p&gt;So I’ll end up with something similar to these values for the 3 environment variables to configure
the private npm feed, where the actual secret value is my token and then I use tags on the KeyVault entry
for the other values, keeping the feed URL and the secret token value pair together:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED&lt;/em&gt;: keyvault://feed@my_vault_name.vault.azure.net/secrets/my-vsts-private-feed&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED_SCOPE&lt;/em&gt;: jeffwilcox&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;NPM_PRIVATE_FEED_TOKEN&lt;/em&gt;: keyvault://my_vault_name.vault.azure.net/secrets/my-vsts-private-feed&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here’s the secret entry inside the vault in the Azure portal. You can see some of the tags I’ve used to help
organize secrets.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/keyvault-secret-configuration.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;helping-manage-secrets&quot;&gt;Helping manage secrets&lt;/h2&gt;

&lt;p&gt;Another great value that KeyVault provide is a good way to gather and review
metadata about the secrets that I’m using in my set of apps.&lt;/p&gt;

&lt;p&gt;By tagging secrets with my own representation for the type of secret, I’m able
to generate a rather useful dashboard that identifies secret age and other
properties, grouping similar types of secrets together.&lt;/p&gt;

&lt;p&gt;Here in my custom portal I have a view that shows the metadata for a specific
secret version, including the tags I’ve defined, and also the custom &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;keyvault://&lt;/code&gt;
scheme we’ve designed for this scenario, making it easy to copy and paste the
vault secret URL as needed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vault-npmjs-token.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And here is a color-coded look at the current broader dashboard for a simple
application deployment covering about 10 different types of secrets that are
stored in this particular vault.&lt;/p&gt;

&lt;p&gt;The private NPM feed key is stored under the “NPMJS Tokens” category to help
aid in understanding.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/vault-with-npmjs-tokens.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I’ll cover some of this dashboard work in a future post but wanted to share an early
look at some of this.&lt;/p&gt;

&lt;h2 id=&quot;configuration-as-code&quot;&gt;Configuration as code&lt;/h2&gt;

&lt;p&gt;Finally, the custom deployment script supports “yet another” opinionated “painless” configuration-as-code story.&lt;/p&gt;

&lt;p&gt;By defining a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CONFIGURATION_ENVIRONMENT&lt;/code&gt; variable pointing to a known environment file, similar to a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NODE_ENV&lt;/code&gt; setting,
the configuration system is able to read variable values from the right local file.&lt;/p&gt;

&lt;p&gt;Since the configuration resolution code supports KeyVault, we’re able to safely commit configuration information internally,
just pointing at KeyVault secrets, and then we can treat config changes as code. New secrets and environment changes can
be code reviewed and move through Git like any other set of changes.&lt;/p&gt;

&lt;p&gt;For any given secret we have a choice: we can point to a secret name, resolving the latest version at
deployment or runtime, or we can point at a specific version. There are scenarios for both, but for the
private npm feed example, we’re using the versionless secret URI. This enables token credential rotation easier.&lt;/p&gt;

&lt;p&gt;Here’s a quick look inside Visual Studio Code at the configuration environment settings for the secrets
used by this app:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/vstsnpm/keyvault-configuration-as-code-with-private-feed.PNG&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks to config-as-code, we no longer need to configure the private NPM information on each app service, as
long as the app’s identity is authorized to the vault. This helps reduce errors.&lt;/p&gt;

&lt;h1 id=&quot;open-source&quot;&gt;Open source&lt;/h1&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/Microsoft/configure-azure-appservice-private-npm-feed&quot;&gt;configure-azure-appservice-private-npm-feed&lt;/a&gt;
script is licensed MIT and is a small tool/utility. At this time it is also published as an npm, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configure-azure-appservice-private-npm-feed&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It’s worth noting that at this time only a single private scoped feed is supported by the script. The script has two top-level dependencies that flow to others:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;async&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Microsoft/painless-config-resolver&quot;&gt;painless-config-resolver&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Your contributions and feedback are always welcome.&lt;/p&gt;

&lt;h1 id=&quot;closing&quot;&gt;Closing&lt;/h1&gt;

&lt;p&gt;Hopefully you found this post interesting. It’s really fun how we’re able to piece together
so many great technologies: Node.js, npm; Azure App Service, Active Directory, KeyVault; VSTS
and VSTS Package Management.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Using mail2bug with Azure App Service, WebJobs and VSTS to handle support mail</title>
   <link href="http://www.jeff.wilcox.name/2017/02/mail2bug/"/>
   <updated>2017-02-24T00:00:00+00:00</updated>
   <id>http://www.jeff.wilcox.name/2017/02/mail2bug</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/Microsoft/mail2bug&quot;&gt;mail2bug&lt;/a&gt; is a service that allows you to create a bug
from an e-mail thread simply by adding a specific recipient to the mail thread. It also keeps
the bug up-to-date with information from the mail thread by adding any subsequent replies on
the thread as comments to the bug. The &lt;a href=&quot;https://github.com/Microsoft/mail2bug/blob/master/README.md&quot;&gt;mail2bug README&lt;/a&gt;
has useful information if you want to learn more.&lt;/p&gt;

&lt;p&gt;Mail2bug was not designed for the cloud - in many cases there’s a server box under someone’s desk
running their team’s on-premise mail2bug instance, or maybe it’s in a lab, or on a Hyper-V server. That works for
many folks but it turns out that it’s easy to run this standard .NET app in the cloud, too.&lt;/p&gt;

&lt;p&gt;Thanks to Azure App Service, the WebJobs feature of web sites, and a simple tweak to a deployment script, the
changes I made to mail2bug have enabled my team to use a cloud-hosted mail2bug for almost a year now with
zero maintenance cost or effort. It just keeps ticking.&lt;/p&gt;

&lt;p&gt;In this short post I’ll cover how we use WebJobs to enable automatic deployment and execution
on Azure of this simple app. It is implemented in .NET and was open sourced a few years ago.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;2/27/2017 Update:
My &lt;a href=&quot;https://github.com/Microsoft/mail2bug/pull/39&quot;&gt;pull request&lt;/a&gt; contributing the changes to mail2bug
was accepted. Hooray!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I am hoping that this post will help the few folks I know who have been asking how this worked for my team.&lt;/p&gt;

&lt;h1 id=&quot;whats-mail2bug&quot;&gt;What’s mail2bug?&lt;/h1&gt;

&lt;p&gt;Historically mail2bug was a Microsoft internal tool that a few engineering systems teams implemented. Mail2bug does simple things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Creates a Visual Studio Team Services or TFS on-prem work item from an e-mail conversation and maintains the history&lt;/li&gt;
  &lt;li&gt;Integrates with Exchange or Office 365 mail accounts&lt;/li&gt;
  &lt;li&gt;Can reply back to the start of a thread or support incident with a link to the tracking bug and also a templated mail with helpful information or your support SLA&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It’s essentially a “poor man’s Zen Desk”, not designed to do much more. On our team this is a good solution for now,
though there are features I know we want to implement that would make it even better.&lt;/p&gt;

&lt;p&gt;Here’s what an auto-response mail looks like from one of our team addresses:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/sample-email.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And here is what a Visual Studio Team Services cloud-hosted work item query view looks like, showing the active support
tickets on our team:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/vsts-tickets.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;azure-app-service-and-webjobs&quot;&gt;Azure App Service and WebJobs&lt;/h1&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;App Service is a fully-managed platform for web app hosting, it makes web apps and sites extremely
easy to use and deploy at scale.&lt;/p&gt;

&lt;p&gt;Powering the infrastructure for App Service are the “Advanced Tools”, or Project Kudu. The
&lt;a href=&quot;https://github.com/projectkudu/kudu/wiki&quot;&gt;Project Kudu wiki&lt;/a&gt; on GitHub has a lot of great
information that you just won’t find elsewhere, so if you are new to this, take a look.&lt;/p&gt;

&lt;p&gt;A feature of App Service and Kudu is a technology called &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/app-service-web/websites-webjobs-resources&quot;&gt;WebJobs&lt;/a&gt; -
WebJobs are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cron&lt;/code&gt;/schedule tasks that run either continuously or triggered based on time or REST calls. It makes a lot of simple automation
tasks even easier and they’re quick and easy to deploy alongside a site.&lt;/p&gt;

&lt;p&gt;Right inside the Azure portal for an app you can explore any WebJobs setup within your app service.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/webjob-portal.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can also drill into the logs for the jobs, and that opens up the Advanced Tools management side of your app.&lt;/p&gt;

&lt;h2 id=&quot;default-net-console-app-experience&quot;&gt;Default .NET console app experience&lt;/h2&gt;

&lt;p&gt;Kudu generates a deployment script automatically based on the type of repository that is connected
to an App Service instance.&lt;/p&gt;

&lt;p&gt;When you deploy a .NET Framework console app, it automatically builds the project and deploys it
as a continuous WebJob.&lt;/p&gt;

&lt;p&gt;It just works! For many “lift and shift” .NET console apps, this is a nice win, and easy.&lt;/p&gt;

&lt;h2 id=&quot;triggered-webjob-changes&quot;&gt;Triggered WebJob changes&lt;/h2&gt;

&lt;p&gt;In our case we like triggered WebJobs, because you can set an interval - every 2 minutes, every 10 minutes,
etc., with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cron&lt;/code&gt;-like syntax. This also lets us rotate the password / secret used to
connect to the mail account regularly, since each time the app runs, it will grab the latest
rotated account password. More on that soon.&lt;/p&gt;

&lt;p&gt;When the WebJob runs, it will store a log of exactly what happened during the run, and by
default a certain set of the last N runs will be stored. This value is configurable and
documented as part of the Kudu wiki.&lt;/p&gt;

&lt;p&gt;Inside the WebJob mini portal you can see the history for a WebJob:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/kudu-webjob-details.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And then you can select any particular instance and find out the console output and
other data from that run:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/webjob-run-details.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nice.&lt;/p&gt;

&lt;h1 id=&quot;azure-keyvault-secrets&quot;&gt;Azure KeyVault secrets&lt;/h1&gt;

&lt;p&gt;To enable cloud-based deployment and still connect to an Office 365 e-mail account to
check for mail and respond, we have to store a secret: the token or password to access the e-mail account.&lt;/p&gt;

&lt;h2 id=&quot;keyvault-scenario&quot;&gt;KeyVault scenario&lt;/h2&gt;

&lt;p&gt;Azure KeyVault is the best bet for this, since we can then authorize our App Service
instance through Active Directory to be able to GET the secret at runtime. We can also
handle secrets rotation very easily, since each time the triggered WebJob runs, it will
refresh the latest secret to use for connecting to the mail account.&lt;/p&gt;

&lt;p&gt;This way we can store the KeyVault secret URI inside our source code, since it is not a secret,
and then the app, if authorized, will be able to resolve the secret at runtime. Our use of
KeyVault is mostly about preventing developer mistakes and of course to avoid a source code
evil, which is storing secrets in code (gasp!).&lt;/p&gt;

&lt;p&gt;While I won’t walk through the specifics in this post, the steps are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Create a new Azure Active Directory (AAD) application that the mail2bug app will use as its identity to connect to the secret store&lt;/li&gt;
  &lt;li&gt;Store the secret in KeyVault, this can be set using the portal, a PowerShell or CLI script, or even our team’s own KeyVault management portal that we have built&lt;/li&gt;
  &lt;li&gt;Authorize the AAD app to be able to GET the secret(s) in the KeyVault instance we have the secret stored in&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Then we just need to point the app configuration at the KeyVault secret URI and provide the client ID and secret to the app inside App Service. There is also a
slightly more secure method using certificates that could be implemented, but that I have chosen to not implement at this time for simplicity sake.&lt;/p&gt;

&lt;h2 id=&quot;mail2bug-secrets-management&quot;&gt;Mail2Bug secrets management&lt;/h2&gt;

&lt;p&gt;The mail2bug app was built to use &lt;a href=&quot;https://en.wikipedia.org/wiki/Data_Protection_API&quot;&gt;DPAPI&lt;/a&gt; - the Windows Data Protection API - to keep
the secret encrypted and safe within a Windows box sitting under a desk somewhere, or in a lab.&lt;/p&gt;

&lt;p&gt;In the cloud this is not ideal, and for App Service it just makes sense to use KeyVault instead.&lt;/p&gt;

&lt;p&gt;The pull request I have submitted for mail2bug alters the DPAPI code paths to alternatively be able to use Azure KeyVault if the vault and secret
information is available.&lt;/p&gt;

&lt;h1 id=&quot;continuous-deployment&quot;&gt;Continuous deployment&lt;/h1&gt;

&lt;p&gt;Using Azure App Service we have a nice story when we want to update the configuration for
a mail2bug task, tweak the e-mail template that we use for autoresponse, etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/deployment-options.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The standard mail2bug configuration story for on-premise users is to remote desktop into a
machine or otherwise remotely work with the files, restart the service or bump the scheduled task.&lt;/p&gt;

&lt;p&gt;For my team it’s even easier, as we just have a Git repo with both the mail2bug source code
and our configuration files and e-mail template in it. We can just create a branch, code review
the change, and then push the master branch, at which point App Service updates the app and the WebJob
and the next time that the triggered WebJob runs it will have the latest configuration. This also
works for updating the mail2bug app itself.&lt;/p&gt;

&lt;p&gt;Here’s the repo:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/mail2bug-github.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The structure is pretty basic:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configuration&lt;/code&gt; folder has our e-mail template and various mail2bug XML config files&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mail2bug&lt;/code&gt; folder contains the source code for mail2bug&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.deployment&lt;/code&gt; and &lt;a href=&quot;https://gist.github.com/jeffwilcox/5586c219c4e6b7d258c19087fd277dfd&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;deploy.cmd&lt;/code&gt;&lt;/a&gt; custom deployment script that Kudu will use whenever our app is deployed instead of the standard auto-generated script&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settings.job&lt;/code&gt;, the triggered WebJob configuration that we want to use for our app&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The custom deployment script is up in a &lt;a href=&quot;https://gist.github.com/jeffwilcox/5586c219c4e6b7d258c19087fd277dfd&quot;&gt;Gist&lt;/a&gt; if you need it. It
just builds the project and moves it into the folder &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;App_Data/jobs/triggered/mail2bug&lt;/code&gt;. This is the location that kudu looks to
setup WebJobs, etc.&lt;/p&gt;

&lt;h1 id=&quot;configuration&quot;&gt;Configuration&lt;/h1&gt;

&lt;p&gt;We need to configure Mail2Bug - nearly the same way as any other mail2bug instance, so that is left as an exercise
to the reader.&lt;/p&gt;

&lt;p&gt;We also need to configure the App Service instance.&lt;/p&gt;

&lt;h2 id=&quot;mail2bug-configuration-files&quot;&gt;Mail2Bug configuration files&lt;/h2&gt;

&lt;p&gt;A Mail2Bug configuration file contains info about how to respond to e-mail, where to open bugs, and other data. Here is a sample
configuration file, partially redacted. They aren’t pretty, but they get the job done.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Config&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsd=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;Instances&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstanceConfig&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;npmjs-admin&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;TfsServerConfig&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;SimulationMode&amp;gt;&lt;/span&gt;false&lt;span class=&quot;nt&quot;&gt;&amp;lt;/SimulationMode&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CollectionUri&amp;gt;&lt;/span&gt;https://ospo.visualstudio.com/DefaultCollection/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/CollectionUri&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ServiceIdentityUsername&amp;gt;&lt;/span&gt;vstsusername@domain.com&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ServiceIdentityUsername&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ServiceIdentityPatKeyVaultSecret&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;KeyVaultPath&amp;gt;&lt;/span&gt;https://yourkeyvaultaddress.vault.azure.net/secrets/mail2bug-pat&lt;span class=&quot;nt&quot;&gt;&amp;lt;/KeyVaultPath&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;ApplicationIdEnvironmentVariableName&amp;gt;&lt;/span&gt;DIRECTORY_APPLICATION_ID&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ApplicationIdEnvironmentVariableName&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;ApplicationSecretEnvironmentVariableName&amp;gt;&lt;/span&gt;DIRECTORY_APPLICATION_SECRET&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ApplicationSecretEnvironmentVariableName&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/ServiceIdentityPatKeyVaultSecret&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Project&amp;gt;&lt;/span&gt;YourVSTSProjectName&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Project&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WorkItemTemplate&amp;gt;&lt;/span&gt;Issue&lt;span class=&quot;nt&quot;&gt;&amp;lt;/WorkItemTemplate&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CacheQueryFile&amp;gt;&lt;/span&gt;configuration\openedissues.wiq&lt;span class=&quot;nt&quot;&gt;&amp;lt;/CacheQueryFile&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;NamesListFieldName&amp;gt;&lt;/span&gt;Assigned To&lt;span class=&quot;nt&quot;&gt;&amp;lt;/NamesListFieldName&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/TfsServerConfig&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;WorkItemSettings&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;FieldsToCache&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;State&lt;span class=&quot;nt&quot;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;Assigned To&lt;span class=&quot;nt&quot;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/FieldsToCache&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ApplyOverridesDuringUpdate&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ApplyOverridesDuringUpdate&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Mnemonics&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;MnemonicDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Mnemonic=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;remove&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;State&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Closed&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;MnemonicDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Mnemonic=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;resolved&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;State&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Closed&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;MnemonicDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Mnemonic=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;close&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;State&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Closed&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Mnemonics&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ConversationIndexFieldName&amp;gt;&lt;/span&gt;Integration Build&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ConversationIndexFieldName&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultFieldValues&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Assigned To&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;username@domain.com&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Changed By&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;##Sender&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;##MessageBody&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Priority&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Area Path&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Path\To\Store\WorkItem\In&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultValueDefinition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Field=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Iteration Path&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;IterationPathValue&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/DefaultFieldValues&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;AttachOriginalMessage&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AttachOriginalMessage&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;AddEmailHeaderToItem&amp;gt;&lt;/span&gt;false&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AddEmailHeaderToItem&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DefaultAssign&amp;gt;&lt;/span&gt;Active&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DefaultAssign&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/WorkItemSettings&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;EmailSettings&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Recipients&amp;gt;&lt;/span&gt;emailAddressToKeyOffOf@microsoft.com&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Recipients&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ReplyTemplate&amp;gt;&lt;/span&gt;configuration\template.htm&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ReplyTemplate&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CompletedFolder&amp;gt;&lt;/span&gt;foldername&lt;span class=&quot;nt&quot;&gt;&amp;lt;/CompletedFolder&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ErrorFolder&amp;gt;&lt;/span&gt;processing-errors&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ErrorFolder&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;EWSKeyVaultSecret&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;KeyVaultPath&amp;gt;&lt;/span&gt;https://yourkeyvaultaddress.vault.azure.net/secrets/mailaccount-password&lt;span class=&quot;nt&quot;&gt;&amp;lt;/KeyVaultPath&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;ApplicationIdEnvironmentVariableName&amp;gt;&lt;/span&gt;DIRECTORY_APPLICATION_ID&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ApplicationIdEnvironmentVariableName&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;ApplicationSecretEnvironmentVariableName&amp;gt;&lt;/span&gt;DIRECTORY_APPLICATION_SECRET&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ApplicationSecretEnvironmentVariableName&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/EWSKeyVaultSecret&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;EWSMailboxAddress&amp;gt;&lt;/span&gt;mailAccount@domain.com&lt;span class=&quot;nt&quot;&gt;&amp;lt;/EWSMailboxAddress&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;EWSUsername&amp;gt;&lt;/span&gt;mailAccount@domain.com&lt;span class=&quot;nt&quot;&gt;&amp;lt;/EWSUsername&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ServiceType&amp;gt;&lt;/span&gt;EWSByRecipients&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ServiceType&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;SendAckEmails&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/SendAckEmails&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;AckEmailsRecipientsAll&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AckEmailsRecipientsAll&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;AppendOnlyEmailTitleRegex&amp;gt;&lt;/span&gt;.*(bug|work item)\s*#*\s*(?&lt;span class=&quot;ni&quot;&gt;&amp;amp;lt;&lt;/span&gt;id&lt;span class=&quot;ni&quot;&gt;&amp;amp;gt;&lt;/span&gt;\d+)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AppendOnlyEmailTitleRegex&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;AppendOnlyEmailBodyRegex&amp;gt;&lt;/span&gt;!!!(bug|work item)\s*#*\s*(?&lt;span class=&quot;ni&quot;&gt;&amp;amp;lt;&lt;/span&gt;id&lt;span class=&quot;ni&quot;&gt;&amp;amp;gt;&lt;/span&gt;\d+)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AppendOnlyEmailBodyRegex&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ExplicitOverridesRegex&amp;gt;&lt;/span&gt;###\s*(?&lt;span class=&quot;ni&quot;&gt;&amp;amp;lt;&lt;/span&gt;fieldName&lt;span class=&quot;ni&quot;&gt;&amp;amp;gt;&lt;/span&gt;[^:]*):\s*(?&lt;span class=&quot;ni&quot;&gt;&amp;amp;lt;&lt;/span&gt;value&lt;span class=&quot;ni&quot;&gt;&amp;amp;gt;&lt;/span&gt;.*)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ExplicitOverridesRegex&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/EmailSettings&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstanceConfig&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Instances&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Config&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;application-settings&quot;&gt;Application Settings&lt;/h2&gt;

&lt;p&gt;The final piece of the puzzle is to give the App Service access to our AAD app’s client ID and secret. This is so that it can
access the vault. The mail2bug configuration includes KeyVault secret URIs, and also the name of the environment variables
that will have the app’s client ID and secrets available.&lt;/p&gt;

&lt;p&gt;We set these secrets in the Azure portal. I have chosen the variable names &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DIRECTORY_APPLICATION_ID&lt;/code&gt; and
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DIRECTORY_APPLICATION_SECRET&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;//az414997.vo.msecnd.net/waz/mail2bug/application-settings.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;closing&quot;&gt;Closing&lt;/h1&gt;

&lt;p&gt;Hope this helps you to learn about App Service and WebJobs, and I also hope that the upstream project accepts
my contribution at some point!&lt;/p&gt;

&lt;p&gt;Jeff&lt;/p&gt;
</content>
 </entry>
 
 
</feed>